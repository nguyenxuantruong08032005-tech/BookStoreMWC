2025-10-24 00:40:16.250 +07:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-24 00:40:17.903 +07:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-24 00:40:17.917 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-24 00:40:17.953 +07:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-24 00:40:18.019 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-24 00:40:18.037 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-24 00:40:18.040 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-24 00:40:18.046 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-24 00:40:18.056 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-10-24 00:40:18.060 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-24 00:40:18.332 +07:00 [INF] Executed DbCommand (19ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 00:40:18.374 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 00:40:18.388 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-10-24 00:40:18.432 +07:00 [INF] ✅ Database initialized with admin user only.
2025-10-24 00:40:18.436 +07:00 [INF] Database initialized successfully
2025-10-24 00:40:18.520 +07:00 [INF] ==========================================
2025-10-24 00:40:18.521 +07:00 [INF] BookStore Application Starting...
2025-10-24 00:40:18.522 +07:00 [INF] Environment: Production
2025-10-24 00:40:18.522 +07:00 [INF] Session Timeout: 7 days
2025-10-24 00:40:18.523 +07:00 [INF] Guest Cart: Enabled
2025-10-24 00:40:18.523 +07:00 [INF] ==========================================
2025-10-24 00:40:18.598 +07:00 [INF] Now listening on: http://localhost:5000
2025-10-24 00:40:18.600 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-24 00:40:18.601 +07:00 [INF] Hosting environment: Production
2025-10-24 00:40:18.602 +07:00 [INF] Content root path: C:\Users\DELL\Desktop\Bán sách\BookStoreMWC
2025-10-24 00:40:20.299 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 00:40:20.305 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-24 00:40:20.360 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 00:40:20.374 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 00:40:20.532 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 00:40:20.629 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 00:40:20.650 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 00:40:20.682 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 00:40:20.708 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:40:20.723 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 00:40:20.740 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 00:40:20.756 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 00:40:20.787 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 00:40:20.805 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 00:40:20.832 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 00:40:20.858 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 00:40:20.872 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 00:40:20.901 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 00:40:20.944 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 00:40:21.053 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:40:21.065 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:40:21.101 +07:00 [INF] Executed ViewResult - view Index executed in 155.8978ms.
2025-10-24 00:40:21.108 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 730.7189ms
2025-10-24 00:40:21.111 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 00:40:21.119 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 821.7642ms
2025-10-24 00:40:21.271 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/BOOK.png?v=QztAXuOfgcsIJZg3XCCS1qK3ZFO0Q3cC8g9UFxPKzyQ - null null
2025-10-24 00:40:21.281 +07:00 [INF] The file /BOOK.png was not modified
2025-10-24 00:40:21.283 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/BOOK.png?v=QztAXuOfgcsIJZg3XCCS1qK3ZFO0Q3cC8g9UFxPKzyQ - 304 null image/png 12.6356ms
2025-10-24 00:40:23.306 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/Bestseller - null null
2025-10-24 00:40:23.319 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 00:40:23.369 +07:00 [INF] Route matched with {action = "Bestseller", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Bestseller(BookStoreMVC.Models.ViewModels.BookListViewModel) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 00:40:23.451 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-24 00:40:23.462 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 00:40:23.491 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) AS [c], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit)
    ORDER BY COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) DESC, (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id], [r0].[Id]
2025-10-24 00:40:23.502 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:40:23.511 +07:00 [INF] Executing ViewResult, running view Bestseller.
2025-10-24 00:40:23.534 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:40:23.541 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:40:23.546 +07:00 [INF] Executed ViewResult - view Bestseller executed in 35.8616ms.
2025-10-24 00:40:23.547 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC) in 173.4176ms
2025-10-24 00:40:23.548 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 00:40:23.549 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/Bestseller - 200 null text/html; charset=utf-8 243.2853ms
2025-10-24 00:40:23.558 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/76d46b94-1260-425d-a282-e49e11b01475.jpg - null null
2025-10-24 00:40:23.567 +07:00 [INF] The file /images/books/76d46b94-1260-425d-a282-e49e11b01475.jpg was not modified
2025-10-24 00:40:23.568 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/76d46b94-1260-425d-a282-e49e11b01475.jpg - 304 null image/jpeg 9.9699ms
2025-10-24 00:43:35.571 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/Promotions - null null
2025-10-24 00:43:35.583 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Promotions (BookStoreMVC)'
2025-10-24 00:43:35.589 +07:00 [INF] Route matched with {action = "Promotions", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Promotions(BookStoreMVC.Models.ViewModels.BookListViewModel) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 00:43:35.601 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 00:43:35.608 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 00:43:35.613 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:43:35.615 +07:00 [INF] Executing ViewResult, running view Promotions.
2025-10-24 00:43:35.618 +07:00 [ERR] The view 'Promotions' was not found. Searched locations: ["/Views/Books/Promotions.cshtml","/Views/Shared/Promotions.cshtml"]
2025-10-24 00:43:35.623 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Promotions (BookStoreMVC) in 28.5445ms
2025-10-24 00:43:35.624 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Promotions (BookStoreMVC)'
2025-10-24 00:43:35.625 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'Promotions' was not found. The following locations were searched:
/Views/Books/Promotions.cshtml
/Views/Shared/Promotions.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_11>d.MoveNext() in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Program.cs:line 265
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-10-24 00:43:35.662 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Error (BookStoreMVC)'
2025-10-24 00:43:35.664 +07:00 [INF] Route matched with {action = "Error", controller = "Home"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Error() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 00:43:35.666 +07:00 [INF] Executing ViewResult, running view Error.
2025-10-24 00:43:35.672 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:43:35.675 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:43:35.677 +07:00 [INF] Executed ViewResult - view Error executed in 11.5414ms.
2025-10-24 00:43:35.679 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Error (BookStoreMVC) in 13.939ms
2025-10-24 00:43:35.679 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Error (BookStoreMVC)'
2025-10-24 00:43:35.681 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/Promotions - 500 null text/html; charset=utf-8 109.8355ms
2025-10-24 00:43:36.284 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Blog - null null
2025-10-24 00:43:36.290 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BlogController.Index (BookStoreMVC)'
2025-10-24 00:43:36.292 +07:00 [INF] Route matched with {action = "Index", controller = "Blog"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Index() on controller BookStoreMVC.Controllers.BlogController (BookStoreMVC).
2025-10-24 00:43:36.296 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 00:43:36.312 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:43:36.316 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:43:36.320 +07:00 [INF] Executed ViewResult - view Index executed in 23.8201ms.
2025-10-24 00:43:36.321 +07:00 [INF] Executed action BookStoreMVC.Controllers.BlogController.Index (BookStoreMVC) in 28.089ms
2025-10-24 00:43:36.322 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BlogController.Index (BookStoreMVC)'
2025-10-24 00:43:36.324 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Blog - 200 null text/html; charset=utf-8 39.2137ms
2025-10-24 00:43:36.331 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/blog/reading-habits.jpg - null null
2025-10-24 00:43:36.331 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/blog/vietnamese-novels.jpg - null null
2025-10-24 00:43:36.331 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/blog/morning-books.jpg - null null
2025-10-24 00:43:36.331 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/blog/note-taking.jpg - null null
2025-10-24 00:43:36.335 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/blog/reading-habits.jpg - 404 0 null 4.0051ms
2025-10-24 00:43:36.337 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/blog/morning-books.jpg - 404 0 null 4.9663ms
2025-10-24 00:43:36.337 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/blog/vietnamese-novels.jpg - 404 0 null 5.2671ms
2025-10-24 00:43:36.338 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/blog/note-taking.jpg - 404 0 null 6.6261ms
2025-10-24 00:43:36.340 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/blog/reading-habits.jpg, Response status code: 404
2025-10-24 00:43:36.341 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/blog/morning-books.jpg, Response status code: 404
2025-10-24 00:43:36.342 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/blog/vietnamese-novels.jpg, Response status code: 404
2025-10-24 00:43:36.343 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/blog/note-taking.jpg, Response status code: 404
2025-10-24 00:43:37.054 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Home/Contact - null null
2025-10-24 00:43:37.062 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Contact (BookStoreMVC)'
2025-10-24 00:43:37.064 +07:00 [INF] Route matched with {action = "Contact", controller = "Home"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Contact() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 00:43:37.070 +07:00 [INF] Executing ViewResult, running view Contact.
2025-10-24 00:43:37.073 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Contact (BookStoreMVC) in 8.0973ms
2025-10-24 00:43:37.074 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Contact (BookStoreMVC)'
2025-10-24 00:43:37.075 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The partial view '_Breadcrumb' was not found. The following locations were searched:
/Views/Home/_Breadcrumb.cshtml
/Views/Shared/_Breadcrumb.cshtml
   at Microsoft.AspNetCore.Mvc.ViewFeatures.HtmlHelper.RenderPartialCoreAsync(String partialViewName, Object model, ViewDataDictionary viewData, TextWriter writer)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.HtmlHelper.PartialAsync(String partialViewName, Object model, ViewDataDictionary viewData)
   at AspNetCoreGeneratedDocument.Views_Home_Contact.ExecuteAsync() in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Views\Home\Contact.cshtml:line 4
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_11>d.MoveNext() in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Program.cs:line 265
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-10-24 00:43:37.084 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Error (BookStoreMVC)'
2025-10-24 00:43:37.084 +07:00 [INF] Route matched with {action = "Error", controller = "Home"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Error() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 00:43:37.086 +07:00 [INF] Executing ViewResult, running view Error.
2025-10-24 00:43:37.089 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:43:37.091 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:43:37.093 +07:00 [INF] Executed ViewResult - view Error executed in 6.8318ms.
2025-10-24 00:43:37.093 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Error (BookStoreMVC) in 7.6803ms
2025-10-24 00:43:37.094 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Error (BookStoreMVC)'
2025-10-24 00:43:37.095 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Home/Contact - 500 null text/html; charset=utf-8 40.3889ms
2025-10-24 00:43:38.605 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/Bestseller - null null
2025-10-24 00:43:38.616 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 00:43:38.619 +07:00 [INF] Route matched with {action = "Bestseller", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Bestseller(BookStoreMVC.Models.ViewModels.BookListViewModel) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 00:43:38.631 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-24 00:43:38.635 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) AS [c], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit)
    ORDER BY COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) DESC, (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id], [r0].[Id]
2025-10-24 00:43:38.641 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:43:38.643 +07:00 [INF] Executing ViewResult, running view Bestseller.
2025-10-24 00:43:38.645 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:43:38.647 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:43:38.650 +07:00 [INF] Executed ViewResult - view Bestseller executed in 8.0662ms.
2025-10-24 00:43:38.651 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC) in 23.2995ms
2025-10-24 00:43:38.653 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 00:43:38.654 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/Bestseller - 200 null text/html; charset=utf-8 49.0714ms
2025-10-24 00:43:52.081 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/books/4 - null null
2025-10-24 00:43:52.087 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 00:43:52.091 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 00:43:52.104 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 00:43:52.164 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 00:43:52.195 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 00:43:52.201 +07:00 [INF] Book 4 - AdditionalImages: null, GalleryCount: 0, HasGallery: false
2025-10-24 00:43:52.203 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 00:43:52.213 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:43:52.215 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:43:52.217 +07:00 [INF] Executed ViewResult - view Details executed in 14.8593ms.
2025-10-24 00:43:52.218 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 125.9895ms
2025-10-24 00:43:52.219 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 00:43:52.220 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/books/4 - 200 null text/html; charset=utf-8 139.6661ms
2025-10-24 00:44:08.539 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/Bestseller?pageNumber=1&searchTerm=Y%C3%AAu+Nh%E1%BB%AFng+%C4%90i%E1%BB%81u+Kh%C3%B4ng+Ho%C3%A0n+H%E1%BA%A3o&categoryId=&minPrice=&maxPrice=&minRating=&sortBy=bestseller&sortOrder=desc - null null
2025-10-24 00:44:08.550 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 00:44:08.554 +07:00 [INF] Route matched with {action = "Bestseller", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Bestseller(BookStoreMVC.Models.ViewModels.BookListViewModel) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 00:44:08.570 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__model_SearchTerm_0_contains='?' (Size = 200), @__model_SearchTerm_0_contains_1='?' (Size = 100), @__model_SearchTerm_0_contains_2='?' (Size = 1000)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND ([b].[Title] LIKE @__model_SearchTerm_0_contains ESCAPE N'\' OR [b].[Author] LIKE @__model_SearchTerm_0_contains_1 ESCAPE N'\' OR [b].[Description] LIKE @__model_SearchTerm_0_contains_2 ESCAPE N'\')
2025-10-24 00:44:08.582 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 00:44:08.617 +07:00 [INF] Executed DbCommand (14ms) [Parameters=[@__model_SearchTerm_0_contains='?' (Size = 200), @__model_SearchTerm_0_contains_1='?' (Size = 100), @__model_SearchTerm_0_contains_2='?' (Size = 1000), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) AS [c], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND ([b].[Title] LIKE @__model_SearchTerm_0_contains ESCAPE N'\' OR [b].[Author] LIKE @__model_SearchTerm_0_contains_1 ESCAPE N'\' OR [b].[Description] LIKE @__model_SearchTerm_0_contains_2 ESCAPE N'\')
    ORDER BY COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) DESC, (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id], [r0].[Id]
2025-10-24 00:44:08.628 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:44:08.629 +07:00 [INF] Executing ViewResult, running view Bestseller.
2025-10-24 00:44:08.632 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:44:08.634 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:44:08.636 +07:00 [INF] Executed ViewResult - view Bestseller executed in 6.8525ms.
2025-10-24 00:44:08.637 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC) in 80.6585ms
2025-10-24 00:44:08.638 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 00:44:08.639 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/Bestseller?pageNumber=1&searchTerm=Y%C3%AAu+Nh%E1%BB%AFng+%C4%90i%E1%BB%81u+Kh%C3%B4ng+Ho%C3%A0n+H%E1%BA%A3o&categoryId=&minPrice=&maxPrice=&minRating=&sortBy=bestseller&sortOrder=desc - 200 null text/html; charset=utf-8 99.5516ms
2025-10-24 00:44:30.486 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/Bestseller - null null
2025-10-24 00:44:30.493 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 00:44:30.495 +07:00 [INF] Route matched with {action = "Bestseller", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Bestseller(BookStoreMVC.Models.ViewModels.BookListViewModel) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 00:44:30.501 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-24 00:44:30.509 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) AS [c], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit)
    ORDER BY COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) DESC, (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id], [r0].[Id]
2025-10-24 00:44:30.517 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:44:30.518 +07:00 [INF] Executing ViewResult, running view Bestseller.
2025-10-24 00:44:30.520 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:44:30.522 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:44:30.525 +07:00 [INF] Executed ViewResult - view Bestseller executed in 7.3813ms.
2025-10-24 00:44:30.526 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC) in 28.0836ms
2025-10-24 00:44:30.527 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 00:44:30.528 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/Bestseller - 200 null text/html; charset=utf-8 41.7307ms
2025-10-24 00:44:41.016 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/NewBooks - null null
2025-10-24 00:44:41.020 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC)'
2025-10-24 00:44:41.023 +07:00 [INF] Route matched with {action = "NewBooks", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] NewBooks(System.String, System.String, Int32) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 00:44:41.035 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
2025-10-24 00:44:41.040 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 00:44:41.059 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
    ORDER BY [b].[CreatedAt] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 00:44:41.068 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:44:41.071 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 00:44:41.075 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 00:44:41.080 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
2025-10-24 00:44:41.083 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
    ORDER BY [b].[CreatedAt] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 00:44:41.087 +07:00 [INF] Executing ViewResult, running view NewBooks.
2025-10-24 00:44:41.102 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:44:41.106 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:44:41.108 +07:00 [INF] Executed ViewResult - view NewBooks executed in 20.7026ms.
2025-10-24 00:44:41.109 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC) in 83.6277ms
2025-10-24 00:44:41.110 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC)'
2025-10-24 00:44:41.111 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/NewBooks - 200 null text/html; charset=utf-8 95.2937ms
2025-10-24 00:44:45.587 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/category/13/Sách tâm linh - tôn giáo - null null
2025-10-24 00:44:45.593 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Category (BookStoreMVC)'
2025-10-24 00:44:45.597 +07:00 [INF] Route matched with {action = "Category", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Category(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 00:44:45.604 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 00:44:45.627 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[CreatedAt], [s].[Description], [s].[ImageUrl], [s].[IsActive], [s].[Name], [s].[ParentCategoryId], [s].[Id0], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name0], [s].[ParentCategoryId0], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id] AS [Id0], [c0].[CreatedAt] AS [CreatedAt0], [c0].[Description] AS [Description0], [c0].[ImageUrl] AS [ImageUrl0], [c0].[IsActive] AS [IsActive0], [c0].[Name] AS [Name0], [c0].[ParentCategoryId] AS [ParentCategoryId0]
    FROM [Categories] AS [c]
    LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
    WHERE [c].[Id] = @__id_0
) AS [s]
LEFT JOIN [Books] AS [b] ON [s].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [s].[Id] = [c1].[ParentCategoryId]
ORDER BY [s].[Id], [s].[Id0], [b].[Id]
2025-10-24 00:44:45.642 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__model_CategoryId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CategoryId] = @__model_CategoryId_0
2025-10-24 00:44:45.648 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 00:44:45.669 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__model_CategoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CategoryId] = @__model_CategoryId_0
    ORDER BY [b].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[Title], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 00:44:45.676 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:44:45.681 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 00:44:45.694 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:44:45.701 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:44:45.704 +07:00 [INF] Executed ViewResult - view Index executed in 23.8496ms.
2025-10-24 00:44:45.706 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Category (BookStoreMVC) in 107.3925ms
2025-10-24 00:44:45.707 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Category (BookStoreMVC)'
2025-10-24 00:44:45.708 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/category/13/Sách tâm linh - tôn giáo - 200 null text/html; charset=utf-8 121.3375ms
2025-10-24 00:44:53.265 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/NewBooks - null null
2025-10-24 00:44:53.269 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC)'
2025-10-24 00:44:53.270 +07:00 [INF] Route matched with {action = "NewBooks", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] NewBooks(System.String, System.String, Int32) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 00:44:53.274 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
2025-10-24 00:44:53.277 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
    ORDER BY [b].[CreatedAt] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 00:44:53.283 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:44:53.285 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 00:44:53.289 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 00:44:53.292 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
2025-10-24 00:44:53.295 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
    ORDER BY [b].[CreatedAt] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 00:44:53.299 +07:00 [INF] Executing ViewResult, running view NewBooks.
2025-10-24 00:44:53.301 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:44:53.305 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:44:53.307 +07:00 [INF] Executed ViewResult - view NewBooks executed in 8.7428ms.
2025-10-24 00:44:53.308 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC) in 37.1164ms
2025-10-24 00:44:53.310 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC)'
2025-10-24 00:44:53.311 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/NewBooks - 200 null text/html; charset=utf-8 46.525ms
2025-10-24 00:44:56.142 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/category/8/Sách văn học nước ngoài - null null
2025-10-24 00:44:56.149 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Category (BookStoreMVC)'
2025-10-24 00:44:56.150 +07:00 [INF] Route matched with {action = "Category", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Category(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 00:44:56.154 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[CreatedAt], [s].[Description], [s].[ImageUrl], [s].[IsActive], [s].[Name], [s].[ParentCategoryId], [s].[Id0], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name0], [s].[ParentCategoryId0], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id] AS [Id0], [c0].[CreatedAt] AS [CreatedAt0], [c0].[Description] AS [Description0], [c0].[ImageUrl] AS [ImageUrl0], [c0].[IsActive] AS [IsActive0], [c0].[Name] AS [Name0], [c0].[ParentCategoryId] AS [ParentCategoryId0]
    FROM [Categories] AS [c]
    LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
    WHERE [c].[Id] = @__id_0
) AS [s]
LEFT JOIN [Books] AS [b] ON [s].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [s].[Id] = [c1].[ParentCategoryId]
ORDER BY [s].[Id], [s].[Id0], [b].[Id]
2025-10-24 00:44:56.159 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__model_CategoryId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CategoryId] = @__model_CategoryId_0
2025-10-24 00:44:56.160 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__model_CategoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CategoryId] = @__model_CategoryId_0
    ORDER BY [b].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[Title], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 00:44:56.163 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:44:56.164 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 00:44:56.165 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:44:56.167 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:44:56.170 +07:00 [INF] Executed ViewResult - view Index executed in 6.6999ms.
2025-10-24 00:44:56.171 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Category (BookStoreMVC) in 19.3156ms
2025-10-24 00:44:56.172 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Category (BookStoreMVC)'
2025-10-24 00:44:56.173 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/category/8/Sách văn học nước ngoài - 200 null text/html; charset=utf-8 30.5181ms
2025-10-24 00:45:02.614 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/Bestseller - null null
2025-10-24 00:45:02.622 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 00:45:02.623 +07:00 [INF] Route matched with {action = "Bestseller", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Bestseller(BookStoreMVC.Models.ViewModels.BookListViewModel) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 00:45:02.627 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-24 00:45:02.631 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) AS [c], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit)
    ORDER BY COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) DESC, (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id], [r0].[Id]
2025-10-24 00:45:02.636 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:45:02.637 +07:00 [INF] Executing ViewResult, running view Bestseller.
2025-10-24 00:45:02.639 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:45:02.640 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 00:45:02.642 +07:00 [INF] Executed ViewResult - view Bestseller executed in 5.0112ms.
2025-10-24 00:45:02.643 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC) in 18.0291ms
2025-10-24 00:45:02.644 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 00:45:02.645 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/Bestseller - 200 null text/html; charset=utf-8 30.5568ms
2025-10-24 01:13:18.114 +07:00 [INF] Application is shutting down...
2025-10-24 01:13:46.752 +07:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-24 01:13:48.324 +07:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-24 01:13:48.347 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-24 01:13:48.386 +07:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-24 01:13:48.454 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-24 01:13:48.474 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-24 01:13:48.479 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-24 01:13:48.491 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-24 01:13:48.503 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-10-24 01:13:48.512 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-24 01:13:48.721 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 01:13:48.763 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 01:13:48.786 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-10-24 01:13:48.825 +07:00 [INF] ✅ Database initialized with admin user only.
2025-10-24 01:13:48.832 +07:00 [INF] Database initialized successfully
2025-10-24 01:13:48.903 +07:00 [INF] ==========================================
2025-10-24 01:13:48.906 +07:00 [INF] BookStore Application Starting...
2025-10-24 01:13:48.908 +07:00 [INF] Environment: Production
2025-10-24 01:13:48.911 +07:00 [INF] Session Timeout: 7 days
2025-10-24 01:13:48.913 +07:00 [INF] Guest Cart: Enabled
2025-10-24 01:13:48.913 +07:00 [INF] ==========================================
2025-10-24 01:13:49.000 +07:00 [INF] Now listening on: http://localhost:5000
2025-10-24 01:13:49.001 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-24 01:13:49.002 +07:00 [INF] Hosting environment: Production
2025-10-24 01:13:49.003 +07:00 [INF] Content root path: C:\Users\DELL\Desktop\Bán sách\BookStoreMWC
2025-10-24 01:13:56.825 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 01:13:56.832 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-24 01:13:56.886 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 01:13:56.900 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 01:13:57.057 +07:00 [INF] Executed DbCommand (16ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:13:57.154 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:13:57.175 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:13:57.210 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:13:57.239 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:13:57.254 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 01:13:57.270 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 01:13:57.284 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 01:13:57.315 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 01:13:57.333 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:13:57.360 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 01:13:57.384 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 01:13:57.401 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:13:57.435 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:13:57.482 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 01:13:57.596 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:13:57.606 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:13:57.645 +07:00 [INF] Executed ViewResult - view Index executed in 163.6269ms.
2025-10-24 01:13:57.653 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 747.0454ms
2025-10-24 01:13:57.655 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 01:13:57.663 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 839.1894ms
2025-10-24 01:13:59.422 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/Bestseller - null null
2025-10-24 01:13:59.436 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 01:13:59.477 +07:00 [INF] Route matched with {action = "Bestseller", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Bestseller(BookStoreMVC.Models.ViewModels.BookListViewModel) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 01:13:59.550 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-24 01:13:59.557 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:13:59.587 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) AS [c], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit)
    ORDER BY COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) DESC, (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id], [r0].[Id]
2025-10-24 01:13:59.595 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:13:59.601 +07:00 [INF] Executing ViewResult, running view Bestseller.
2025-10-24 01:13:59.623 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:13:59.627 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:13:59.630 +07:00 [INF] Executed ViewResult - view Bestseller executed in 31.4108ms.
2025-10-24 01:13:59.632 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC) in 153.5743ms
2025-10-24 01:13:59.634 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 01:13:59.636 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/Bestseller - 200 null text/html; charset=utf-8 213.8421ms
2025-10-24 01:14:10.135 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/Bestseller?pageSize=12&sortBy=bestseller&sortOrder=desc&pageNumber=2 - null null
2025-10-24 01:14:10.154 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 01:14:10.157 +07:00 [INF] Route matched with {action = "Bestseller", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Bestseller(BookStoreMVC.Models.ViewModels.BookListViewModel) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 01:14:10.163 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-24 01:14:10.171 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:14:10.199 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) AS [c], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit)
    ORDER BY COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) DESC, (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id], [r0].[Id]
2025-10-24 01:14:10.207 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:14:10.211 +07:00 [INF] Executing ViewResult, running view Bestseller.
2025-10-24 01:14:10.216 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:14:10.218 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:14:10.220 +07:00 [INF] Executed ViewResult - view Bestseller executed in 9.4803ms.
2025-10-24 01:14:10.221 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC) in 62.0815ms
2025-10-24 01:14:10.222 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 01:14:10.223 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/Bestseller?pageSize=12&sortBy=bestseller&sortOrder=desc&pageNumber=2 - 200 null text/html; charset=utf-8 88.2343ms
2025-10-24 01:14:15.085 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/Bestseller?sortBy=bestseller&sortOrder=desc&pageSize=12&pageNumber=1 - null null
2025-10-24 01:14:15.093 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 01:14:15.095 +07:00 [INF] Route matched with {action = "Bestseller", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Bestseller(BookStoreMVC.Models.ViewModels.BookListViewModel) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 01:14:15.099 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-24 01:14:15.101 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) AS [c], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit)
    ORDER BY COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) DESC, (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id], [r0].[Id]
2025-10-24 01:14:15.105 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:14:15.107 +07:00 [INF] Executing ViewResult, running view Bestseller.
2025-10-24 01:14:15.111 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:14:15.113 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:14:15.115 +07:00 [INF] Executed ViewResult - view Bestseller executed in 8.1453ms.
2025-10-24 01:14:15.115 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC) in 18.7525ms
2025-10-24 01:14:15.116 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 01:14:15.117 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/Bestseller?sortBy=bestseller&sortOrder=desc&pageSize=12&pageNumber=1 - 200 null text/html; charset=utf-8 32.4306ms
2025-10-24 01:14:39.331 +07:00 [INF] Application is shutting down...
2025-10-24 01:16:44.181 +07:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-24 01:16:45.122 +07:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-24 01:16:45.137 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-24 01:16:45.167 +07:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-24 01:16:45.230 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-24 01:16:45.246 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-24 01:16:45.252 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-24 01:16:45.258 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-24 01:16:45.268 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-10-24 01:16:45.272 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-24 01:16:45.489 +07:00 [INF] Executed DbCommand (18ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 01:16:45.530 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 01:16:45.545 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-10-24 01:16:45.581 +07:00 [INF] ✅ Database initialized with admin user only.
2025-10-24 01:16:45.586 +07:00 [INF] Database initialized successfully
2025-10-24 01:16:45.651 +07:00 [INF] ==========================================
2025-10-24 01:16:45.652 +07:00 [INF] BookStore Application Starting...
2025-10-24 01:16:45.653 +07:00 [INF] Environment: Production
2025-10-24 01:16:45.654 +07:00 [INF] Session Timeout: 7 days
2025-10-24 01:16:45.654 +07:00 [INF] Guest Cart: Enabled
2025-10-24 01:16:45.655 +07:00 [INF] ==========================================
2025-10-24 01:16:45.717 +07:00 [INF] Now listening on: http://localhost:5000
2025-10-24 01:16:45.720 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-24 01:16:45.722 +07:00 [INF] Hosting environment: Production
2025-10-24 01:16:45.723 +07:00 [INF] Content root path: C:\Users\DELL\Desktop\Bán sách\BookStoreMWC
2025-10-24 01:16:47.193 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 01:16:47.201 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-24 01:16:47.264 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 01:16:47.276 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 01:16:47.440 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:16:47.542 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:16:47.561 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:16:47.595 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:16:47.624 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:16:47.637 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 01:16:47.654 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 01:16:47.668 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 01:16:47.698 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 01:16:47.716 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:16:47.743 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 01:16:47.770 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 01:16:47.784 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:16:47.816 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:16:47.863 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 01:16:47.970 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:16:47.983 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:16:48.021 +07:00 [INF] Executed ViewResult - view Index executed in 158.51ms.
2025-10-24 01:16:48.032 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 750.1462ms
2025-10-24 01:16:48.036 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 01:16:48.044 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 851.5127ms
2025-10-24 01:16:49.430 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/Bestseller - null null
2025-10-24 01:16:49.446 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 01:16:49.506 +07:00 [INF] Route matched with {action = "Bestseller", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Bestseller(BookStoreMVC.Models.ViewModels.BookListViewModel) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 01:16:49.590 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-24 01:16:49.611 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:16:49.649 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) AS [c], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit)
    ORDER BY COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) DESC, (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id], [r0].[Id]
2025-10-24 01:16:49.661 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:16:49.666 +07:00 [INF] Executing ViewResult, running view Bestseller.
2025-10-24 01:16:49.699 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:16:49.706 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:16:49.712 +07:00 [INF] Executed ViewResult - view Bestseller executed in 47.093ms.
2025-10-24 01:16:49.715 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC) in 203.7025ms
2025-10-24 01:16:49.716 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 01:16:49.717 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/Bestseller - 200 null text/html; charset=utf-8 287.1479ms
2025-10-24 01:17:27.921 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 01:17:27.934 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 01:17:27.935 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 01:17:27.943 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:17:27.951 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:17:27.957 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:17:27.964 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:17:27.966 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 01:17:27.968 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 01:17:27.970 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 01:17:27.972 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 01:17:27.974 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 01:17:27.978 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 01:17:27.981 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:17:27.984 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 01:17:27.988 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:17:27.990 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:17:27.993 +07:00 [INF] Executed ViewResult - view Index executed in 8.8035ms.
2025-10-24 01:17:27.994 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 57.6246ms
2025-10-24 01:17:27.996 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 01:17:27.997 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 75.7394ms
2025-10-24 01:17:31.259 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Wishlist/Toggle - application/json 12
2025-10-24 01:17:31.271 +07:00 [INF] CORS policy execution failed.
2025-10-24 01:17:31.272 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 01:17:31.273 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Wishlist/Toggle - 404 0 null 13.6442ms
2025-10-24 01:17:31.275 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST http://localhost:5000/Wishlist/Toggle, Response status code: 404
2025-10-24 01:17:33.294 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/wishlist - null null
2025-10-24 01:17:33.307 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-10-24 01:17:33.311 +07:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2025-10-24 01:17:33.313 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/wishlist - 302 0 null 18.4247ms
2025-10-24 01:17:33.315 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Account/Login?ReturnUrl=%2Fwishlist - null null
2025-10-24 01:17:33.321 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 01:17:33.322 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 01:17:33.340 +07:00 [INF] Executing ViewResult, running view Login.
2025-10-24 01:17:33.373 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:17:33.379 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:17:33.424 +07:00 [INF] Executed ViewResult - view Login executed in 85.2067ms.
2025-10-24 01:17:33.426 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 102.5842ms
2025-10-24 01:17:33.429 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 01:17:33.431 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Account/Login?ReturnUrl=%2Fwishlist - 200 null text/html; charset=utf-8 116.2039ms
2025-10-24 01:17:33.444 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - null null
2025-10-24 01:17:33.444 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - null null
2025-10-24 01:17:33.450 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - 404 0 null 6.1126ms
2025-10-24 01:17:33.452 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - 404 0 null 7.7013ms
2025-10-24 01:17:33.452 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/bookverse-core.js, Response status code: 404
2025-10-24 01:17:33.453 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/auth-validation.js, Response status code: 404
2025-10-24 01:18:34.189 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/Promotions - null null
2025-10-24 01:18:34.202 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Promotions (BookStoreMVC)'
2025-10-24 01:18:34.209 +07:00 [INF] Route matched with {action = "Promotions", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Promotions(BookStoreMVC.Models.ViewModels.BookListViewModel) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 01:18:34.216 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 01:18:34.221 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:18:34.226 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:18:34.229 +07:00 [INF] Executing ViewResult, running view Promotions.
2025-10-24 01:18:34.231 +07:00 [ERR] The view 'Promotions' was not found. Searched locations: ["/Views/Books/Promotions.cshtml","/Views/Shared/Promotions.cshtml"]
2025-10-24 01:18:34.234 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Promotions (BookStoreMVC) in 22.9104ms
2025-10-24 01:18:34.235 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Promotions (BookStoreMVC)'
2025-10-24 01:18:34.236 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The view 'Promotions' was not found. The following locations were searched:
/Views/Books/Promotions.cshtml
/Views/Shared/Promotions.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_11>d.MoveNext() in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Program.cs:line 265
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-10-24 01:18:34.271 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Error (BookStoreMVC)'
2025-10-24 01:18:34.275 +07:00 [INF] Route matched with {action = "Error", controller = "Home"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Error() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 01:18:34.282 +07:00 [INF] Executing ViewResult, running view Error.
2025-10-24 01:18:34.286 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:18:34.288 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:18:34.291 +07:00 [INF] Executed ViewResult - view Error executed in 9.3598ms.
2025-10-24 01:18:34.292 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Error (BookStoreMVC) in 11.5827ms
2025-10-24 01:18:34.293 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Error (BookStoreMVC)'
2025-10-24 01:18:34.295 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/Promotions - 500 null text/html; charset=utf-8 105.6397ms
2025-10-24 01:18:35.923 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Home/Contact - null null
2025-10-24 01:18:35.929 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Contact (BookStoreMVC)'
2025-10-24 01:18:35.931 +07:00 [INF] Route matched with {action = "Contact", controller = "Home"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Contact() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 01:18:35.935 +07:00 [INF] Executing ViewResult, running view Contact.
2025-10-24 01:18:35.938 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Contact (BookStoreMVC) in 5.647ms
2025-10-24 01:18:35.940 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Contact (BookStoreMVC)'
2025-10-24 01:18:35.940 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The partial view '_Breadcrumb' was not found. The following locations were searched:
/Views/Home/_Breadcrumb.cshtml
/Views/Shared/_Breadcrumb.cshtml
   at Microsoft.AspNetCore.Mvc.ViewFeatures.HtmlHelper.RenderPartialCoreAsync(String partialViewName, Object model, ViewDataDictionary viewData, TextWriter writer)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.HtmlHelper.PartialAsync(String partialViewName, Object model, ViewDataDictionary viewData)
   at AspNetCoreGeneratedDocument.Views_Home_Contact.ExecuteAsync() in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Views\Home\Contact.cshtml:line 4
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, Boolean invokeViewStarts)
   at Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, String contentType, Nullable`1 statusCode)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)
   at Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResultFilterAsync>g__Awaited|30_0[TFilter,TFilterAsync](ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResultExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.ResultNext[TFilter,TFilterAsync](State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeResultFilters()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_11>d.MoveNext() in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Program.cs:line 265
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-10-24 01:18:35.950 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Error (BookStoreMVC)'
2025-10-24 01:18:35.951 +07:00 [INF] Route matched with {action = "Error", controller = "Home"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Error() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 01:18:35.952 +07:00 [INF] Executing ViewResult, running view Error.
2025-10-24 01:18:35.954 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:18:35.958 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:18:35.960 +07:00 [INF] Executed ViewResult - view Error executed in 7.2018ms.
2025-10-24 01:18:35.960 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Error (BookStoreMVC) in 8.2524ms
2025-10-24 01:18:35.961 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Error (BookStoreMVC)'
2025-10-24 01:18:35.962 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Home/Contact - 500 null text/html; charset=utf-8 39.1227ms
2025-10-24 01:18:37.412 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 01:18:37.420 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 01:18:37.423 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 01:18:37.433 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:18:37.449 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:18:37.464 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:18:37.474 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:18:37.477 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 01:18:37.479 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 01:18:37.481 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 01:18:37.483 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 01:18:37.527 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 01:18:37.531 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 01:18:37.534 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:18:37.536 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 01:18:37.540 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:18:37.543 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:18:37.545 +07:00 [INF] Executed ViewResult - view Index executed in 8.378ms.
2025-10-24 01:18:37.545 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 116.6604ms
2025-10-24 01:18:37.547 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 01:18:37.547 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 135.8062ms
2025-10-24 01:18:38.227 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/NewBooks - null null
2025-10-24 01:18:38.241 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC)'
2025-10-24 01:18:38.255 +07:00 [INF] Route matched with {action = "NewBooks", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] NewBooks(System.String, System.String, Int32) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 01:18:38.282 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
2025-10-24 01:18:38.293 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:18:38.323 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
    ORDER BY [b].[CreatedAt] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:18:38.335 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:18:38.338 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 01:18:38.342 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:18:38.347 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
2025-10-24 01:18:38.349 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
    ORDER BY [b].[CreatedAt] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:18:38.353 +07:00 [INF] Executing ViewResult, running view NewBooks.
2025-10-24 01:18:38.372 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:18:38.378 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:18:38.381 +07:00 [INF] Executed ViewResult - view NewBooks executed in 27.607ms.
2025-10-24 01:18:38.381 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC) in 120.9908ms
2025-10-24 01:18:38.382 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC)'
2025-10-24 01:18:38.383 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/NewBooks - 200 null text/html; charset=utf-8 155.4259ms
2025-10-24 01:18:42.466 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/cart - null null
2025-10-24 01:18:42.473 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-24 01:18:42.479 +07:00 [INF] Route matched with {action = "Index", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-24 01:18:42.487 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 01:18:42.496 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:18:42.501 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:18:42.505 +07:00 [INF] Executed ViewResult - view Index executed in 17.645ms.
2025-10-24 01:18:42.505 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.Index (BookStoreMVC) in 23.2277ms
2025-10-24 01:18:42.508 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-24 01:18:42.509 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/cart - 200 null text/html; charset=utf-8 42.5161ms
2025-10-24 01:18:52.092 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/Bestseller - null null
2025-10-24 01:18:52.096 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 01:18:52.099 +07:00 [INF] Route matched with {action = "Bestseller", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Bestseller(BookStoreMVC.Models.ViewModels.BookListViewModel) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 01:18:52.102 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-24 01:18:52.107 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) AS [c], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit)
    ORDER BY COALESCE((
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]), 0) DESC, (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id], [r0].[Id]
2025-10-24 01:18:52.113 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:18:52.116 +07:00 [INF] Executing ViewResult, running view Bestseller.
2025-10-24 01:18:52.118 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:18:52.119 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:18:52.121 +07:00 [INF] Executed ViewResult - view Bestseller executed in 5.7608ms.
2025-10-24 01:18:52.122 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC) in 21.4635ms
2025-10-24 01:18:52.123 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Bestseller (BookStoreMVC)'
2025-10-24 01:18:52.124 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/Bestseller - 200 null text/html; charset=utf-8 32.0121ms
2025-10-24 01:19:13.709 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/NewBooks - null null
2025-10-24 01:19:13.720 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC)'
2025-10-24 01:19:13.724 +07:00 [INF] Route matched with {action = "NewBooks", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] NewBooks(System.String, System.String, Int32) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 01:19:13.734 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
2025-10-24 01:19:13.741 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
    ORDER BY [b].[CreatedAt] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:19:13.746 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:19:13.748 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 01:19:13.752 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:19:13.755 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
2025-10-24 01:19:13.758 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
    ORDER BY [b].[CreatedAt] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:19:13.761 +07:00 [INF] Executing ViewResult, running view NewBooks.
2025-10-24 01:19:13.764 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:19:13.766 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:19:13.767 +07:00 [INF] Executed ViewResult - view NewBooks executed in 6.4619ms.
2025-10-24 01:19:13.768 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC) in 39.0097ms
2025-10-24 01:19:13.769 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC)'
2025-10-24 01:19:13.770 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/NewBooks - 200 null text/html; charset=utf-8 60.8921ms
2025-10-24 01:22:42.392 +07:00 [INF] Application is shutting down...
2025-10-24 01:25:58.873 +07:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-24 01:25:59.694 +07:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-24 01:25:59.710 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-24 01:25:59.736 +07:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-24 01:25:59.797 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-24 01:25:59.814 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-24 01:25:59.816 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-24 01:25:59.822 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-24 01:25:59.832 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-10-24 01:25:59.835 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-24 01:26:00.062 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 01:26:00.100 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 01:26:00.115 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-10-24 01:26:00.150 +07:00 [INF] ✅ Database initialized with admin user only.
2025-10-24 01:26:00.155 +07:00 [INF] Database initialized successfully
2025-10-24 01:26:00.235 +07:00 [INF] ==========================================
2025-10-24 01:26:00.238 +07:00 [INF] BookStore Application Starting...
2025-10-24 01:26:00.241 +07:00 [INF] Environment: Production
2025-10-24 01:26:00.242 +07:00 [INF] Session Timeout: 7 days
2025-10-24 01:26:00.242 +07:00 [INF] Guest Cart: Enabled
2025-10-24 01:26:00.243 +07:00 [INF] ==========================================
2025-10-24 01:26:00.312 +07:00 [INF] Now listening on: http://localhost:5000
2025-10-24 01:26:00.314 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-24 01:26:00.316 +07:00 [INF] Hosting environment: Production
2025-10-24 01:26:00.317 +07:00 [INF] Content root path: C:\Users\DELL\Desktop\Bán sách\BookStoreMWC
2025-10-24 01:26:02.928 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 01:26:02.932 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-24 01:26:02.979 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 01:26:02.993 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 01:26:03.142 +07:00 [INF] Executed DbCommand (20ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:26:03.236 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:26:03.257 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:26:03.292 +07:00 [INF] Executed DbCommand (14ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:26:03.326 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:26:03.338 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 01:26:03.351 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 01:26:03.364 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 01:26:03.396 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 01:26:03.414 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:26:03.446 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 01:26:03.485 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 01:26:03.498 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:26:03.531 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:26:03.576 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 01:26:03.672 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:26:03.680 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:26:03.716 +07:00 [INF] Executed ViewResult - view Index executed in 142.7696ms.
2025-10-24 01:26:03.724 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 727.1736ms
2025-10-24 01:26:03.728 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 01:26:03.741 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 814.1819ms
2025-10-24 01:26:05.652 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Wishlist/Toggle - application/json 12
2025-10-24 01:26:05.670 +07:00 [INF] CORS policy execution failed.
2025-10-24 01:26:05.673 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 01:26:05.680 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-10-24 01:26:05.684 +07:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2025-10-24 01:26:05.685 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Wishlist/Toggle - 302 0 null 32.924ms
2025-10-24 01:26:05.689 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Account/Login?ReturnUrl=%2FWishlist%2FToggle - null null
2025-10-24 01:26:05.695 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 01:26:05.700 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 01:26:05.713 +07:00 [INF] Executing ViewResult, running view Login.
2025-10-24 01:26:05.803 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:26:05.807 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:26:05.815 +07:00 [INF] Executed ViewResult - view Login executed in 101.7848ms.
2025-10-24 01:26:05.816 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 114.801ms
2025-10-24 01:26:05.817 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 01:26:05.818 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Account/Login?ReturnUrl=%2FWishlist%2FToggle - 200 null text/html; charset=utf-8 129.0143ms
2025-10-24 01:26:10.165 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/account/Login - null null
2025-10-24 01:26:10.178 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 01:26:10.183 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 01:26:10.196 +07:00 [INF] Executing ViewResult, running view Login.
2025-10-24 01:26:10.206 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:26:10.215 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:26:10.218 +07:00 [INF] Executed ViewResult - view Login executed in 21.977ms.
2025-10-24 01:26:10.219 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 30.6174ms
2025-10-24 01:26:10.221 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 01:26:10.223 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/account/Login - 200 null text/html; charset=utf-8 57.9021ms
2025-10-24 01:26:10.346 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - null null
2025-10-24 01:26:10.346 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - null null
2025-10-24 01:26:10.358 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - 404 0 null 12.1106ms
2025-10-24 01:26:10.365 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - 404 0 null 19.061ms
2025-10-24 01:26:10.368 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/auth-validation.js, Response status code: 404
2025-10-24 01:26:10.375 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/bookverse-core.js, Response status code: 404
2025-10-24 01:26:28.129 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/account/Login - application/x-www-form-urlencoded 248
2025-10-24 01:26:28.133 +07:00 [INF] CORS policy execution failed.
2025-10-24 01:26:28.135 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 01:26:28.137 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 01:26:28.146 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BookStoreMVC.Models.ViewModels.LoginViewModel, System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 01:26:28.188 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-10-24 01:26:28.290 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2025-10-24 01:26:28.311 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-10-24 01:26:28.316 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 01:26:28.326 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2025-10-24 01:26:28.335 +07:00 [INF] AuthenticationScheme: Identity.Application signed in.
2025-10-24 01:26:28.337 +07:00 [INF] User logged in.
2025-10-24 01:26:28.339 +07:00 [INF] Executing RedirectResult, redirecting to /.
2025-10-24 01:26:28.340 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 190.1535ms
2025-10-24 01:26:28.341 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 01:26:28.341 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/account/Login - 302 0 null 212.7953ms
2025-10-24 01:26:28.344 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 01:26:28.347 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 01:26:28.348 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 01:26:28.353 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:26:28.358 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:26:28.362 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:26:28.367 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:26:28.370 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 01:26:28.372 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 01:26:28.374 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 01:26:28.377 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 01:26:28.380 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 01:26:28.384 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 01:26:28.387 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:26:28.391 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 01:26:28.395 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:26:28.397 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:26:28.402 +07:00 [INF] Executed ViewResult - view Index executed in 11.0579ms.
2025-10-24 01:26:28.404 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 54.2308ms
2025-10-24 01:26:28.404 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 01:26:28.405 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 61.2697ms
2025-10-24 01:26:30.604 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Wishlist/Toggle - application/json 12
2025-10-24 01:26:30.616 +07:00 [INF] CORS policy execution failed.
2025-10-24 01:26:30.617 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 01:26:30.620 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 01:26:30.623 +07:00 [INF] Route matched with {action = "Toggle", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Toggle(BookStoreMVC.Models.ViewModels.AddToWishlistViewModel) on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 01:26:30.650 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__bookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[IsActive]
FROM [Books] AS [b]
WHERE [b].[Id] = @__bookId_0
2025-10-24 01:26:30.661 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [w].[Id], [w].[BookId], [w].[CreatedAt], [w].[UserId]
FROM [WishlistItems] AS [w]
WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1
2025-10-24 01:26:30.733 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [WishlistItems] ([BookId], [CreatedAt], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2025-10-24 01:26:30.757 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [WishlistItems] AS [w]
WHERE [w].[UserId] = @__userId_0
2025-10-24 01:26:30.762 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType35`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-24 01:26:30.769 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC) in 145.2898ms
2025-10-24 01:26:30.770 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 01:26:30.770 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Wishlist/Toggle - 200 null application/json; charset=utf-8 166.0976ms
2025-10-24 01:26:32.811 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/wishlist - null null
2025-10-24 01:26:32.819 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 01:26:32.824 +07:00 [INF] Route matched with {action = "Index", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 01:26:32.861 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[BookId], [w].[CreatedAt], [w].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [WishlistItems] AS [w]
INNER JOIN [Books] AS [b] ON [w].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [w].[UserId] = @__userId_0
ORDER BY [w].[CreatedAt] DESC, [w].[Id], [b].[Id], [c].[Id]
2025-10-24 01:26:32.872 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 01:26:32.890 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:26:32.893 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:26:32.896 +07:00 [INF] Executed ViewResult - view Index executed in 25.4422ms.
2025-10-24 01:26:32.898 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC) in 71.1302ms
2025-10-24 01:26:32.900 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 01:26:32.902 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/wishlist - 200 null text/html; charset=utf-8 90.6022ms
2025-10-24 01:26:32.910 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/no-book-cover.png - null null
2025-10-24 01:26:32.913 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/no-book-cover.png - 404 0 null 2.8282ms
2025-10-24 01:26:32.915 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/no-book-cover.png, Response status code: 404
2025-10-24 01:26:48.546 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Wishlist/Toggle - application/json 12
2025-10-24 01:26:48.558 +07:00 [INF] CORS policy execution failed.
2025-10-24 01:26:48.561 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 01:26:48.563 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 01:26:48.565 +07:00 [INF] Route matched with {action = "Toggle", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Toggle(BookStoreMVC.Models.ViewModels.AddToWishlistViewModel) on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 01:26:48.570 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__bookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[IsActive]
FROM [Books] AS [b]
WHERE [b].[Id] = @__bookId_0
2025-10-24 01:26:48.574 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [w].[Id], [w].[BookId], [w].[CreatedAt], [w].[UserId]
FROM [WishlistItems] AS [w]
WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1
2025-10-24 01:26:48.580 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [WishlistItems] ([BookId], [CreatedAt], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2025-10-24 01:26:48.583 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [WishlistItems] AS [w]
WHERE [w].[UserId] = @__userId_0
2025-10-24 01:26:48.586 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType35`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-24 01:26:48.587 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC) in 20.7251ms
2025-10-24 01:26:48.588 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 01:26:48.589 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Wishlist/Toggle - 200 null application/json; charset=utf-8 42.4265ms
2025-10-24 01:26:53.037 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/wishlist - null null
2025-10-24 01:26:53.045 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 01:26:53.046 +07:00 [INF] Route matched with {action = "Index", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 01:26:53.050 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[BookId], [w].[CreatedAt], [w].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [WishlistItems] AS [w]
INNER JOIN [Books] AS [b] ON [w].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [w].[UserId] = @__userId_0
ORDER BY [w].[CreatedAt] DESC, [w].[Id], [b].[Id], [c].[Id]
2025-10-24 01:26:53.053 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 01:26:53.055 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:26:53.057 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:26:53.059 +07:00 [INF] Executed ViewResult - view Index executed in 6.0909ms.
2025-10-24 01:26:53.060 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC) in 11.7922ms
2025-10-24 01:26:53.062 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 01:26:53.064 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/wishlist - 200 null text/html; charset=utf-8 26.3635ms
2025-10-24 01:26:53.076 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/no-book-cover.png - null null
2025-10-24 01:26:53.078 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/no-book-cover.png - 404 0 null 1.8157ms
2025-10-24 01:26:53.083 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/no-book-cover.png, Response status code: 404
2025-10-24 01:26:57.885 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/books/1 - null null
2025-10-24 01:26:57.893 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 01:26:57.897 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 01:26:57.914 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:26:57.953 +07:00 [INF] Executed DbCommand (18ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 01:26:58.004 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:26:58.023 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 01:26:58.031 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 01:26:58.039 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 01:26:58.047 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [WishlistItems] AS [w]
        WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 01:26:58.058 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__bookId_1
2025-10-24 01:26:58.061 +07:00 [INF] Book 1 - AdditionalImages: ["/images/books/gallery/747bf3dd-b187-424e-bb5a-152167091a35.jpg"], GalleryCount: 1, HasGallery: true
2025-10-24 01:26:58.064 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 01:26:58.073 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:26:58.076 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:26:58.082 +07:00 [INF] Executed ViewResult - view Details executed in 18.279ms.
2025-10-24 01:26:58.083 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 183.247ms
2025-10-24 01:26:58.084 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 01:26:58.085 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/books/1 - 200 null text/html; charset=utf-8 200.2657ms
2025-10-24 01:26:58.095 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/gallery/747bf3dd-b187-424e-bb5a-152167091a35.jpg - null null
2025-10-24 01:26:58.124 +07:00 [INF] Sending file. Request path: '/images/books/gallery/747bf3dd-b187-424e-bb5a-152167091a35.jpg'. Physical path: 'C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\wwwroot\images\books\gallery\747bf3dd-b187-424e-bb5a-152167091a35.jpg'
2025-10-24 01:26:58.126 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/gallery/747bf3dd-b187-424e-bb5a-152167091a35.jpg - 200 58101 image/jpeg 30.3823ms
2025-10-24 01:27:04.357 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/wishlist - null null
2025-10-24 01:27:04.363 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 01:27:04.365 +07:00 [INF] Route matched with {action = "Index", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 01:27:04.371 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[BookId], [w].[CreatedAt], [w].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [WishlistItems] AS [w]
INNER JOIN [Books] AS [b] ON [w].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [w].[UserId] = @__userId_0
ORDER BY [w].[CreatedAt] DESC, [w].[Id], [b].[Id], [c].[Id]
2025-10-24 01:27:04.376 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 01:27:04.378 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:27:04.381 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:27:04.383 +07:00 [INF] Executed ViewResult - view Index executed in 6.6352ms.
2025-10-24 01:27:04.384 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC) in 15.8628ms
2025-10-24 01:27:04.385 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 01:27:04.386 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/wishlist - 200 null text/html; charset=utf-8 29.0312ms
2025-10-24 01:27:04.397 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/no-book-cover.png - null null
2025-10-24 01:27:04.399 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/no-book-cover.png - 404 0 null 1.8584ms
2025-10-24 01:27:04.401 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/no-book-cover.png, Response status code: 404
2025-10-24 01:39:34.898 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/wishlist - null null
2025-10-24 01:39:34.904 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 01:39:34.908 +07:00 [INF] Route matched with {action = "Index", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 01:39:35.729 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[BookId], [w].[CreatedAt], [w].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [WishlistItems] AS [w]
INNER JOIN [Books] AS [b] ON [w].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [w].[UserId] = @__userId_0
ORDER BY [w].[CreatedAt] DESC, [w].[Id], [b].[Id], [c].[Id]
2025-10-24 01:39:35.734 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 01:39:35.738 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:39:35.742 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:39:35.744 +07:00 [INF] Executed ViewResult - view Index executed in 10.5889ms.
2025-10-24 01:39:35.746 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC) in 836.6452ms
2025-10-24 01:39:35.746 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 01:39:35.747 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/wishlist - 200 null text/html; charset=utf-8 848.7143ms
2025-10-24 01:39:35.754 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/no-book-cover.png - null null
2025-10-24 01:39:35.758 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/no-book-cover.png - 404 0 null 3.6857ms
2025-10-24 01:39:35.760 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/no-book-cover.png, Response status code: 404
2025-10-24 01:39:35.781 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/BOOK.png?v=QztAXuOfgcsIJZg3XCCS1qK3ZFO0Q3cC8g9UFxPKzyQ - null null
2025-10-24 01:39:35.785 +07:00 [INF] The file /BOOK.png was not modified
2025-10-24 01:39:35.786 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/BOOK.png?v=QztAXuOfgcsIJZg3XCCS1qK3ZFO0Q3cC8g9UFxPKzyQ - 304 null image/png 4.3777ms
2025-10-24 01:39:37.364 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/wishlist - null null
2025-10-24 01:39:37.375 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 01:39:37.376 +07:00 [INF] Route matched with {action = "Index", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 01:39:37.380 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[BookId], [w].[CreatedAt], [w].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [WishlistItems] AS [w]
INNER JOIN [Books] AS [b] ON [w].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [w].[UserId] = @__userId_0
ORDER BY [w].[CreatedAt] DESC, [w].[Id], [b].[Id], [c].[Id]
2025-10-24 01:39:37.383 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 01:39:37.386 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:39:37.388 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:39:37.389 +07:00 [INF] Executed ViewResult - view Index executed in 6.7987ms.
2025-10-24 01:39:37.390 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC) in 13.0949ms
2025-10-24 01:39:37.391 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 01:39:37.392 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/wishlist - 200 null text/html; charset=utf-8 27.6456ms
2025-10-24 01:39:37.400 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/no-book-cover.png - null null
2025-10-24 01:39:37.404 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/no-book-cover.png - 404 0 null 3.1291ms
2025-10-24 01:39:37.405 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/no-book-cover.png, Response status code: 404
2025-10-24 01:42:52.435 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/NewBooks - null null
2025-10-24 01:42:52.446 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC)'
2025-10-24 01:42:52.450 +07:00 [INF] Route matched with {action = "NewBooks", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] NewBooks(System.String, System.String, Int32) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 01:42:52.460 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
2025-10-24 01:42:52.465 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:42:52.491 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
    ORDER BY [b].[CreatedAt] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:42:52.500 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:42:52.506 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 01:42:52.515 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:42:52.520 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
2025-10-24 01:42:52.523 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
    ORDER BY [b].[CreatedAt] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:42:52.528 +07:00 [INF] Executing ViewResult, running view NewBooks.
2025-10-24 01:42:52.543 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:42:52.547 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:42:52.549 +07:00 [INF] Executed ViewResult - view NewBooks executed in 20.8637ms.
2025-10-24 01:42:52.551 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC) in 100.407ms
2025-10-24 01:42:52.552 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC)'
2025-10-24 01:42:52.553 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/NewBooks - 200 null text/html; charset=utf-8 118.2393ms
2025-10-24 01:42:53.106 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/NewBooks - null null
2025-10-24 01:42:53.115 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC)'
2025-10-24 01:42:53.116 +07:00 [INF] Route matched with {action = "NewBooks", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] NewBooks(System.String, System.String, Int32) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 01:42:53.119 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
2025-10-24 01:42:53.121 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
    ORDER BY [b].[CreatedAt] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:42:53.125 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:42:53.126 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 01:42:53.128 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:42:53.131 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
2025-10-24 01:42:53.132 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
    ORDER BY [b].[CreatedAt] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:42:53.134 +07:00 [INF] Executing ViewResult, running view NewBooks.
2025-10-24 01:42:53.137 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:42:53.139 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:42:53.141 +07:00 [INF] Executed ViewResult - view NewBooks executed in 6.8152ms.
2025-10-24 01:42:53.142 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC) in 24.4072ms
2025-10-24 01:42:53.143 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC)'
2025-10-24 01:42:53.145 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/NewBooks - 200 null text/html; charset=utf-8 38.2465ms
2025-10-24 01:42:55.352 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 01:42:55.359 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 01:42:55.363 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 01:42:55.376 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:42:55.382 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:42:55.395 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:42:55.398 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:42:55.404 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 01:42:55.409 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 01:42:55.411 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 01:42:55.415 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 01:42:55.418 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 01:42:55.422 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 01:42:55.430 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:42:55.432 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 01:42:55.435 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:42:55.436 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:42:55.439 +07:00 [INF] Executed ViewResult - view Index executed in 7.077ms.
2025-10-24 01:42:55.440 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 75.4466ms
2025-10-24 01:42:55.442 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 01:42:55.443 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 90.8726ms
2025-10-24 01:42:57.015 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/wishlist - null null
2025-10-24 01:42:57.023 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 01:42:57.023 +07:00 [INF] Route matched with {action = "Index", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 01:42:57.026 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[BookId], [w].[CreatedAt], [w].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [WishlistItems] AS [w]
INNER JOIN [Books] AS [b] ON [w].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [w].[UserId] = @__userId_0
ORDER BY [w].[CreatedAt] DESC, [w].[Id], [b].[Id], [c].[Id]
2025-10-24 01:42:57.028 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 01:42:57.030 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:42:57.032 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:42:57.034 +07:00 [INF] Executed ViewResult - view Index executed in 6.0784ms.
2025-10-24 01:42:57.035 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC) in 10.0941ms
2025-10-24 01:42:57.037 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 01:42:57.038 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/wishlist - 200 null text/html; charset=utf-8 22.4722ms
2025-10-24 01:42:57.051 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/no-book-cover.png - null null
2025-10-24 01:42:57.054 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/no-book-cover.png - 404 0 null 3.1712ms
2025-10-24 01:42:57.056 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/no-book-cover.png, Response status code: 404
2025-10-24 01:42:58.957 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/wishlist - null null
2025-10-24 01:42:58.968 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 01:42:58.973 +07:00 [INF] Route matched with {action = "Index", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 01:42:58.976 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[BookId], [w].[CreatedAt], [w].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [WishlistItems] AS [w]
INNER JOIN [Books] AS [b] ON [w].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [w].[UserId] = @__userId_0
ORDER BY [w].[CreatedAt] DESC, [w].[Id], [b].[Id], [c].[Id]
2025-10-24 01:42:58.979 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 01:42:58.981 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:42:58.982 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:42:58.985 +07:00 [INF] Executed ViewResult - view Index executed in 6.0957ms.
2025-10-24 01:42:58.986 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC) in 11.4301ms
2025-10-24 01:42:58.987 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 01:42:58.988 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/wishlist - 200 null text/html; charset=utf-8 31.066ms
2025-10-24 01:42:58.996 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/no-book-cover.png - null null
2025-10-24 01:42:58.999 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/no-book-cover.png - 404 0 null 2.1752ms
2025-10-24 01:42:59.000 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/no-book-cover.png, Response status code: 404
2025-10-24 01:43:11.912 +07:00 [INF] Application is shutting down...
2025-10-24 01:43:39.205 +07:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-24 01:43:40.035 +07:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-24 01:43:40.050 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-24 01:43:40.082 +07:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-24 01:43:40.143 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-24 01:43:40.163 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-24 01:43:40.168 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-24 01:43:40.173 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-24 01:43:40.181 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-10-24 01:43:40.188 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-24 01:43:40.393 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 01:43:40.432 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 01:43:40.449 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-10-24 01:43:40.490 +07:00 [INF] ✅ Database initialized with admin user only.
2025-10-24 01:43:40.496 +07:00 [INF] Database initialized successfully
2025-10-24 01:43:40.564 +07:00 [INF] ==========================================
2025-10-24 01:43:40.567 +07:00 [INF] BookStore Application Starting...
2025-10-24 01:43:40.568 +07:00 [INF] Environment: Production
2025-10-24 01:43:40.571 +07:00 [INF] Session Timeout: 7 days
2025-10-24 01:43:40.573 +07:00 [INF] Guest Cart: Enabled
2025-10-24 01:43:40.575 +07:00 [INF] ==========================================
2025-10-24 01:43:40.644 +07:00 [INF] Now listening on: http://localhost:5000
2025-10-24 01:43:40.649 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-24 01:43:40.651 +07:00 [INF] Hosting environment: Production
2025-10-24 01:43:40.652 +07:00 [INF] Content root path: C:\Users\DELL\Desktop\Bán sách\BookStoreMWC
2025-10-24 01:43:43.299 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 01:43:43.305 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-24 01:43:43.361 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 01:43:43.373 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 01:43:43.550 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:43:43.652 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:43:43.670 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:43:43.702 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:43:43.728 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:43:43.742 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 01:43:43.760 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 01:43:43.775 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 01:43:43.802 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 01:43:43.820 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:43:43.850 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 01:43:43.876 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 01:43:43.890 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:43:43.917 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:43:43.960 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 01:43:44.059 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:43:44.072 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:43:44.107 +07:00 [INF] Executed ViewResult - view Index executed in 145.7109ms.
2025-10-24 01:43:44.113 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 738.0774ms
2025-10-24 01:43:44.116 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 01:43:44.125 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 827.7614ms
2025-10-24 01:43:48.186 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Wishlist/Toggle - application/json 12
2025-10-24 01:43:48.201 +07:00 [INF] CORS policy execution failed.
2025-10-24 01:43:48.202 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 01:43:48.219 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 01:43:48.231 +07:00 [INF] Route matched with {action = "Toggle", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Toggle(BookStoreMVC.Models.ViewModels.AddToWishlistViewModel) on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 01:43:48.313 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__bookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[IsActive]
FROM [Books] AS [b]
WHERE [b].[Id] = @__bookId_0
2025-10-24 01:43:48.336 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [w].[Id], [w].[BookId], [w].[CreatedAt], [w].[UserId]
FROM [WishlistItems] AS [w]
WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1
2025-10-24 01:43:48.427 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [WishlistItems] ([BookId], [CreatedAt], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2025-10-24 01:43:48.450 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [WishlistItems] AS [w]
WHERE [w].[UserId] = @__userId_0
2025-10-24 01:43:48.453 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType35`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-24 01:43:48.462 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC) in 225.8494ms
2025-10-24 01:43:48.463 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 01:43:48.465 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Wishlist/Toggle - 200 null application/json; charset=utf-8 279.0723ms
2025-10-24 01:43:50.415 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/wishlist - null null
2025-10-24 01:43:50.436 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 01:43:50.443 +07:00 [INF] Route matched with {action = "Index", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 01:43:50.475 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[BookId], [w].[CreatedAt], [w].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [WishlistItems] AS [w]
INNER JOIN [Books] AS [b] ON [w].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [w].[UserId] = @__userId_0
ORDER BY [w].[CreatedAt] DESC, [w].[Id], [b].[Id], [c].[Id]
2025-10-24 01:43:50.486 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 01:43:50.506 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:43:50.515 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:43:50.522 +07:00 [INF] Executed ViewResult - view Index executed in 36.6505ms.
2025-10-24 01:43:50.524 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC) in 77.6836ms
2025-10-24 01:43:50.525 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 01:43:50.527 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/wishlist - 200 null text/html; charset=utf-8 111.5055ms
2025-10-24 01:51:14.995 +07:00 [INF] Application is shutting down...
2025-10-24 01:58:11.101 +07:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-24 01:58:12.716 +07:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-24 01:58:12.734 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-24 01:58:12.767 +07:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-24 01:58:12.848 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-24 01:58:12.869 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-24 01:58:12.875 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-24 01:58:12.882 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-24 01:58:12.891 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-10-24 01:58:12.896 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-24 01:58:13.128 +07:00 [INF] Executed DbCommand (19ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 01:58:13.171 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 01:58:13.194 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-10-24 01:58:13.234 +07:00 [INF] ✅ Database initialized with admin user only.
2025-10-24 01:58:13.242 +07:00 [INF] Database initialized successfully
2025-10-24 01:58:13.318 +07:00 [INF] ==========================================
2025-10-24 01:58:13.322 +07:00 [INF] BookStore Application Starting...
2025-10-24 01:58:13.323 +07:00 [INF] Environment: Production
2025-10-24 01:58:13.324 +07:00 [INF] Session Timeout: 7 days
2025-10-24 01:58:13.324 +07:00 [INF] Guest Cart: Enabled
2025-10-24 01:58:13.325 +07:00 [INF] ==========================================
2025-10-24 01:58:13.400 +07:00 [INF] Now listening on: http://localhost:5000
2025-10-24 01:58:13.405 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-24 01:58:13.408 +07:00 [INF] Hosting environment: Production
2025-10-24 01:58:13.409 +07:00 [INF] Content root path: C:\Users\DELL\Desktop\Bán sách\BookStoreMWC
2025-10-24 01:58:14.489 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 01:58:14.495 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-24 01:58:14.631 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-10-24 01:58:14.670 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2025-10-24 01:58:14.700 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-10-24 01:58:14.707 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 01:58:14.716 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2025-10-24 01:58:14.722 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 01:58:14.733 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 01:58:14.842 +07:00 [INF] Executed DbCommand (20ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:58:14.935 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:58:14.958 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:58:14.994 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:58:15.022 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:58:15.035 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 01:58:15.051 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 01:58:15.062 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 01:58:15.093 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 01:58:15.109 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:58:15.133 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 01:58:15.159 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 01:58:15.176 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:58:15.202 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 01:58:15.243 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 01:58:15.350 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:58:15.360 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:58:15.396 +07:00 [INF] Executed ViewResult - view Index executed in 150.9992ms.
2025-10-24 01:58:15.403 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 667.8081ms
2025-10-24 01:58:15.406 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 01:58:15.414 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 927.3237ms
2025-10-24 01:58:18.861 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/books/1 - null null
2025-10-24 01:58:18.878 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 01:58:18.887 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 01:58:18.951 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 01:58:18.986 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 01:58:19.040 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:58:19.061 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 01:58:19.068 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 01:58:19.073 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 01:58:19.085 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [WishlistItems] AS [w]
        WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 01:58:19.094 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__bookId_1
2025-10-24 01:58:19.097 +07:00 [INF] Book 1 - AdditionalImages: ["/images/books/gallery/747bf3dd-b187-424e-bb5a-152167091a35.jpg"], GalleryCount: 1, HasGallery: true
2025-10-24 01:58:19.100 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 01:58:19.116 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:58:19.120 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:58:19.124 +07:00 [INF] Executed ViewResult - view Details executed in 24.1678ms.
2025-10-24 01:58:19.126 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 235.2312ms
2025-10-24 01:58:19.127 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 01:58:19.129 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/books/1 - 200 null text/html; charset=utf-8 268.1006ms
2025-10-24 01:58:31.763 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/books/2 - null null
2025-10-24 01:58:31.783 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 01:58:31.786 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 01:58:31.792 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 01:58:31.796 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 01:58:31.801 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 01:58:31.804 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 01:58:31.806 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 01:58:31.808 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [WishlistItems] AS [w]
        WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 01:58:31.809 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__bookId_1
2025-10-24 01:58:31.811 +07:00 [INF] Book 2 - AdditionalImages: ["/images/books/gallery/45eb04ef-c7b3-4fad-90f6-d64fd1c7f8c2.jpg"], GalleryCount: 1, HasGallery: true
2025-10-24 01:58:31.811 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 01:58:31.814 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:58:31.817 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:58:31.820 +07:00 [INF] Executed ViewResult - view Details executed in 9.0181ms.
2025-10-24 01:58:31.821 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 32.0849ms
2025-10-24 01:58:31.822 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 01:58:31.823 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/books/2 - 200 null text/html; charset=utf-8 59.8024ms
2025-10-24 01:58:31.832 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/gallery/45eb04ef-c7b3-4fad-90f6-d64fd1c7f8c2.jpg - null null
2025-10-24 01:58:31.844 +07:00 [INF] The file /images/books/gallery/45eb04ef-c7b3-4fad-90f6-d64fd1c7f8c2.jpg was not modified
2025-10-24 01:58:31.845 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/gallery/45eb04ef-c7b3-4fad-90f6-d64fd1c7f8c2.jpg - 304 null image/jpeg 13.3867ms
2025-10-24 01:58:38.400 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/account/Profile - null null
2025-10-24 01:58:38.414 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Profile (BookStoreMVC)'
2025-10-24 01:58:38.419 +07:00 [INF] Route matched with {action = "Profile", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Profile() on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 01:58:38.426 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-10-24 01:58:38.437 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[UserId] = @__userId_0
2025-10-24 01:58:38.447 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[UserId] = @__userId_0 AND [o].[Status] = 3
2025-10-24 01:58:38.453 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[UserId] = @__userId_0
2025-10-24 01:58:38.458 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [WishlistItems] AS [w]
WHERE [w].[UserId] = @__userId_0
2025-10-24 01:58:38.478 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [o1].[Id], [o1].[Status], [o1].[Total], [o1].[CreatedAt], [s].[Id], [s].[BookId], [s].[BookTitle], [s].[BookAuthor], [s].[BookImageUrl], [s].[Quantity], [s].[UnitPrice], [s].[Total], [s].[Id0]
FROM (
    SELECT TOP(@__p_1) [o].[Id], [o].[Status], [o].[Total], [o].[CreatedAt]
    FROM [Orders] AS [o]
    WHERE [o].[UserId] = @__userId_0
    ORDER BY [o].[CreatedAt] DESC
) AS [o1]
LEFT JOIN (
    SELECT [o0].[Id], [o0].[BookId], [b].[Title] AS [BookTitle], [b].[Author] AS [BookAuthor], [b].[ImageUrl] AS [BookImageUrl], [o0].[Quantity], [o0].[UnitPrice], [o0].[Total], [b].[Id] AS [Id0], [o0].[OrderId]
    FROM [OrderItems] AS [o0]
    LEFT JOIN [Books] AS [b] ON [o0].[BookId] = [b].[Id]
) AS [s] ON [o1].[Id] = [s].[OrderId]
ORDER BY [o1].[CreatedAt] DESC, [o1].[Id], [s].[Id]
2025-10-24 01:58:38.495 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Rating], [r0].[Comment], [r0].[CreatedAt], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM (
    SELECT TOP(@__p_1) [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[Rating]
    FROM [Reviews] AS [r]
    WHERE [r].[UserId] = @__userId_0
    ORDER BY [r].[CreatedAt] DESC
) AS [r0]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 01:58:38.502 +07:00 [INF] Executing ViewResult, running view Profile.
2025-10-24 01:58:38.526 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:58:38.532 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:58:38.538 +07:00 [INF] Executed ViewResult - view Profile executed in 36.2161ms.
2025-10-24 01:58:38.539 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Profile (BookStoreMVC) in 118.5889ms
2025-10-24 01:58:38.540 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Profile (BookStoreMVC)'
2025-10-24 01:58:38.540 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/account/Profile - 200 null text/html; charset=utf-8 139.7529ms
2025-10-24 01:58:45.637 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Orders/Index - null null
2025-10-24 01:58:45.646 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.OrdersController.Index (BookStoreMVC)'
2025-10-24 01:58:45.651 +07:00 [INF] Route matched with {action = "Index", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.OrdersController (BookStoreMVC).
2025-10-24 01:58:45.697 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [s].[Id], [s].[Address], [s].[City], [s].[Country], [s].[FirstName], [s].[LastName], [s].[Phone], [s].[PostalCode], [p].[Id], [p].[Amount], [p].[CreatedAt], [p].[Method], [p].[OrderId], [p].[Status], [p].[TransactionId], [s0].[Id], [s0].[BookId], [s0].[OrderId], [s0].[Quantity], [s0].[Total], [s0].[UnitPrice], [s0].[Id0], [s0].[AdditionalImages], [s0].[Author], [s0].[CategoryId], [s0].[CreatedAt], [s0].[Description], [s0].[DiscountPrice], [s0].[ImageContentType], [s0].[ImageFileName], [s0].[ImageFileSize], [s0].[ImageUrl], [s0].[IsActive], [s0].[Language], [s0].[PageCount], [s0].[Price], [s0].[PublishDate], [s0].[Publisher], [s0].[StockQuantity], [s0].[Title], [s0].[UpdatedAt], [s0].[Id1], [s0].[CreatedAt0], [s0].[Description0], [s0].[ImageUrl0], [s0].[IsActive0], [s0].[Name], [s0].[ParentCategoryId]
FROM [Orders] AS [o]
INNER JOIN [AspNetUsers] AS [a] ON [o].[UserId] = [a].[Id]
INNER JOIN [ShippingInfos] AS [s] ON [o].[ShippingInfoId] = [s].[Id]
LEFT JOIN [Payments] AS [p] ON [o].[Id] = [p].[OrderId]
LEFT JOIN (
    SELECT [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice], [b].[Id] AS [Id0], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id1], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [OrderItems] AS [o0]
    LEFT JOIN [Books] AS [b] ON [o0].[BookId] = [b].[Id]
    LEFT JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
) AS [s0] ON [o].[Id] = [s0].[OrderId]
WHERE [o].[UserId] = @__userId_0
ORDER BY [o].[CreatedAt] DESC, [o].[Id], [a].[Id], [s].[Id], [p].[Id], [s0].[Id], [s0].[Id0]
2025-10-24 01:58:45.748 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 01:58:45.765 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:58:45.769 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:58:45.772 +07:00 [INF] Executed ViewResult - view Index executed in 24.3028ms.
2025-10-24 01:58:45.774 +07:00 [INF] Executed action BookStoreMVC.Controllers.OrdersController.Index (BookStoreMVC) in 118.9641ms
2025-10-24 01:58:45.776 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.OrdersController.Index (BookStoreMVC)'
2025-10-24 01:58:45.777 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Orders/Index - 200 null text/html; charset=utf-8 139.208ms
2025-10-24 01:59:13.291 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Orders/Details/4 - null null
2025-10-24 01:59:13.302 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.OrdersController.Details (BookStoreMVC)'
2025-10-24 01:59:13.308 +07:00 [INF] Route matched with {action = "Details", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32) on controller BookStoreMVC.Controllers.OrdersController (BookStoreMVC).
2025-10-24 01:59:13.347 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[@__userId_0='?' (Size = 450), @__orderId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s0].[Id], [s0].[CreatedAt], [s0].[Discount], [s0].[PaymentId], [s0].[ShippingInfoId], [s0].[Status], [s0].[SubTotal], [s0].[Tax], [s0].[Total], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [s0].[Id1], [s0].[Address], [s0].[City], [s0].[Country], [s0].[FirstName], [s0].[LastName], [s0].[Phone], [s0].[PostalCode], [s0].[Id2], [s0].[Amount], [s0].[CreatedAt1], [s0].[Method], [s0].[OrderId], [s0].[Status0], [s0].[TransactionId], [s1].[Id], [s1].[BookId], [s1].[OrderId], [s1].[Quantity], [s1].[Total], [s1].[UnitPrice], [s1].[Id0], [s1].[AdditionalImages], [s1].[Author], [s1].[CategoryId], [s1].[CreatedAt], [s1].[Description], [s1].[DiscountPrice], [s1].[ImageContentType], [s1].[ImageFileName], [s1].[ImageFileSize], [s1].[ImageUrl], [s1].[IsActive], [s1].[Language], [s1].[PageCount], [s1].[Price], [s1].[PublishDate], [s1].[Publisher], [s1].[StockQuantity], [s1].[Title], [s1].[UpdatedAt], [s1].[Id1], [s1].[CreatedAt0], [s1].[Description0], [s1].[ImageUrl0], [s1].[IsActive0], [s1].[Name], [s1].[ParentCategoryId]
FROM (
    SELECT TOP(1) [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [s].[Id] AS [Id1], [s].[Address], [s].[City], [s].[Country], [s].[FirstName], [s].[LastName], [s].[Phone], [s].[PostalCode], [p].[Id] AS [Id2], [p].[Amount], [p].[CreatedAt] AS [CreatedAt1], [p].[Method], [p].[OrderId], [p].[Status] AS [Status0], [p].[TransactionId]
    FROM [Orders] AS [o]
    INNER JOIN [AspNetUsers] AS [a] ON [o].[UserId] = [a].[Id]
    INNER JOIN [ShippingInfos] AS [s] ON [o].[ShippingInfoId] = [s].[Id]
    LEFT JOIN [Payments] AS [p] ON [o].[Id] = [p].[OrderId]
    WHERE [o].[UserId] = @__userId_0 AND [o].[Id] = @__orderId_1
) AS [s0]
LEFT JOIN (
    SELECT [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice], [b].[Id] AS [Id0], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id1], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [OrderItems] AS [o0]
    LEFT JOIN [Books] AS [b] ON [o0].[BookId] = [b].[Id]
    LEFT JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
) AS [s1] ON [s0].[Id] = [s1].[OrderId]
ORDER BY [s0].[Id], [s0].[Id0], [s0].[Id1], [s0].[Id2], [s1].[Id], [s1].[Id0]
2025-10-24 01:59:13.362 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 01:59:13.374 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:59:13.378 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 01:59:13.382 +07:00 [INF] Executed ViewResult - view Details executed in 20.3436ms.
2025-10-24 01:59:13.384 +07:00 [INF] Executed action BookStoreMVC.Controllers.OrdersController.Details (BookStoreMVC) in 73.9209ms
2025-10-24 01:59:13.385 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.OrdersController.Details (BookStoreMVC)'
2025-10-24 01:59:13.387 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Orders/Details/4 - 200 null text/html; charset=utf-8 96.27ms
2025-10-24 02:00:29.797 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/Details/1 - null null
2025-10-24 02:00:29.803 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 02:00:29.807 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 02:00:29.813 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 02:00:29.817 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 02:00:29.820 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:00:29.822 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:00:29.825 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:00:29.828 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [WishlistItems] AS [w]
        WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:00:29.830 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__bookId_1
2025-10-24 02:00:29.831 +07:00 [INF] Book 1 - AdditionalImages: ["/images/books/gallery/747bf3dd-b187-424e-bb5a-152167091a35.jpg"], GalleryCount: 1, HasGallery: true
2025-10-24 02:00:29.831 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 02:00:29.834 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:00:29.837 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:00:29.839 +07:00 [INF] Executed ViewResult - view Details executed in 7.8553ms.
2025-10-24 02:00:29.841 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 30.4098ms
2025-10-24 02:00:29.842 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 02:00:29.843 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/Details/1 - 200 null text/html; charset=utf-8 45.5207ms
2025-10-24 02:00:49.836 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/account/Logout - application/x-www-form-urlencoded 225
2025-10-24 02:00:49.844 +07:00 [INF] CORS policy execution failed.
2025-10-24 02:00:49.845 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 02:00:49.880 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC)'
2025-10-24 02:00:49.886 +07:00 [INF] Route matched with {action = "Logout", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 02:00:49.896 +07:00 [INF] AuthenticationScheme: Identity.Application signed out.
2025-10-24 02:00:49.899 +07:00 [INF] AuthenticationScheme: Identity.External signed out.
2025-10-24 02:00:49.900 +07:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2025-10-24 02:00:49.901 +07:00 [INF] User logged out.
2025-10-24 02:00:49.903 +07:00 [INF] Executing RedirectResult, redirecting to /.
2025-10-24 02:00:49.904 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC) in 13.5482ms
2025-10-24 02:00:49.905 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC)'
2025-10-24 02:00:49.906 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/account/Logout - 302 0 null 70.2992ms
2025-10-24 02:00:49.908 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 02:00:49.910 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 02:00:49.910 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 02:00:49.913 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 02:00:49.917 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 02:00:49.921 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 02:00:49.924 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:00:49.926 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 02:00:49.927 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 02:00:49.929 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 02:00:49.930 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 02:00:49.933 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 02:00:49.936 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 02:00:49.939 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 02:00:49.942 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 02:00:49.945 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:00:49.948 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:00:49.950 +07:00 [INF] Executed ViewResult - view Index executed in 8.0314ms.
2025-10-24 02:00:49.950 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 39.4154ms
2025-10-24 02:00:49.951 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 02:00:49.952 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 43.7653ms
2025-10-24 02:00:52.088 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/account/Login - null null
2025-10-24 02:00:52.096 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 02:00:52.101 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 02:00:52.106 +07:00 [INF] Executing ViewResult, running view Login.
2025-10-24 02:00:52.126 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:00:52.130 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:00:52.134 +07:00 [INF] Executed ViewResult - view Login executed in 29.1209ms.
2025-10-24 02:00:52.135 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 32.6723ms
2025-10-24 02:00:52.137 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 02:00:52.138 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/account/Login - 200 null text/html; charset=utf-8 49.8841ms
2025-10-24 02:00:52.149 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - null null
2025-10-24 02:00:52.149 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - null null
2025-10-24 02:00:52.152 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - 404 0 null 3.0145ms
2025-10-24 02:00:52.154 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - 404 0 null 5.2545ms
2025-10-24 02:00:52.156 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/bookverse-core.js, Response status code: 404
2025-10-24 02:00:52.157 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/auth-validation.js, Response status code: 404
2025-10-24 02:01:03.771 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/account/Login - application/x-www-form-urlencoded 241
2025-10-24 02:01:03.781 +07:00 [INF] CORS policy execution failed.
2025-10-24 02:01:03.783 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 02:01:03.787 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 02:01:03.803 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BookStoreMVC.Models.ViewModels.LoginViewModel, System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 02:01:03.838 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-10-24 02:01:03.956 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2025-10-24 02:01:03.964 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-10-24 02:01:03.968 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 02:01:03.970 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2025-10-24 02:01:03.972 +07:00 [INF] AuthenticationScheme: Identity.Application signed in.
2025-10-24 02:01:03.974 +07:00 [INF] User logged in.
2025-10-24 02:01:03.976 +07:00 [INF] Executing RedirectResult, redirecting to /.
2025-10-24 02:01:03.978 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 171.0185ms
2025-10-24 02:01:03.979 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 02:01:03.980 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/account/Login - 302 0 null 208.5288ms
2025-10-24 02:01:03.982 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 02:01:03.983 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 02:01:03.984 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 02:01:03.986 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 02:01:03.990 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 02:01:03.994 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 02:01:03.997 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:01:03.999 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 02:01:04.000 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 02:01:04.001 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 02:01:04.003 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 02:01:04.005 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 02:01:04.007 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 02:01:04.010 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 02:01:04.013 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 02:01:04.015 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:01:04.017 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:01:04.019 +07:00 [INF] Executed ViewResult - view Index executed in 6.098ms.
2025-10-24 02:01:04.019 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 34.7345ms
2025-10-24 02:01:04.020 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 02:01:04.021 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 38.9492ms
2025-10-24 02:01:07.292 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Wishlist/Toggle - application/json 12
2025-10-24 02:01:07.298 +07:00 [INF] CORS policy execution failed.
2025-10-24 02:01:07.299 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 02:01:07.300 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 02:01:07.303 +07:00 [INF] Route matched with {action = "Toggle", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Toggle(BookStoreMVC.Models.ViewModels.AddToWishlistViewModel) on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 02:01:07.322 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__bookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[IsActive]
FROM [Books] AS [b]
WHERE [b].[Id] = @__bookId_0
2025-10-24 02:01:07.334 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [w].[Id], [w].[BookId], [w].[CreatedAt], [w].[UserId]
FROM [WishlistItems] AS [w]
WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1
2025-10-24 02:01:07.409 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [WishlistItems] ([BookId], [CreatedAt], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2025-10-24 02:01:07.433 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [WishlistItems] AS [w]
WHERE [w].[UserId] = @__userId_0
2025-10-24 02:01:07.437 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType35`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-24 02:01:07.443 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC) in 138.5235ms
2025-10-24 02:01:07.444 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 02:01:07.445 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Wishlist/Toggle - 200 null application/json; charset=utf-8 152.8363ms
2025-10-24 02:01:09.368 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/books/1 - null null
2025-10-24 02:01:09.376 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 02:01:09.378 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 02:01:09.383 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 02:01:09.389 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 02:01:09.394 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:01:09.395 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:01:09.397 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:01:09.399 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [WishlistItems] AS [w]
        WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:01:09.400 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__bookId_1
2025-10-24 02:01:09.401 +07:00 [INF] Book 1 - AdditionalImages: ["/images/books/gallery/747bf3dd-b187-424e-bb5a-152167091a35.jpg"], GalleryCount: 1, HasGallery: true
2025-10-24 02:01:09.402 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 02:01:09.405 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:01:09.407 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:01:09.410 +07:00 [INF] Executed ViewResult - view Details executed in 7.4426ms.
2025-10-24 02:01:09.410 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 29.1566ms
2025-10-24 02:01:09.411 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 02:01:09.412 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/books/1 - 200 null text/html; charset=utf-8 43.9375ms
2025-10-24 02:01:14.704 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/wishlist - null null
2025-10-24 02:01:14.715 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 02:01:14.723 +07:00 [INF] Route matched with {action = "Index", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 02:01:14.749 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[BookId], [w].[CreatedAt], [w].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [WishlistItems] AS [w]
INNER JOIN [Books] AS [b] ON [w].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [w].[UserId] = @__userId_0
ORDER BY [w].[CreatedAt] DESC, [w].[Id], [b].[Id], [c].[Id]
2025-10-24 02:01:14.759 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 02:01:14.775 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:01:14.779 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:01:14.781 +07:00 [INF] Executed ViewResult - view Index executed in 22.3024ms.
2025-10-24 02:01:14.784 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC) in 57.0977ms
2025-10-24 02:01:14.785 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 02:01:14.787 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/wishlist - 200 null text/html; charset=utf-8 82.8278ms
2025-10-24 02:01:22.505 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Orders/Index - null null
2025-10-24 02:01:22.514 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.OrdersController.Index (BookStoreMVC)'
2025-10-24 02:01:22.516 +07:00 [INF] Route matched with {action = "Index", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.OrdersController (BookStoreMVC).
2025-10-24 02:01:22.521 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [s].[Id], [s].[Address], [s].[City], [s].[Country], [s].[FirstName], [s].[LastName], [s].[Phone], [s].[PostalCode], [p].[Id], [p].[Amount], [p].[CreatedAt], [p].[Method], [p].[OrderId], [p].[Status], [p].[TransactionId], [s0].[Id], [s0].[BookId], [s0].[OrderId], [s0].[Quantity], [s0].[Total], [s0].[UnitPrice], [s0].[Id0], [s0].[AdditionalImages], [s0].[Author], [s0].[CategoryId], [s0].[CreatedAt], [s0].[Description], [s0].[DiscountPrice], [s0].[ImageContentType], [s0].[ImageFileName], [s0].[ImageFileSize], [s0].[ImageUrl], [s0].[IsActive], [s0].[Language], [s0].[PageCount], [s0].[Price], [s0].[PublishDate], [s0].[Publisher], [s0].[StockQuantity], [s0].[Title], [s0].[UpdatedAt], [s0].[Id1], [s0].[CreatedAt0], [s0].[Description0], [s0].[ImageUrl0], [s0].[IsActive0], [s0].[Name], [s0].[ParentCategoryId]
FROM [Orders] AS [o]
INNER JOIN [AspNetUsers] AS [a] ON [o].[UserId] = [a].[Id]
INNER JOIN [ShippingInfos] AS [s] ON [o].[ShippingInfoId] = [s].[Id]
LEFT JOIN [Payments] AS [p] ON [o].[Id] = [p].[OrderId]
LEFT JOIN (
    SELECT [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice], [b].[Id] AS [Id0], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id1], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [OrderItems] AS [o0]
    LEFT JOIN [Books] AS [b] ON [o0].[BookId] = [b].[Id]
    LEFT JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
) AS [s0] ON [o].[Id] = [s0].[OrderId]
WHERE [o].[UserId] = @__userId_0
ORDER BY [o].[CreatedAt] DESC, [o].[Id], [a].[Id], [s].[Id], [p].[Id], [s0].[Id], [s0].[Id0]
2025-10-24 02:01:22.528 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 02:01:22.531 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:01:22.534 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:01:22.536 +07:00 [INF] Executed ViewResult - view Index executed in 7.3866ms.
2025-10-24 02:01:22.536 +07:00 [INF] Executed action BookStoreMVC.Controllers.OrdersController.Index (BookStoreMVC) in 18.1625ms
2025-10-24 02:01:22.537 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.OrdersController.Index (BookStoreMVC)'
2025-10-24 02:01:22.538 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Orders/Index - 200 null text/html; charset=utf-8 32.7838ms
2025-10-24 02:01:23.923 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Orders/Details/2 - null null
2025-10-24 02:01:23.929 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.OrdersController.Details (BookStoreMVC)'
2025-10-24 02:01:23.931 +07:00 [INF] Route matched with {action = "Details", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32) on controller BookStoreMVC.Controllers.OrdersController (BookStoreMVC).
2025-10-24 02:01:23.934 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__orderId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s0].[Id], [s0].[CreatedAt], [s0].[Discount], [s0].[PaymentId], [s0].[ShippingInfoId], [s0].[Status], [s0].[SubTotal], [s0].[Tax], [s0].[Total], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [s0].[Id1], [s0].[Address], [s0].[City], [s0].[Country], [s0].[FirstName], [s0].[LastName], [s0].[Phone], [s0].[PostalCode], [s0].[Id2], [s0].[Amount], [s0].[CreatedAt1], [s0].[Method], [s0].[OrderId], [s0].[Status0], [s0].[TransactionId], [s1].[Id], [s1].[BookId], [s1].[OrderId], [s1].[Quantity], [s1].[Total], [s1].[UnitPrice], [s1].[Id0], [s1].[AdditionalImages], [s1].[Author], [s1].[CategoryId], [s1].[CreatedAt], [s1].[Description], [s1].[DiscountPrice], [s1].[ImageContentType], [s1].[ImageFileName], [s1].[ImageFileSize], [s1].[ImageUrl], [s1].[IsActive], [s1].[Language], [s1].[PageCount], [s1].[Price], [s1].[PublishDate], [s1].[Publisher], [s1].[StockQuantity], [s1].[Title], [s1].[UpdatedAt], [s1].[Id1], [s1].[CreatedAt0], [s1].[Description0], [s1].[ImageUrl0], [s1].[IsActive0], [s1].[Name], [s1].[ParentCategoryId]
FROM (
    SELECT TOP(1) [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [s].[Id] AS [Id1], [s].[Address], [s].[City], [s].[Country], [s].[FirstName], [s].[LastName], [s].[Phone], [s].[PostalCode], [p].[Id] AS [Id2], [p].[Amount], [p].[CreatedAt] AS [CreatedAt1], [p].[Method], [p].[OrderId], [p].[Status] AS [Status0], [p].[TransactionId]
    FROM [Orders] AS [o]
    INNER JOIN [AspNetUsers] AS [a] ON [o].[UserId] = [a].[Id]
    INNER JOIN [ShippingInfos] AS [s] ON [o].[ShippingInfoId] = [s].[Id]
    LEFT JOIN [Payments] AS [p] ON [o].[Id] = [p].[OrderId]
    WHERE [o].[UserId] = @__userId_0 AND [o].[Id] = @__orderId_1
) AS [s0]
LEFT JOIN (
    SELECT [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice], [b].[Id] AS [Id0], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id1], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [OrderItems] AS [o0]
    LEFT JOIN [Books] AS [b] ON [o0].[BookId] = [b].[Id]
    LEFT JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
) AS [s1] ON [s0].[Id] = [s1].[OrderId]
ORDER BY [s0].[Id], [s0].[Id0], [s0].[Id1], [s0].[Id2], [s1].[Id], [s1].[Id0]
2025-10-24 02:01:23.937 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 02:01:23.939 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:01:23.941 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:01:23.944 +07:00 [INF] Executed ViewResult - view Details executed in 6.8315ms.
2025-10-24 02:01:23.945 +07:00 [INF] Executed action BookStoreMVC.Controllers.OrdersController.Details (BookStoreMVC) in 12.0605ms
2025-10-24 02:01:23.946 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.OrdersController.Details (BookStoreMVC)'
2025-10-24 02:01:23.947 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Orders/Details/2 - 200 null text/html; charset=utf-8 24.4112ms
2025-10-24 02:01:34.416 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 02:01:34.423 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 02:01:34.425 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 02:01:34.429 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 02:01:34.436 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 02:01:34.440 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 02:01:34.443 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:01:34.444 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 02:01:34.446 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 02:01:34.447 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 02:01:34.448 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 02:01:34.452 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 02:01:34.454 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 02:01:34.456 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 02:01:34.459 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 02:01:34.461 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:01:34.463 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:01:34.465 +07:00 [INF] Executed ViewResult - view Index executed in 5.9338ms.
2025-10-24 02:01:34.466 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 37.9377ms
2025-10-24 02:01:34.467 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 02:01:34.468 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 52.4304ms
2025-10-24 02:01:49.414 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/NewBooks - null null
2025-10-24 02:01:49.421 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC)'
2025-10-24 02:01:49.426 +07:00 [INF] Route matched with {action = "NewBooks", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] NewBooks(System.String, System.String, Int32) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 02:01:49.439 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
2025-10-24 02:01:49.447 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 02:01:49.472 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
    ORDER BY [b].[CreatedAt] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 02:01:49.481 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:01:49.483 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 02:01:49.487 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 02:01:49.494 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
2025-10-24 02:01:49.496 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__createdAfter_0='?' (DbType = DateTime2), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CreatedAt] >= @__createdAfter_0
    ORDER BY [b].[CreatedAt] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 02:01:49.500 +07:00 [INF] Executing ViewResult, running view NewBooks.
2025-10-24 02:01:49.515 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:01:49.517 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:01:49.519 +07:00 [INF] Executed ViewResult - view NewBooks executed in 18.8948ms.
2025-10-24 02:01:49.520 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC) in 91.5675ms
2025-10-24 02:01:49.521 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.NewBooks (BookStoreMVC)'
2025-10-24 02:01:49.524 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/NewBooks - 200 null text/html; charset=utf-8 109.6732ms
2025-10-24 02:01:51.805 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/books/20 - null null
2025-10-24 02:01:51.816 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 02:01:51.818 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 02:01:51.824 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 02:01:51.830 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 02:01:51.836 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:01:51.838 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:01:51.841 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:01:51.842 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [WishlistItems] AS [w]
        WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:01:51.844 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__bookId_1
2025-10-24 02:01:51.845 +07:00 [INF] Book 20 - AdditionalImages: null, GalleryCount: 0, HasGallery: false
2025-10-24 02:01:51.846 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 02:01:51.847 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:01:51.849 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:01:51.850 +07:00 [INF] Executed ViewResult - view Details executed in 4.8125ms.
2025-10-24 02:01:51.853 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 30.5244ms
2025-10-24 02:01:51.854 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 02:01:51.855 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/books/20 - 200 null text/html; charset=utf-8 49.921ms
2025-10-24 02:02:06.455 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/account/Logout - application/x-www-form-urlencoded 225
2025-10-24 02:02:06.461 +07:00 [INF] CORS policy execution failed.
2025-10-24 02:02:06.462 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 02:02:06.465 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC)'
2025-10-24 02:02:06.466 +07:00 [INF] Route matched with {action = "Logout", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 02:02:06.469 +07:00 [INF] AuthenticationScheme: Identity.Application signed out.
2025-10-24 02:02:06.471 +07:00 [INF] AuthenticationScheme: Identity.External signed out.
2025-10-24 02:02:06.472 +07:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2025-10-24 02:02:06.473 +07:00 [INF] User logged out.
2025-10-24 02:02:06.473 +07:00 [INF] Executing RedirectResult, redirecting to /.
2025-10-24 02:02:06.474 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC) in 6.5241ms
2025-10-24 02:02:06.475 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC)'
2025-10-24 02:02:06.475 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/account/Logout - 302 0 null 20.6214ms
2025-10-24 02:02:06.478 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 02:02:06.480 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 02:02:06.480 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 02:02:06.482 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 02:02:06.486 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 02:02:06.488 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 02:02:06.492 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:02:06.494 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 02:02:06.496 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 02:02:06.498 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 02:02:06.499 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 02:02:06.501 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 02:02:06.504 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 02:02:06.506 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 02:02:06.509 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 02:02:06.511 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:02:06.513 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:02:06.515 +07:00 [INF] Executed ViewResult - view Index executed in 5.9536ms.
2025-10-24 02:02:06.516 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 34.6285ms
2025-10-24 02:02:06.516 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 02:02:06.517 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 38.79ms
2025-10-24 02:02:07.851 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/account/Login - null null
2025-10-24 02:02:07.858 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 02:02:07.859 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 02:02:07.861 +07:00 [INF] Executing ViewResult, running view Login.
2025-10-24 02:02:07.864 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:02:07.867 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:02:07.869 +07:00 [INF] Executed ViewResult - view Login executed in 7.5015ms.
2025-10-24 02:02:07.869 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 8.8198ms
2025-10-24 02:02:07.870 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 02:02:07.871 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/account/Login - 200 null text/html; charset=utf-8 20.0674ms
2025-10-24 02:02:07.883 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - null null
2025-10-24 02:02:07.885 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - null null
2025-10-24 02:02:07.885 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - 404 0 null 2.3711ms
2025-10-24 02:02:07.886 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - 404 0 null 1.8627ms
2025-10-24 02:02:07.888 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/bookverse-core.js, Response status code: 404
2025-10-24 02:02:07.890 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/auth-validation.js, Response status code: 404
2025-10-24 02:02:19.225 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/account/Login - application/x-www-form-urlencoded 248
2025-10-24 02:02:19.230 +07:00 [INF] CORS policy execution failed.
2025-10-24 02:02:19.232 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 02:02:19.234 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 02:02:19.238 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BookStoreMVC.Models.ViewModels.LoginViewModel, System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 02:02:19.243 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-10-24 02:02:19.323 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2025-10-24 02:02:19.327 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-10-24 02:02:19.329 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 02:02:19.332 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2025-10-24 02:02:19.334 +07:00 [INF] AuthenticationScheme: Identity.Application signed in.
2025-10-24 02:02:19.335 +07:00 [INF] User logged in.
2025-10-24 02:02:19.335 +07:00 [INF] Executing RedirectResult, redirecting to /.
2025-10-24 02:02:19.336 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 94.355ms
2025-10-24 02:02:19.336 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 02:02:19.337 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/account/Login - 302 0 null 112.4237ms
2025-10-24 02:02:19.339 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 02:02:19.341 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 02:02:19.342 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 02:02:19.344 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 02:02:19.349 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 02:02:19.352 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 02:02:19.355 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:02:19.356 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 02:02:19.358 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 02:02:19.359 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 02:02:19.360 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 02:02:19.364 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 02:02:19.367 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 02:02:19.369 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 02:02:19.371 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 02:02:19.373 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:02:19.374 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:02:19.376 +07:00 [INF] Executed ViewResult - view Index executed in 5.2715ms.
2025-10-24 02:02:19.377 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 34.6283ms
2025-10-24 02:02:19.378 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 02:02:19.379 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 39.4588ms
2025-10-24 02:02:23.695 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin - null null
2025-10-24 02:02:23.700 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.Dashboard (BookStoreMVC)'
2025-10-24 02:02:23.705 +07:00 [INF] Route matched with {action = "Dashboard", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Dashboard() on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-24 02:02:23.720 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 02:02:23.731 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-24 02:02:23.738 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-10-24 02:02:23.745 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
2025-10-24 02:02:23.747 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 02:02:23.751 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[Status] = 0
2025-10-24 02:02:23.756 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] <= 10
2025-10-24 02:02:23.761 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(0 AS bit)
2025-10-24 02:02:23.769 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[UserId], [o0].[Status], [o0].[Total], [o0].[CreatedAt], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM (
    SELECT TOP(@__p_0) [o].[Id], [o].[CreatedAt], [o].[Status], [o].[Total], [o].[UserId]
    FROM [Orders] AS [o]
    ORDER BY [o].[CreatedAt] DESC
) AS [o0]
INNER JOIN [AspNetUsers] AS [a] ON [o0].[UserId] = [a].[Id]
ORDER BY [o0].[CreatedAt] DESC
2025-10-24 02:02:23.781 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[Rating], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM (
    SELECT TOP(@__p_0) [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    ORDER BY [r].[CreatedAt] DESC
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 02:02:23.789 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
ORDER BY [a].[CreatedAt] DESC
2025-10-24 02:02:23.793 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-24 02:02:23.801 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[Title], [b0].[Author], [b0].[StockQuantity], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[Author], [b].[CategoryId], [b].[StockQuantity], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] <= 10
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
2025-10-24 02:02:23.823 +07:00 [ERR] Error getting monthly revenue
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => (int)o.Status == 3 && o.CreatedAt >= __startDate_0)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month
     })
    .Select(g => new { 
        Date = new DateTime(
            g.Key.Year, 
            g.Key.Month, 
            1
        ), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total)
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at BookStoreMVC.Services.OrderService.GetMonthlyRevenueAsync(Int32 months) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Services\OrderService.cs:line 311
2025-10-24 02:02:23.864 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
ORDER BY [o].[Status]
2025-10-24 02:02:23.878 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Name], (
    SELECT COUNT(*)
    FROM [Books] AS [b]
    WHERE [c].[Id] = [b].[CategoryId] AND [b].[IsActive] = CAST(1 AS bit)) AS [Count]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
2025-10-24 02:02:23.884 +07:00 [ERR] Error getting user registrations
System.InvalidOperationException: The LINQ expression 'DbSet<User>()
    .Where(u => u.CreatedAt >= __startDate_0)
    .GroupBy(u => new { 
        Year = u.CreatedAt.Year, 
        Month = u.CreatedAt.Month
     })
    .Select(g => new { 
        Date = new DateTime(
            g.Key.Year, 
            g.Key.Month, 
            1
        ), 
        Count = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at BookStoreMVC.Services.UserService.GetUserRegistrationsAsync(Int32 months) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Services\UserService.cs:line 202
2025-10-24 02:02:23.895 +07:00 [INF] Executing ViewResult, running view Dashboard.
2025-10-24 02:02:23.954 +07:00 [INF] Executed ViewResult - view Dashboard executed in 59.5071ms.
2025-10-24 02:02:23.958 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.Dashboard (BookStoreMVC) in 249.9889ms
2025-10-24 02:02:23.960 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.Dashboard (BookStoreMVC)'
2025-10-24 02:02:23.962 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin - 200 null text/html; charset=utf-8 267.1469ms
2025-10-24 02:02:23.975 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/admin.js?v=zlE_1g2uPXi4gKuQMdTqq6d7eO2vOH8vl_YJKJBSo-w - null null
2025-10-24 02:02:23.977 +07:00 [INF] The file /js/admin.js was not modified
2025-10-24 02:02:23.978 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/admin.js?v=zlE_1g2uPXi4gKuQMdTqq6d7eO2vOH8vl_YJKJBSo-w - 304 null text/javascript 2.8929ms
2025-10-24 02:02:24.426 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin/dashboard/stats - null null
2025-10-24 02:02:24.430 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.GetDashboardStats (BookStoreMVC)'
2025-10-24 02:02:24.434 +07:00 [INF] Route matched with {action = "GetDashboardStats", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetDashboardStats() on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-24 02:02:24.440 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 02:02:24.442 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-24 02:02:24.444 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-10-24 02:02:24.448 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 02:02:24.450 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
ORDER BY [o].[Status]
2025-10-24 02:02:24.452 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] <= 10
2025-10-24 02:02:24.456 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
2025-10-24 02:02:24.457 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(0 AS bit)
2025-10-24 02:02:24.467 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT AVG(CAST([r].[Rating] AS float))
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 02:02:24.471 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-24 02:02:24.483 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.GetDashboardStats (BookStoreMVC) in 46.0139ms
2025-10-24 02:02:24.483 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.GetDashboardStats (BookStoreMVC)'
2025-10-24 02:02:24.484 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin/dashboard/stats - 200 null application/json; charset=utf-8 58.1457ms
2025-10-24 02:02:27.211 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin/reviews - null null
2025-10-24 02:02:27.222 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.Reviews (BookStoreMVC)'
2025-10-24 02:02:27.238 +07:00 [INF] Route matched with {action = "Reviews", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Reviews(BookStoreMVC.Models.ViewModels.ReviewListViewModel) on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-24 02:02:27.251 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 02:02:27.257 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 02:02:27.261 +07:00 [INF] Executing ViewResult, running view Reviews.
2025-10-24 02:02:27.272 +07:00 [INF] Executed ViewResult - view Reviews executed in 10.9938ms.
2025-10-24 02:02:27.273 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.Reviews (BookStoreMVC) in 31.9132ms
2025-10-24 02:02:27.275 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.Reviews (BookStoreMVC)'
2025-10-24 02:02:27.277 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin/reviews - 200 null text/html; charset=utf-8 65.8253ms
2025-10-24 02:02:40.614 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin - null null
2025-10-24 02:02:40.620 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.Dashboard (BookStoreMVC)'
2025-10-24 02:02:40.621 +07:00 [INF] Route matched with {action = "Dashboard", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Dashboard() on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-24 02:02:40.624 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 02:02:40.629 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-24 02:02:40.632 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-10-24 02:02:40.637 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
2025-10-24 02:02:40.642 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 02:02:40.644 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[Status] = 0
2025-10-24 02:02:40.647 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] <= 10
2025-10-24 02:02:40.650 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(0 AS bit)
2025-10-24 02:02:40.652 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[UserId], [o0].[Status], [o0].[Total], [o0].[CreatedAt], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM (
    SELECT TOP(@__p_0) [o].[Id], [o].[CreatedAt], [o].[Status], [o].[Total], [o].[UserId]
    FROM [Orders] AS [o]
    ORDER BY [o].[CreatedAt] DESC
) AS [o0]
INNER JOIN [AspNetUsers] AS [a] ON [o0].[UserId] = [a].[Id]
ORDER BY [o0].[CreatedAt] DESC
2025-10-24 02:02:40.654 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[Rating], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM (
    SELECT TOP(@__p_0) [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    ORDER BY [r].[CreatedAt] DESC
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 02:02:40.657 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
ORDER BY [a].[CreatedAt] DESC
2025-10-24 02:02:40.659 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[Title], [b0].[Author], [b0].[StockQuantity], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[Author], [b].[CategoryId], [b].[StockQuantity], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] <= 10
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
2025-10-24 02:02:40.662 +07:00 [ERR] Error getting monthly revenue
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => (int)o.Status == 3 && o.CreatedAt >= __startDate_0)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month
     })
    .Select(g => new { 
        Date = new DateTime(
            g.Key.Year, 
            g.Key.Month, 
            1
        ), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total)
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at BookStoreMVC.Services.OrderService.GetMonthlyRevenueAsync(Int32 months) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Services\OrderService.cs:line 311
2025-10-24 02:02:40.668 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
ORDER BY [o].[Status]
2025-10-24 02:02:40.669 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Name], (
    SELECT COUNT(*)
    FROM [Books] AS [b]
    WHERE [c].[Id] = [b].[CategoryId] AND [b].[IsActive] = CAST(1 AS bit)) AS [Count]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
2025-10-24 02:02:40.671 +07:00 [ERR] Error getting user registrations
System.InvalidOperationException: The LINQ expression 'DbSet<User>()
    .Where(u => u.CreatedAt >= __startDate_0)
    .GroupBy(u => new { 
        Year = u.CreatedAt.Year, 
        Month = u.CreatedAt.Month
     })
    .Select(g => new { 
        Date = new DateTime(
            g.Key.Year, 
            g.Key.Month, 
            1
        ), 
        Count = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at BookStoreMVC.Services.UserService.GetUserRegistrationsAsync(Int32 months) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Services\UserService.cs:line 202
2025-10-24 02:02:40.675 +07:00 [INF] Executing ViewResult, running view Dashboard.
2025-10-24 02:02:40.677 +07:00 [INF] Executed ViewResult - view Dashboard executed in 1.6671ms.
2025-10-24 02:02:40.678 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.Dashboard (BookStoreMVC) in 55.3003ms
2025-10-24 02:02:40.679 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.Dashboard (BookStoreMVC)'
2025-10-24 02:02:40.680 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin - 200 null text/html; charset=utf-8 65.7605ms
2025-10-24 02:02:40.936 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin/dashboard/stats - null null
2025-10-24 02:02:40.940 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.GetDashboardStats (BookStoreMVC)'
2025-10-24 02:02:40.940 +07:00 [INF] Route matched with {action = "GetDashboardStats", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetDashboardStats() on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-24 02:02:40.943 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 02:02:40.945 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-24 02:02:40.946 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-10-24 02:02:40.948 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 02:02:40.950 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
ORDER BY [o].[Status]
2025-10-24 02:02:40.952 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] <= 10
2025-10-24 02:02:40.953 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
2025-10-24 02:02:40.955 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(0 AS bit)
2025-10-24 02:02:40.956 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT AVG(CAST([r].[Rating] AS float))
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 02:02:40.957 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-24 02:02:40.958 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.GetDashboardStats (BookStoreMVC) in 15.9222ms
2025-10-24 02:02:40.958 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.GetDashboardStats (BookStoreMVC)'
2025-10-24 02:02:40.959 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin/dashboard/stats - 200 null application/json; charset=utf-8 23.4801ms
2025-10-24 02:02:41.733 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 02:02:41.740 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 02:02:41.742 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 02:02:41.751 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 02:02:41.763 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 02:02:41.771 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 02:02:41.775 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:02:41.779 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 02:02:41.782 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 02:02:41.786 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 02:02:41.789 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 02:02:41.793 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 02:02:41.797 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 02:02:41.799 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 02:02:41.802 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 02:02:41.804 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:02:41.805 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:02:41.807 +07:00 [INF] Executed ViewResult - view Index executed in 5.4247ms.
2025-10-24 02:02:41.808 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 60.9666ms
2025-10-24 02:02:41.809 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 02:02:41.809 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 76.6438ms
2025-10-24 02:03:06.349 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/books/3 - null null
2025-10-24 02:03:06.357 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 02:03:06.360 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 02:03:06.367 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 02:03:06.371 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 02:03:06.375 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:03:06.377 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:03:06.382 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:03:06.383 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [WishlistItems] AS [w]
        WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:03:06.385 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__bookId_1
2025-10-24 02:03:06.386 +07:00 [INF] Book 3 - AdditionalImages: null, GalleryCount: 0, HasGallery: false
2025-10-24 02:03:06.387 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 02:03:06.388 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:03:06.391 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:03:06.392 +07:00 [INF] Executed ViewResult - view Details executed in 5.6833ms.
2025-10-24 02:03:06.393 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 28.9476ms
2025-10-24 02:03:06.394 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 02:03:06.395 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/books/3 - 200 null text/html; charset=utf-8 46.4794ms
2025-10-24 02:03:22.899 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/wishlist - null null
2025-10-24 02:03:22.911 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 02:03:22.914 +07:00 [INF] Route matched with {action = "Index", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 02:03:22.918 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[BookId], [w].[CreatedAt], [w].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [WishlistItems] AS [w]
INNER JOIN [Books] AS [b] ON [w].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [w].[UserId] = @__userId_0
ORDER BY [w].[CreatedAt] DESC, [w].[Id], [b].[Id], [c].[Id]
2025-10-24 02:03:22.920 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 02:03:22.922 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:03:22.924 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:03:22.926 +07:00 [INF] Executed ViewResult - view Index executed in 6.1348ms.
2025-10-24 02:03:22.927 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC) in 11.4966ms
2025-10-24 02:03:22.929 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 02:03:22.930 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/wishlist - 200 null text/html; charset=utf-8 30.6897ms
2025-10-24 02:03:30.029 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/books/1 - null null
2025-10-24 02:03:30.035 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 02:03:30.038 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 02:03:30.044 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 02:03:30.050 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 02:03:30.053 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:03:30.057 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:03:30.061 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:03:30.063 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [WishlistItems] AS [w]
        WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 02:03:30.064 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__bookId_1
2025-10-24 02:03:30.065 +07:00 [INF] Book 1 - AdditionalImages: ["/images/books/gallery/747bf3dd-b187-424e-bb5a-152167091a35.jpg"], GalleryCount: 1, HasGallery: true
2025-10-24 02:03:30.066 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 02:03:30.068 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:03:30.069 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 02:03:30.073 +07:00 [INF] Executed ViewResult - view Details executed in 6.4133ms.
2025-10-24 02:03:30.074 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 33.7483ms
2025-10-24 02:03:30.075 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 02:03:30.076 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/books/1 - 200 null text/html; charset=utf-8 46.8581ms
2025-10-24 02:03:46.749 +07:00 [INF] Application is shutting down...
2025-10-24 10:50:14.044 +07:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-24 10:50:15.534 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-24 10:50:15.548 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-24 10:50:15.578 +07:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-24 10:50:15.638 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-24 10:50:15.653 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-24 10:50:15.657 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-24 10:50:15.663 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-24 10:50:15.673 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-10-24 10:50:15.678 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-24 10:50:15.891 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 10:50:15.929 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 10:50:15.946 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-10-24 10:50:15.983 +07:00 [INF] ✅ Database initialized with admin user only.
2025-10-24 10:50:15.987 +07:00 [INF] Database initialized successfully
2025-10-24 10:50:16.088 +07:00 [INF] ==========================================
2025-10-24 10:50:16.090 +07:00 [INF] BookStore Application Starting...
2025-10-24 10:50:16.091 +07:00 [INF] Environment: Production
2025-10-24 10:50:16.092 +07:00 [INF] Session Timeout: 7 days
2025-10-24 10:50:16.093 +07:00 [INF] Guest Cart: Enabled
2025-10-24 10:50:16.093 +07:00 [INF] ==========================================
2025-10-24 10:50:16.173 +07:00 [INF] Now listening on: http://localhost:5000
2025-10-24 10:50:16.174 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-24 10:50:16.175 +07:00 [INF] Hosting environment: Production
2025-10-24 10:50:16.176 +07:00 [INF] Content root path: C:\Users\DELL\Desktop\Bán sách\BookStoreMWC
2025-10-24 10:50:19.484 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 10:50:19.491 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-24 10:50:19.551 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 10:50:19.565 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 10:50:19.711 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 10:50:19.796 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 10:50:19.814 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 10:50:19.840 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 10:50:19.863 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:50:19.875 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 10:50:19.886 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 10:50:19.896 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 10:50:19.922 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 10:50:19.937 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 10:50:19.959 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 10:50:19.981 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 10:50:19.994 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 10:50:20.019 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 10:50:20.060 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 10:50:20.166 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:50:20.174 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:50:20.208 +07:00 [INF] Executed ViewResult - view Index executed in 149.0753ms.
2025-10-24 10:50:20.213 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/eefdd8ed-2cc9-4b0f-b905-135e6dfdeea0.jpg - null null
2025-10-24 10:50:20.213 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/b1a75ff2-9e12-4c9f-894a-55e7ed1e8705.jpg - null null
2025-10-24 10:50:20.213 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/dbd2cb5e-32df-4c33-bd7f-2417990da4fe.jpg - null null
2025-10-24 10:50:20.213 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/1dffb230-5d94-42ba-b309-29b1cd631e49.jpg - null null
2025-10-24 10:50:20.214 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/36101025-d6e9-43af-aabb-0f019b95f491.jpg - null null
2025-10-24 10:50:20.215 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 646.6017ms
2025-10-24 10:50:20.224 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 10:50:20.227 +07:00 [INF] The file /images/books/b1a75ff2-9e12-4c9f-894a-55e7ed1e8705.jpg was not modified
2025-10-24 10:50:20.227 +07:00 [INF] The file /images/books/dbd2cb5e-32df-4c33-bd7f-2417990da4fe.jpg was not modified
2025-10-24 10:50:20.227 +07:00 [INF] The file /images/books/36101025-d6e9-43af-aabb-0f019b95f491.jpg was not modified
2025-10-24 10:50:20.227 +07:00 [INF] The file /images/books/1dffb230-5d94-42ba-b309-29b1cd631e49.jpg was not modified
2025-10-24 10:50:20.227 +07:00 [INF] The file /images/books/eefdd8ed-2cc9-4b0f-b905-135e6dfdeea0.jpg was not modified
2025-10-24 10:50:20.231 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 748.0402ms
2025-10-24 10:50:20.228 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/dbd2cb5e-32df-4c33-bd7f-2417990da4fe.jpg - 304 null image/jpeg 15.2016ms
2025-10-24 10:50:20.229 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/36101025-d6e9-43af-aabb-0f019b95f491.jpg - 304 null image/jpeg 14.5245ms
2025-10-24 10:50:20.230 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/1dffb230-5d94-42ba-b309-29b1cd631e49.jpg - 304 null image/jpeg 16.9674ms
2025-10-24 10:50:20.228 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/b1a75ff2-9e12-4c9f-894a-55e7ed1e8705.jpg - 304 null image/jpeg 14.9ms
2025-10-24 10:50:20.231 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/eefdd8ed-2cc9-4b0f-b905-135e6dfdeea0.jpg - 304 null image/jpeg 17.6468ms
2025-10-24 10:50:20.234 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/site.js?v=psVHgii7ebM3Pd--mSAvznkun8unGUnQu4liF0OjUJQ - null null
2025-10-24 10:50:20.235 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/b5dff926-3649-4741-8420-7636176bc756.jpg - null null
2025-10-24 10:50:20.237 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/dac6c957-62fb-46ef-b300-884af0158381.jpg - null null
2025-10-24 10:50:20.238 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/bookcard-functions.js - null null
2025-10-24 10:50:20.240 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/9275c308-a4f2-4fd2-8f13-6b7ac3bf7d9d.jpg - null null
2025-10-24 10:50:20.241 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/9f20215f-3d1a-4335-8ca4-7fb121e06fb4.jpg - null null
2025-10-24 10:50:20.243 +07:00 [INF] The file /js/site.js was not modified
2025-10-24 10:50:20.244 +07:00 [INF] The file /images/books/b5dff926-3649-4741-8420-7636176bc756.jpg was not modified
2025-10-24 10:50:20.246 +07:00 [INF] The file /images/books/dac6c957-62fb-46ef-b300-884af0158381.jpg was not modified
2025-10-24 10:50:20.247 +07:00 [INF] The file /js/bookcard-functions.js was not modified
2025-10-24 10:50:20.248 +07:00 [INF] The file /images/books/9275c308-a4f2-4fd2-8f13-6b7ac3bf7d9d.jpg was not modified
2025-10-24 10:50:20.249 +07:00 [INF] The file /images/books/9f20215f-3d1a-4335-8ca4-7fb121e06fb4.jpg was not modified
2025-10-24 10:50:20.250 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/site.js?v=psVHgii7ebM3Pd--mSAvznkun8unGUnQu4liF0OjUJQ - 304 null text/javascript 15.8521ms
2025-10-24 10:50:20.250 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/b5dff926-3649-4741-8420-7636176bc756.jpg - 304 null image/jpeg 15.2737ms
2025-10-24 10:50:20.253 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/dac6c957-62fb-46ef-b300-884af0158381.jpg - 304 null image/jpeg 16.2059ms
2025-10-24 10:50:20.256 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/bookcard-functions.js - 304 null text/javascript 17.9117ms
2025-10-24 10:50:20.257 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/9275c308-a4f2-4fd2-8f13-6b7ac3bf7d9d.jpg - 304 null image/jpeg 17.2926ms
2025-10-24 10:50:20.258 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/9f20215f-3d1a-4335-8ca4-7fb121e06fb4.jpg - 304 null image/jpeg 16.6943ms
2025-10-24 10:50:20.259 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/b39e2295-0bed-485e-84cd-8588dc55b15e.jpg - null null
2025-10-24 10:50:20.261 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/d534764c-5457-4896-9eb8-c702984cddf3.jpg - null null
2025-10-24 10:50:20.262 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/80723886-f28d-411f-a542-f343e54d8b0e.jpg - null null
2025-10-24 10:50:20.263 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/2b7307ad-b949-4cff-9c9c-4e33efdc28d7.jpg - null null
2025-10-24 10:50:20.265 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/52a8425c-7588-4e65-b5e4-31c3aeffa163.jpg - null null
2025-10-24 10:50:20.266 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/35478bcd-cfa8-421f-b420-f2138bf136ca.jpg - null null
2025-10-24 10:50:20.267 +07:00 [INF] The file /images/books/b39e2295-0bed-485e-84cd-8588dc55b15e.jpg was not modified
2025-10-24 10:50:20.268 +07:00 [INF] The file /images/books/d534764c-5457-4896-9eb8-c702984cddf3.jpg was not modified
2025-10-24 10:50:20.270 +07:00 [INF] The file /images/books/80723886-f28d-411f-a542-f343e54d8b0e.jpg was not modified
2025-10-24 10:50:20.271 +07:00 [INF] The file /images/books/2b7307ad-b949-4cff-9c9c-4e33efdc28d7.jpg was not modified
2025-10-24 10:50:20.272 +07:00 [INF] The file /images/books/52a8425c-7588-4e65-b5e4-31c3aeffa163.jpg was not modified
2025-10-24 10:50:20.273 +07:00 [INF] The file /images/books/35478bcd-cfa8-421f-b420-f2138bf136ca.jpg was not modified
2025-10-24 10:50:20.273 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/b39e2295-0bed-485e-84cd-8588dc55b15e.jpg - 304 null image/jpeg 14.0335ms
2025-10-24 10:50:20.274 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/d534764c-5457-4896-9eb8-c702984cddf3.jpg - 304 null image/jpeg 13.3264ms
2025-10-24 10:50:20.275 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/80723886-f28d-411f-a542-f343e54d8b0e.jpg - 304 null image/jpeg 12.5396ms
2025-10-24 10:50:20.275 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/2b7307ad-b949-4cff-9c9c-4e33efdc28d7.jpg - 304 null image/jpeg 11.9179ms
2025-10-24 10:50:20.276 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/52a8425c-7588-4e65-b5e4-31c3aeffa163.jpg - 304 null image/jpeg 11.2971ms
2025-10-24 10:50:20.277 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/35478bcd-cfa8-421f-b420-f2138bf136ca.jpg - 304 null image/jpeg 10.8621ms
2025-10-24 10:50:20.282 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/c7d19101-83c7-4513-b1e9-70b6cba587ec.jpg - null null
2025-10-24 10:50:20.288 +07:00 [INF] The file /images/books/c7d19101-83c7-4513-b1e9-70b6cba587ec.jpg was not modified
2025-10-24 10:50:20.289 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/c7d19101-83c7-4513-b1e9-70b6cba587ec.jpg - 304 null image/jpeg 6.3781ms
2025-10-24 10:50:24.527 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books?sortBy=featured - null null
2025-10-24 10:50:24.534 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Index (BookStoreMVC)'
2025-10-24 10:50:24.562 +07:00 [INF] Route matched with {action = "Index", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index(BookStoreMVC.Models.ViewModels.BookListViewModel) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 10:50:24.628 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-24 10:50:24.637 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 10:50:24.660 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r]
            WHERE [b].[Id] = [r].[BookId]) THEN (
            SELECT AVG(CAST([r0].[Rating] AS float))
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId])
        ELSE 0.0E0
    END AS [c], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r1]
        WHERE [b].[Id] = [r1].[BookId]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit)
    ORDER BY CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r]
            WHERE [b].[Id] = [r].[BookId]) THEN (
            SELECT AVG(CAST([r0].[Rating] AS float))
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId])
        ELSE 0.0E0
    END DESC, (
        SELECT COUNT(*)
        FROM [Reviews] AS [r1]
        WHERE [b].[Id] = [r1].[BookId]) DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id], [r2].[Id]
2025-10-24 10:50:24.673 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:50:24.678 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 10:50:24.696 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:50:24.702 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:50:24.709 +07:00 [INF] Executed ViewResult - view Index executed in 31.1866ms.
2025-10-24 10:50:24.710 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Index (BookStoreMVC) in 145.529ms
2025-10-24 10:50:24.711 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Index (BookStoreMVC)'
2025-10-24 10:50:24.713 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books?sortBy=featured - 200 null text/html; charset=utf-8 185.3451ms
2025-10-24 10:50:24.721 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/76d46b94-1260-425d-a282-e49e11b01475.jpg - null null
2025-10-24 10:50:24.723 +07:00 [INF] The file /images/books/76d46b94-1260-425d-a282-e49e11b01475.jpg was not modified
2025-10-24 10:50:24.724 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/76d46b94-1260-425d-a282-e49e11b01475.jpg - 304 null image/jpeg 2.8882ms
2025-10-24 10:50:24.725 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/11781612-2fec-473f-8749-70cf9dc35539.jpg - null null
2025-10-24 10:50:24.726 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/dbd4fe4c-f1a1-4aa0-abf6-1e6c9dc7b8a1.jpg - null null
2025-10-24 10:50:24.727 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/b8bf2e13-af0a-45a7-8208-df7829df3a62.jpg - null null
2025-10-24 10:50:24.728 +07:00 [INF] The file /images/books/11781612-2fec-473f-8749-70cf9dc35539.jpg was not modified
2025-10-24 10:50:24.729 +07:00 [INF] The file /images/books/dbd4fe4c-f1a1-4aa0-abf6-1e6c9dc7b8a1.jpg was not modified
2025-10-24 10:50:24.730 +07:00 [INF] The file /images/books/b8bf2e13-af0a-45a7-8208-df7829df3a62.jpg was not modified
2025-10-24 10:50:24.731 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/11781612-2fec-473f-8749-70cf9dc35539.jpg - 304 null image/jpeg 5.3209ms
2025-10-24 10:50:24.732 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/dbd4fe4c-f1a1-4aa0-abf6-1e6c9dc7b8a1.jpg - 304 null image/jpeg 5.9466ms
2025-10-24 10:50:24.733 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/b8bf2e13-af0a-45a7-8208-df7829df3a62.jpg - 304 null image/jpeg 5.6389ms
2025-10-24 10:50:26.276 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/books/1 - null null
2025-10-24 10:50:26.283 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 10:50:26.287 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 10:50:26.301 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 10:50:26.324 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 10:50:26.372 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 10:50:26.378 +07:00 [INF] Book 1 - AdditionalImages: ["/images/books/gallery/747bf3dd-b187-424e-bb5a-152167091a35.jpg"], GalleryCount: 1, HasGallery: true
2025-10-24 10:50:26.379 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 10:50:26.399 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:50:26.402 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:50:26.405 +07:00 [INF] Executed ViewResult - view Details executed in 26.193ms.
2025-10-24 10:50:26.406 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 117.78ms
2025-10-24 10:50:26.407 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 10:50:26.408 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/books/1 - 200 null text/html; charset=utf-8 131.9794ms
2025-10-24 10:50:26.417 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/gallery/747bf3dd-b187-424e-bb5a-152167091a35.jpg - null null
2025-10-24 10:50:26.419 +07:00 [INF] The file /images/books/gallery/747bf3dd-b187-424e-bb5a-152167091a35.jpg was not modified
2025-10-24 10:50:26.420 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/gallery/747bf3dd-b187-424e-bb5a-152167091a35.jpg - 304 null image/jpeg 2.4195ms
2025-10-24 10:50:30.031 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/category/1 - null null
2025-10-24 10:50:30.034 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Category (BookStoreMVC)'
2025-10-24 10:50:30.037 +07:00 [INF] Route matched with {action = "Category", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Category(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 10:50:30.048 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 10:50:30.067 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[CreatedAt], [s].[Description], [s].[ImageUrl], [s].[IsActive], [s].[Name], [s].[ParentCategoryId], [s].[Id0], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name0], [s].[ParentCategoryId0], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id] AS [Id0], [c0].[CreatedAt] AS [CreatedAt0], [c0].[Description] AS [Description0], [c0].[ImageUrl] AS [ImageUrl0], [c0].[IsActive] AS [IsActive0], [c0].[Name] AS [Name0], [c0].[ParentCategoryId] AS [ParentCategoryId0]
    FROM [Categories] AS [c]
    LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
    WHERE [c].[Id] = @__id_0
) AS [s]
LEFT JOIN [Books] AS [b] ON [s].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [s].[Id] = [c1].[ParentCategoryId]
ORDER BY [s].[Id], [s].[Id0], [b].[Id]
2025-10-24 10:50:30.079 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__model_CategoryId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CategoryId] = @__model_CategoryId_0
2025-10-24 10:50:30.085 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 10:50:30.104 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__model_CategoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CategoryId] = @__model_CategoryId_0
    ORDER BY [b].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[Title], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 10:50:30.109 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:50:30.140 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 10:50:30.146 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:50:30.153 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:50:30.157 +07:00 [INF] Executed ViewResult - view Index executed in 18.3242ms.
2025-10-24 10:50:30.158 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Category (BookStoreMVC) in 118.5243ms
2025-10-24 10:50:30.158 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Category (BookStoreMVC)'
2025-10-24 10:50:30.159 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/category/1 - 200 null text/html; charset=utf-8 127.9535ms
2025-10-24 10:51:10.663 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/category/12/BookStoreMVC.Models.Entities.Category - null null
2025-10-24 10:51:10.665 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Category (BookStoreMVC)'
2025-10-24 10:51:10.667 +07:00 [INF] Route matched with {action = "Category", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Category(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 10:51:10.670 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[CreatedAt], [s].[Description], [s].[ImageUrl], [s].[IsActive], [s].[Name], [s].[ParentCategoryId], [s].[Id0], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name0], [s].[ParentCategoryId0], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id] AS [Id0], [c0].[CreatedAt] AS [CreatedAt0], [c0].[Description] AS [Description0], [c0].[ImageUrl] AS [ImageUrl0], [c0].[IsActive] AS [IsActive0], [c0].[Name] AS [Name0], [c0].[ParentCategoryId] AS [ParentCategoryId0]
    FROM [Categories] AS [c]
    LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
    WHERE [c].[Id] = @__id_0
) AS [s]
LEFT JOIN [Books] AS [b] ON [s].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [s].[Id] = [c1].[ParentCategoryId]
ORDER BY [s].[Id], [s].[Id0], [b].[Id]
2025-10-24 10:51:10.674 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__model_CategoryId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CategoryId] = @__model_CategoryId_0
2025-10-24 10:51:10.677 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__model_CategoryId_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[CategoryId] = @__model_CategoryId_0
    ORDER BY [b].[Title]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[Title], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 10:51:10.680 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:51:10.682 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 10:51:10.684 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:51:10.686 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:51:10.687 +07:00 [INF] Executed ViewResult - view Index executed in 6.0258ms.
2025-10-24 10:51:10.688 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Category (BookStoreMVC) in 20.5527ms
2025-10-24 10:51:10.689 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Category (BookStoreMVC)'
2025-10-24 10:51:10.690 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/category/12/BookStoreMVC.Models.Entities.Category - 200 null text/html; charset=utf-8 26.9739ms
2025-10-24 10:51:22.987 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/Details/5 - null null
2025-10-24 10:51:22.991 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 10:51:22.992 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 10:51:22.996 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 10:51:23.001 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 10:51:23.004 +07:00 [INF] Book 5 - AdditionalImages: null, GalleryCount: 0, HasGallery: false
2025-10-24 10:51:23.005 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 10:51:23.007 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:51:23.009 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:51:23.011 +07:00 [INF] Executed ViewResult - view Details executed in 5.824ms.
2025-10-24 10:51:23.011 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 18.7244ms
2025-10-24 10:51:23.012 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 10:51:23.013 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/Details/5 - 200 null text/html; charset=utf-8 25.3191ms
2025-10-24 10:51:28.023 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/account/Login?returnUrl=%2FBooks%2FDetails%2F5 - null null
2025-10-24 10:51:28.027 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 10:51:28.031 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 10:51:28.039 +07:00 [INF] Executing ViewResult, running view Login.
2025-10-24 10:51:28.068 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:51:28.071 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:51:28.075 +07:00 [INF] Executed ViewResult - view Login executed in 36.3405ms.
2025-10-24 10:51:28.076 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 43.8522ms
2025-10-24 10:51:28.077 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 10:51:28.077 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/account/Login?returnUrl=%2FBooks%2FDetails%2F5 - 200 null text/html; charset=utf-8 53.9858ms
2025-10-24 10:51:28.147 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - null null
2025-10-24 10:51:28.147 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - null null
2025-10-24 10:51:28.179 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - 404 0 null 32.1575ms
2025-10-24 10:51:28.181 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - 404 0 null 34.0206ms
2025-10-24 10:51:28.184 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/auth-validation.js, Response status code: 404
2025-10-24 10:51:28.186 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/bookverse-core.js, Response status code: 404
2025-10-24 10:51:48.145 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/account/Login - application/x-www-form-urlencoded 281
2025-10-24 10:51:48.150 +07:00 [INF] CORS policy execution failed.
2025-10-24 10:51:48.150 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 10:51:48.154 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 10:51:48.158 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BookStoreMVC.Models.ViewModels.LoginViewModel, System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 10:51:48.180 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-10-24 10:51:48.271 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2025-10-24 10:51:48.289 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-10-24 10:51:48.293 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 10:51:48.301 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2025-10-24 10:51:48.305 +07:00 [INF] AuthenticationScheme: Identity.Application signed in.
2025-10-24 10:51:48.306 +07:00 [INF] User logged in.
2025-10-24 10:51:48.307 +07:00 [INF] Executing RedirectResult, redirecting to /Books/Details/5.
2025-10-24 10:51:48.307 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 147.3223ms
2025-10-24 10:51:48.308 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 10:51:48.309 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/account/Login - 302 0 null 163.939ms
2025-10-24 10:51:48.311 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/Details/5 - null null
2025-10-24 10:51:48.316 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 10:51:48.317 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 10:51:48.319 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 10:51:48.322 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 10:51:48.336 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 10:51:48.339 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 10:51:48.344 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 10:51:48.352 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [WishlistItems] AS [w]
        WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 10:51:48.359 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__bookId_1
2025-10-24 10:51:48.361 +07:00 [INF] Book 5 - AdditionalImages: null, GalleryCount: 0, HasGallery: false
2025-10-24 10:51:48.362 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 10:51:48.367 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:51:48.369 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:51:48.371 +07:00 [INF] Executed ViewResult - view Details executed in 9.4166ms.
2025-10-24 10:51:48.373 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 54.9164ms
2025-10-24 10:51:48.373 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 10:51:48.374 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/Details/5 - 200 null text/html; charset=utf-8 63.5743ms
2025-10-24 10:51:51.211 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/wishlist/toggle - application/json 12
2025-10-24 10:51:51.215 +07:00 [INF] CORS policy execution failed.
2025-10-24 10:51:51.216 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 10:51:51.220 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 10:51:51.223 +07:00 [INF] Route matched with {action = "Toggle", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Toggle(BookStoreMVC.Models.ViewModels.AddToWishlistViewModel) on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 10:51:51.225 +07:00 [INF] Antiforgery token validation failed. The required antiforgery header value "RequestVerificationToken" is not present.
Microsoft.AspNetCore.Antiforgery.AntiforgeryValidationException: The required antiforgery header value "RequestVerificationToken" is not present.
   at Microsoft.AspNetCore.Antiforgery.DefaultAntiforgery.ValidateRequestAsync(HttpContext httpContext)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.Filters.ValidateAntiforgeryTokenAuthorizationFilter.OnAuthorizationAsync(AuthorizationFilterContext context)
2025-10-24 10:51:51.230 +07:00 [INF] Authorization failed for the request at filter 'Microsoft.AspNetCore.Mvc.ViewFeatures.Filters.ValidateAntiforgeryTokenAuthorizationFilter'.
2025-10-24 10:51:51.232 +07:00 [INF] Executing StatusCodeResult, setting HTTP status code 400
2025-10-24 10:51:51.232 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC) in 8.1741ms
2025-10-24 10:51:51.233 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 10:51:51.234 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/wishlist/toggle - 400 0 null 22.7463ms
2025-10-24 10:51:52.575 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/wishlist/toggle - application/json 12
2025-10-24 10:51:52.581 +07:00 [INF] CORS policy execution failed.
2025-10-24 10:51:52.582 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 10:51:52.587 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 10:51:52.588 +07:00 [INF] Route matched with {action = "Toggle", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Toggle(BookStoreMVC.Models.ViewModels.AddToWishlistViewModel) on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 10:51:52.590 +07:00 [INF] Antiforgery token validation failed. The required antiforgery header value "RequestVerificationToken" is not present.
Microsoft.AspNetCore.Antiforgery.AntiforgeryValidationException: The required antiforgery header value "RequestVerificationToken" is not present.
   at Microsoft.AspNetCore.Antiforgery.DefaultAntiforgery.ValidateRequestAsync(HttpContext httpContext)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.Filters.ValidateAntiforgeryTokenAuthorizationFilter.OnAuthorizationAsync(AuthorizationFilterContext context)
2025-10-24 10:51:52.591 +07:00 [INF] Authorization failed for the request at filter 'Microsoft.AspNetCore.Mvc.ViewFeatures.Filters.ValidateAntiforgeryTokenAuthorizationFilter'.
2025-10-24 10:51:52.591 +07:00 [INF] Executing StatusCodeResult, setting HTTP status code 400
2025-10-24 10:51:52.592 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC) in 2.2971ms
2025-10-24 10:51:52.593 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 10:51:52.594 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/wishlist/toggle - 400 0 null 19.1455ms
2025-10-24 10:51:55.659 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/wishlist/toggle - application/json 12
2025-10-24 10:51:55.664 +07:00 [INF] CORS policy execution failed.
2025-10-24 10:51:55.664 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 10:51:55.665 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 10:51:55.666 +07:00 [INF] Route matched with {action = "Toggle", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Toggle(BookStoreMVC.Models.ViewModels.AddToWishlistViewModel) on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 10:51:55.667 +07:00 [INF] Antiforgery token validation failed. The required antiforgery header value "RequestVerificationToken" is not present.
Microsoft.AspNetCore.Antiforgery.AntiforgeryValidationException: The required antiforgery header value "RequestVerificationToken" is not present.
   at Microsoft.AspNetCore.Antiforgery.DefaultAntiforgery.ValidateRequestAsync(HttpContext httpContext)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.Filters.ValidateAntiforgeryTokenAuthorizationFilter.OnAuthorizationAsync(AuthorizationFilterContext context)
2025-10-24 10:51:55.668 +07:00 [INF] Authorization failed for the request at filter 'Microsoft.AspNetCore.Mvc.ViewFeatures.Filters.ValidateAntiforgeryTokenAuthorizationFilter'.
2025-10-24 10:51:55.669 +07:00 [INF] Executing StatusCodeResult, setting HTTP status code 400
2025-10-24 10:51:55.669 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC) in 2.1933ms
2025-10-24 10:51:55.670 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 10:51:55.670 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/wishlist/toggle - 400 0 null 11.1738ms
2025-10-24 10:51:56.434 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - application/json 25
2025-10-24 10:51:56.440 +07:00 [INF] CORS policy execution failed.
2025-10-24 10:51:56.441 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 10:51:56.442 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-24 10:51:56.445 +07:00 [INF] Route matched with {action = "AddToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddToCart(BookStoreMVC.Models.ViewModels.AddToCartViewModel) on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-24 10:51:56.464 +07:00 [INF] AddToCart request - BookId: 5, Quantity: 1
2025-10-24 10:51:56.470 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-24 10:51:56.476 +07:00 [INF] === ADD TO CART START ===
2025-10-24 10:51:56.476 +07:00 [INF] UserId: 37a6e596-ce7b-4304-9a4f-b8e0dc9abb95, BookId: 5, Quantity: 1
2025-10-24 10:51:56.478 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-24 10:51:56.479 +07:00 [INF] Book Found - Title: Biên Niên Ký Chim Vặn Dây Cót, Stock: 50, IsActive: true
2025-10-24 10:51:56.483 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__model_BookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__model_BookId_1
2025-10-24 10:51:56.484 +07:00 [INF] Cart Status - Current: 0, Adding: 1, New Total: 1
2025-10-24 10:51:56.485 +07:00 [INF] Creating new cart item with quantity 1
2025-10-24 10:51:56.549 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-24 10:51:56.558 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CartItems] ([BookId], [CreatedAt], [Quantity], [UpdatedAt], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-10-24 10:51:56.576 +07:00 [INF] === ADD TO CART SUCCESS ===
2025-10-24 10:51:56.581 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([c].[Quantity]), 0)
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0
2025-10-24 10:51:56.583 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType20`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-24 10:51:56.588 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC) in 142.1744ms
2025-10-24 10:51:56.590 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-24 10:51:56.591 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - 200 null application/json; charset=utf-8 156.8555ms
2025-10-24 10:51:57.435 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/account/Login?returnUrl=%2FBooks%2FDetails%2F5 - null null
2025-10-24 10:51:57.437 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 10:51:57.438 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 10:51:57.440 +07:00 [INF] Executing RedirectResult, redirecting to /.
2025-10-24 10:51:57.440 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 1.1702ms
2025-10-24 10:51:57.441 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 10:51:57.442 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/account/Login?returnUrl=%2FBooks%2FDetails%2F5 - 302 0 null 6.5433ms
2025-10-24 10:51:57.444 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 10:51:57.446 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 10:51:57.446 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 10:51:57.449 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 10:51:57.452 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 10:51:57.456 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 10:51:57.460 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:51:57.461 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 10:51:57.462 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 10:51:57.464 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 10:51:57.465 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 10:51:57.467 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 10:51:57.470 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 10:51:57.473 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 10:51:57.476 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 10:51:57.478 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:51:57.480 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:51:57.482 +07:00 [INF] Executed ViewResult - view Index executed in 5.9706ms.
2025-10-24 10:51:57.482 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 35.1294ms
2025-10-24 10:51:57.483 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 10:51:57.484 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 39.47ms
2025-10-24 10:51:58.111 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books/Details/5 - null null
2025-10-24 10:51:58.114 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 10:51:58.115 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 10:51:58.117 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 10:51:58.122 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 10:51:58.126 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 10:51:58.128 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 10:51:58.130 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 10:51:58.131 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [WishlistItems] AS [w]
        WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 10:51:58.133 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__bookId_1
2025-10-24 10:51:58.136 +07:00 [INF] Book 5 - AdditionalImages: null, GalleryCount: 0, HasGallery: false
2025-10-24 10:51:58.137 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 10:51:58.141 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:51:58.143 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:51:58.144 +07:00 [INF] Executed ViewResult - view Details executed in 7.6732ms.
2025-10-24 10:51:58.145 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 28.9687ms
2025-10-24 10:51:58.146 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 10:51:58.146 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books/Details/5 - 200 null text/html; charset=utf-8 34.9376ms
2025-10-24 10:51:59.807 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/wishlist/toggle - application/json 12
2025-10-24 10:51:59.811 +07:00 [INF] CORS policy execution failed.
2025-10-24 10:51:59.812 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 10:51:59.813 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 10:51:59.814 +07:00 [INF] Route matched with {action = "Toggle", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Toggle(BookStoreMVC.Models.ViewModels.AddToWishlistViewModel) on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 10:51:59.815 +07:00 [INF] Antiforgery token validation failed. The required antiforgery header value "RequestVerificationToken" is not present.
Microsoft.AspNetCore.Antiforgery.AntiforgeryValidationException: The required antiforgery header value "RequestVerificationToken" is not present.
   at Microsoft.AspNetCore.Antiforgery.DefaultAntiforgery.ValidateRequestAsync(HttpContext httpContext)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.Filters.ValidateAntiforgeryTokenAuthorizationFilter.OnAuthorizationAsync(AuthorizationFilterContext context)
2025-10-24 10:51:59.816 +07:00 [INF] Authorization failed for the request at filter 'Microsoft.AspNetCore.Mvc.ViewFeatures.Filters.ValidateAntiforgeryTokenAuthorizationFilter'.
2025-10-24 10:51:59.817 +07:00 [INF] Executing StatusCodeResult, setting HTTP status code 400
2025-10-24 10:51:59.817 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC) in 1.9867ms
2025-10-24 10:51:59.818 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 10:51:59.818 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/wishlist/toggle - 400 0 null 11.6778ms
2025-10-24 10:52:00.826 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 10:52:00.828 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 10:52:00.828 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 10:52:00.831 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 10:52:00.836 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 10:52:00.840 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 10:52:00.842 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:52:00.844 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 10:52:00.846 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 10:52:00.847 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 10:52:00.848 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 10:52:00.850 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 10:52:00.855 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 10:52:00.857 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 10:52:00.860 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 10:52:00.862 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:52:00.864 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:52:00.865 +07:00 [INF] Executed ViewResult - view Index executed in 5.8179ms.
2025-10-24 10:52:00.866 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 36.6034ms
2025-10-24 10:52:00.867 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 10:52:00.868 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 42.0707ms
2025-10-24 10:52:03.619 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Wishlist/Toggle - application/json 12
2025-10-24 10:52:03.623 +07:00 [INF] CORS policy execution failed.
2025-10-24 10:52:03.624 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 10:52:03.625 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 10:52:03.626 +07:00 [INF] Route matched with {action = "Toggle", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Toggle(BookStoreMVC.Models.ViewModels.AddToWishlistViewModel) on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 10:52:03.635 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__bookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[IsActive]
FROM [Books] AS [b]
WHERE [b].[Id] = @__bookId_0
2025-10-24 10:52:03.641 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [w].[Id], [w].[BookId], [w].[CreatedAt], [w].[UserId]
FROM [WishlistItems] AS [w]
WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1
2025-10-24 10:52:03.656 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [WishlistItems] ([BookId], [CreatedAt], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2);
2025-10-24 10:52:03.662 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [WishlistItems] AS [w]
WHERE [w].[UserId] = @__userId_0
2025-10-24 10:52:03.663 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType35`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-24 10:52:03.666 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC) in 38.7973ms
2025-10-24 10:52:03.667 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 10:52:03.667 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Wishlist/Toggle - 200 null application/json; charset=utf-8 48.7327ms
2025-10-24 10:52:07.153 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/books/5 - null null
2025-10-24 10:52:07.155 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 10:52:07.155 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 10:52:07.158 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 10:52:07.162 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 10:52:07.167 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 10:52:07.168 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 10:52:07.170 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 10:52:07.171 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [WishlistItems] AS [w]
        WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 10:52:07.173 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__bookId_1
2025-10-24 10:52:07.174 +07:00 [INF] Book 5 - AdditionalImages: null, GalleryCount: 0, HasGallery: false
2025-10-24 10:52:07.175 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 10:52:07.176 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:52:07.180 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:52:07.183 +07:00 [INF] Executed ViewResult - view Details executed in 8.3937ms.
2025-10-24 10:52:07.184 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 27.6741ms
2025-10-24 10:52:07.185 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 10:52:07.185 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/books/5 - 200 null text/html; charset=utf-8 32.8361ms
2025-10-24 10:52:08.522 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/wishlist/toggle - application/json 12
2025-10-24 10:52:08.527 +07:00 [INF] CORS policy execution failed.
2025-10-24 10:52:08.527 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 10:52:08.529 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 10:52:08.530 +07:00 [INF] Route matched with {action = "Toggle", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Toggle(BookStoreMVC.Models.ViewModels.AddToWishlistViewModel) on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 10:52:08.532 +07:00 [INF] Antiforgery token validation failed. The required antiforgery header value "RequestVerificationToken" is not present.
Microsoft.AspNetCore.Antiforgery.AntiforgeryValidationException: The required antiforgery header value "RequestVerificationToken" is not present.
   at Microsoft.AspNetCore.Antiforgery.DefaultAntiforgery.ValidateRequestAsync(HttpContext httpContext)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.Filters.ValidateAntiforgeryTokenAuthorizationFilter.OnAuthorizationAsync(AuthorizationFilterContext context)
2025-10-24 10:52:08.532 +07:00 [INF] Authorization failed for the request at filter 'Microsoft.AspNetCore.Mvc.ViewFeatures.Filters.ValidateAntiforgeryTokenAuthorizationFilter'.
2025-10-24 10:52:08.533 +07:00 [INF] Executing StatusCodeResult, setting HTTP status code 400
2025-10-24 10:52:08.533 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC) in 1.9722ms
2025-10-24 10:52:08.534 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Toggle (BookStoreMVC)'
2025-10-24 10:52:08.535 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/wishlist/toggle - 400 0 null 12.2116ms
2025-10-24 10:52:47.594 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/wishlist - null null
2025-10-24 10:52:47.596 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 10:52:47.599 +07:00 [INF] Route matched with {action = "Index", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 10:52:47.624 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[BookId], [w].[CreatedAt], [w].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [WishlistItems] AS [w]
INNER JOIN [Books] AS [b] ON [w].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [w].[UserId] = @__userId_0
ORDER BY [w].[CreatedAt] DESC, [w].[Id], [b].[Id], [c].[Id]
2025-10-24 10:52:47.633 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 10:52:47.642 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:52:47.644 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 10:52:47.648 +07:00 [INF] Executed ViewResult - view Index executed in 15.7719ms.
2025-10-24 10:52:47.649 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC) in 49.4961ms
2025-10-24 10:52:47.650 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 10:52:47.651 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/wishlist - 200 null text/html; charset=utf-8 57.8169ms
2025-10-24 10:59:42.169 +07:00 [INF] Application is shutting down...
2025-10-24 11:00:06.891 +07:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-24 11:00:07.687 +07:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-24 11:00:07.699 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-24 11:00:07.722 +07:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-24 11:00:07.772 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-24 11:00:07.788 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-24 11:00:07.791 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-24 11:00:07.796 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-24 11:00:07.805 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-10-24 11:00:07.809 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-24 11:00:08.006 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 11:00:08.048 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 11:00:08.062 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-10-24 11:00:08.102 +07:00 [INF] ✅ Database initialized with admin user only.
2025-10-24 11:00:08.106 +07:00 [INF] Database initialized successfully
2025-10-24 11:00:08.166 +07:00 [INF] ==========================================
2025-10-24 11:00:08.166 +07:00 [INF] BookStore Application Starting...
2025-10-24 11:00:08.167 +07:00 [INF] Environment: Production
2025-10-24 11:00:08.167 +07:00 [INF] Session Timeout: 7 days
2025-10-24 11:00:08.169 +07:00 [INF] Guest Cart: Enabled
2025-10-24 11:00:08.169 +07:00 [INF] ==========================================
2025-10-24 11:00:08.224 +07:00 [INF] Now listening on: http://localhost:5000
2025-10-24 11:00:08.226 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-24 11:00:08.227 +07:00 [INF] Hosting environment: Production
2025-10-24 11:00:08.227 +07:00 [INF] Content root path: C:\Users\DELL\Desktop\Bán sách\BookStoreMWC
2025-10-24 11:00:09.581 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 11:00:09.587 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-24 11:00:09.635 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 11:00:09.645 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 11:00:09.782 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:00:09.868 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:00:09.885 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 11:00:09.913 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 11:00:09.935 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:00:09.947 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 11:00:09.960 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 11:00:09.973 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 11:00:09.996 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 11:00:10.010 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 11:00:10.030 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 11:00:10.053 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 11:00:10.064 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 11:00:10.088 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 11:00:10.124 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 11:00:10.213 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:00:10.222 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:00:10.254 +07:00 [INF] Executed ViewResult - view Index executed in 128.9149ms.
2025-10-24 11:00:10.259 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 612.6753ms
2025-10-24 11:00:10.261 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 11:00:10.269 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 689.1357ms
2025-10-24 11:00:12.032 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/books/2 - null null
2025-10-24 11:00:12.051 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 11:00:12.060 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 11:00:12.124 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 11:00:12.153 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 11:00:12.207 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:00:12.225 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:00:12.229 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:00:12.237 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:00:12.244 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [WishlistItems] AS [w]
        WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:00:12.254 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__bookId_1
2025-10-24 11:00:12.256 +07:00 [INF] Book 2 - AdditionalImages: ["/images/books/gallery/45eb04ef-c7b3-4fad-90f6-d64fd1c7f8c2.jpg"], GalleryCount: 1, HasGallery: true
2025-10-24 11:00:12.259 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 11:00:12.276 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:00:12.279 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:00:12.285 +07:00 [INF] Executed ViewResult - view Details executed in 26.493ms.
2025-10-24 11:00:12.286 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 225.658ms
2025-10-24 11:00:12.287 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 11:00:12.289 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/books/2 - 200 null text/html; charset=utf-8 256.8072ms
2025-10-24 11:00:12.298 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/gallery/45eb04ef-c7b3-4fad-90f6-d64fd1c7f8c2.jpg - null null
2025-10-24 11:00:12.308 +07:00 [INF] The file /images/books/gallery/45eb04ef-c7b3-4fad-90f6-d64fd1c7f8c2.jpg was not modified
2025-10-24 11:00:12.309 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/gallery/45eb04ef-c7b3-4fad-90f6-d64fd1c7f8c2.jpg - 304 null image/jpeg 11.0663ms
2025-10-24 11:00:27.398 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/account/Logout - application/x-www-form-urlencoded 225
2025-10-24 11:00:27.404 +07:00 [INF] CORS policy execution failed.
2025-10-24 11:00:27.404 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 11:00:27.419 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC)'
2025-10-24 11:00:27.423 +07:00 [INF] Route matched with {action = "Logout", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 11:00:27.430 +07:00 [INF] AuthenticationScheme: Identity.Application signed out.
2025-10-24 11:00:27.431 +07:00 [INF] AuthenticationScheme: Identity.External signed out.
2025-10-24 11:00:27.431 +07:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2025-10-24 11:00:27.432 +07:00 [INF] User logged out.
2025-10-24 11:00:27.433 +07:00 [INF] Executing RedirectResult, redirecting to /.
2025-10-24 11:00:27.435 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC) in 9.8752ms
2025-10-24 11:00:27.436 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC)'
2025-10-24 11:00:27.437 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/account/Logout - 302 0 null 38.4907ms
2025-10-24 11:00:27.439 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 11:00:27.441 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 11:00:27.441 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 11:00:27.446 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:00:27.450 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:00:27.455 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 11:00:27.458 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:00:27.459 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 11:00:27.461 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 11:00:27.462 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 11:00:27.464 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 11:00:27.467 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 11:00:27.471 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 11:00:27.473 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 11:00:27.476 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 11:00:27.480 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:00:27.482 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:00:27.487 +07:00 [INF] Executed ViewResult - view Index executed in 11.3078ms.
2025-10-24 11:00:27.488 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 46.1929ms
2025-10-24 11:00:27.489 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 11:00:27.489 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 50.1596ms
2025-10-24 11:00:28.781 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/account/Login - null null
2025-10-24 11:00:28.786 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 11:00:28.788 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 11:00:28.792 +07:00 [INF] Executing ViewResult, running view Login.
2025-10-24 11:00:28.818 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:00:28.823 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:00:28.826 +07:00 [INF] Executed ViewResult - view Login executed in 34.9145ms.
2025-10-24 11:00:28.827 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 38.3353ms
2025-10-24 11:00:28.828 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 11:00:28.829 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/account/Login - 200 null text/html; charset=utf-8 47.9503ms
2025-10-24 11:00:28.841 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - null null
2025-10-24 11:00:28.841 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - null null
2025-10-24 11:00:28.844 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - 404 0 null 2.5286ms
2025-10-24 11:00:28.845 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - 404 0 null 3.7841ms
2025-10-24 11:00:28.845 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/bookverse-core.js, Response status code: 404
2025-10-24 11:00:28.846 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/auth-validation.js, Response status code: 404
2025-10-24 11:00:41.912 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/account/Login - application/x-www-form-urlencoded 241
2025-10-24 11:00:41.915 +07:00 [INF] CORS policy execution failed.
2025-10-24 11:00:41.915 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 11:00:41.917 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 11:00:41.925 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BookStoreMVC.Models.ViewModels.LoginViewModel, System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 11:00:41.943 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-10-24 11:00:42.032 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2025-10-24 11:00:42.047 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-10-24 11:00:42.050 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 11:00:42.055 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2025-10-24 11:00:42.060 +07:00 [INF] AuthenticationScheme: Identity.Application signed in.
2025-10-24 11:00:42.061 +07:00 [INF] User logged in.
2025-10-24 11:00:42.062 +07:00 [INF] Executing RedirectResult, redirecting to /.
2025-10-24 11:00:42.063 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 136.2699ms
2025-10-24 11:00:42.063 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 11:00:42.064 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/account/Login - 302 0 null 151.8506ms
2025-10-24 11:00:42.066 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 11:00:42.068 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 11:00:42.068 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 11:00:42.070 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:00:42.076 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:00:42.079 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 11:00:42.082 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:00:42.084 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 11:00:42.085 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 11:00:42.086 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 11:00:42.088 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 11:00:42.090 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 11:00:42.095 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 11:00:42.097 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 11:00:42.099 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 11:00:42.101 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:00:42.103 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:00:42.105 +07:00 [INF] Executed ViewResult - view Index executed in 6.3098ms.
2025-10-24 11:00:42.106 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 36.9609ms
2025-10-24 11:00:42.107 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 11:00:42.108 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 41.7538ms
2025-10-24 11:00:45.702 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/books/3 - null null
2025-10-24 11:00:45.706 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 11:00:45.707 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 11:00:45.710 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 11:00:45.714 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:00:45.716 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:00:45.718 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:00:45.720 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:00:45.722 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [WishlistItems] AS [w]
        WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:00:45.732 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__bookId_1
2025-10-24 11:00:45.743 +07:00 [INF] Book 3 - AdditionalImages: null, GalleryCount: 0, HasGallery: false
2025-10-24 11:00:45.744 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 11:00:45.746 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:00:45.748 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:00:45.749 +07:00 [INF] Executed ViewResult - view Details executed in 5.3423ms.
2025-10-24 11:00:45.750 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 41.6856ms
2025-10-24 11:00:45.751 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 11:00:45.752 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/books/3 - 200 null text/html; charset=utf-8 49.6301ms
2025-10-24 11:02:22.043 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/wishlist - null null
2025-10-24 11:02:22.047 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 11:02:22.051 +07:00 [INF] Route matched with {action = "Index", controller = "Wishlist"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.WishlistController (BookStoreMVC).
2025-10-24 11:02:22.082 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [w].[Id], [w].[BookId], [w].[CreatedAt], [w].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [WishlistItems] AS [w]
INNER JOIN [Books] AS [b] ON [w].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [w].[UserId] = @__userId_0
ORDER BY [w].[CreatedAt] DESC, [w].[Id], [b].[Id], [c].[Id]
2025-10-24 11:02:22.095 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 11:02:22.105 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:02:22.107 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:02:22.111 +07:00 [INF] Executed ViewResult - view Index executed in 16.2786ms.
2025-10-24 11:02:22.112 +07:00 [INF] Executed action BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC) in 59.4191ms
2025-10-24 11:02:22.113 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.WishlistController.Index (BookStoreMVC)'
2025-10-24 11:02:22.113 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/wishlist - 200 null text/html; charset=utf-8 69.8507ms
2025-10-24 11:02:23.402 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/books/1 - null null
2025-10-24 11:02:23.403 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 11:02:23.404 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 11:02:23.407 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 11:02:23.411 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:02:23.414 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:02:23.415 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:02:23.417 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:02:23.418 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [WishlistItems] AS [w]
        WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:02:23.420 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__bookId_1
2025-10-24 11:02:23.421 +07:00 [INF] Book 1 - AdditionalImages: ["/images/books/gallery/747bf3dd-b187-424e-bb5a-152167091a35.jpg"], GalleryCount: 1, HasGallery: true
2025-10-24 11:02:23.422 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 11:02:23.425 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:02:23.428 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:02:23.429 +07:00 [INF] Executed ViewResult - view Details executed in 7.6811ms.
2025-10-24 11:02:23.430 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 25.0097ms
2025-10-24 11:02:23.431 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 11:02:23.431 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/books/1 - 200 null text/html; charset=utf-8 29.8902ms
2025-10-24 11:04:00.699 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - application/json 25
2025-10-24 11:04:00.704 +07:00 [INF] CORS policy execution failed.
2025-10-24 11:04:00.704 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 11:04:00.705 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-24 11:04:00.709 +07:00 [INF] Route matched with {action = "AddToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddToCart(BookStoreMVC.Models.ViewModels.AddToCartViewModel) on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-24 11:04:00.721 +07:00 [INF] AddToCart request - BookId: 6, Quantity: 1
2025-10-24 11:04:00.729 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-24 11:04:00.734 +07:00 [INF] === ADD TO CART START ===
2025-10-24 11:04:00.734 +07:00 [INF] UserId: 4b2ccf54-913b-4dfb-a99f-201f71a1b07b, BookId: 6, Quantity: 1
2025-10-24 11:04:00.736 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-24 11:04:00.737 +07:00 [INF] Book Found - Title: Kiêu Hãnh Và Định Kiến - Jane Austen (Bìa Cứng), Stock: 120, IsActive: true
2025-10-24 11:04:00.741 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__model_BookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__model_BookId_1
2025-10-24 11:04:00.743 +07:00 [INF] Cart Status - Current: 0, Adding: 1, New Total: 1
2025-10-24 11:04:00.743 +07:00 [INF] Creating new cart item with quantity 1
2025-10-24 11:04:00.803 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-24 11:04:00.818 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CartItems] ([BookId], [CreatedAt], [Quantity], [UpdatedAt], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-10-24 11:04:00.836 +07:00 [INF] === ADD TO CART SUCCESS ===
2025-10-24 11:04:00.842 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([c].[Quantity]), 0)
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0
2025-10-24 11:04:00.845 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType20`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-24 11:04:00.851 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC) in 140.8872ms
2025-10-24 11:04:00.852 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-24 11:04:00.852 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - 200 null application/json; charset=utf-8 154.0122ms
2025-10-24 11:04:05.134 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/cart - null null
2025-10-24 11:04:05.137 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-24 11:04:05.140 +07:00 [INF] Route matched with {action = "Index", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-24 11:04:05.192 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[Id], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [CartItems] AS [c]
LEFT JOIN [Books] AS [b] ON [c].[BookId] = [b].[Id]
LEFT JOIN [Categories] AS [c0] ON [b].[CategoryId] = [c0].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [c].[UserId] = @__userId_0
ORDER BY [c].[CreatedAt], [c].[Id], [b].[Id], [c0].[Id]
2025-10-24 11:04:05.199 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 11:04:05.206 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:04:05.209 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:04:05.211 +07:00 [INF] Executed ViewResult - view Index executed in 12.9581ms.
2025-10-24 11:04:05.212 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.Index (BookStoreMVC) in 71.1688ms
2025-10-24 11:04:05.213 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-24 11:04:05.214 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/cart - 200 null text/html; charset=utf-8 79.1226ms
2025-10-24 11:04:32.608 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Cart/ClearCart - application/json 0
2025-10-24 11:04:32.614 +07:00 [INF] CORS policy execution failed.
2025-10-24 11:04:32.614 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 11:04:32.616 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.ClearCart (BookStoreMVC)'
2025-10-24 11:04:32.620 +07:00 [INF] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ClearCart() on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-24 11:04:32.627 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0
2025-10-24 11:04:32.642 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [CartItems]
OUTPUT 1
WHERE [Id] = @p0;
DELETE FROM [CartItems]
OUTPUT 1
WHERE [Id] = @p1;
DELETE FROM [CartItems]
OUTPUT 1
WHERE [Id] = @p2;
2025-10-24 11:04:32.647 +07:00 [INF] Cleared cart for UserId 4b2ccf54-913b-4dfb-a99f-201f71a1b07b
2025-10-24 11:04:32.648 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType2`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-24 11:04:32.650 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.ClearCart (BookStoreMVC) in 29.1558ms
2025-10-24 11:04:32.652 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.ClearCart (BookStoreMVC)'
2025-10-24 11:04:32.652 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Cart/ClearCart - 200 null application/json; charset=utf-8 43.9297ms
2025-10-24 11:04:32.657 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/cart - null null
2025-10-24 11:04:32.659 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-24 11:04:32.660 +07:00 [INF] Route matched with {action = "Index", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-24 11:04:32.661 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[Id], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [CartItems] AS [c]
LEFT JOIN [Books] AS [b] ON [c].[BookId] = [b].[Id]
LEFT JOIN [Categories] AS [c0] ON [b].[CategoryId] = [c0].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [c].[UserId] = @__userId_0
ORDER BY [c].[CreatedAt], [c].[Id], [b].[Id], [c0].[Id]
2025-10-24 11:04:32.663 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 11:04:32.665 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:04:32.667 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:04:32.669 +07:00 [INF] Executed ViewResult - view Index executed in 6.2989ms.
2025-10-24 11:04:32.670 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.Index (BookStoreMVC) in 9.3049ms
2025-10-24 11:04:32.671 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-24 11:04:32.673 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/cart - 200 null text/html; charset=utf-8 15.6793ms
2025-10-24 11:04:32.694 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/BOOK.png?v=QztAXuOfgcsIJZg3XCCS1qK3ZFO0Q3cC8g9UFxPKzyQ - null null
2025-10-24 11:04:32.696 +07:00 [INF] The file /BOOK.png was not modified
2025-10-24 11:04:32.697 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/BOOK.png?v=QztAXuOfgcsIJZg3XCCS1qK3ZFO0Q3cC8g9UFxPKzyQ - 304 null image/png 2.3993ms
2025-10-24 11:04:38.000 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - application/json 25
2025-10-24 11:04:38.003 +07:00 [INF] CORS policy execution failed.
2025-10-24 11:04:38.004 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 11:04:38.005 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-24 11:04:38.005 +07:00 [INF] Route matched with {action = "AddToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddToCart(BookStoreMVC.Models.ViewModels.AddToCartViewModel) on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-24 11:04:38.007 +07:00 [INF] AddToCart request - BookId: 6, Quantity: 1
2025-10-24 11:04:38.008 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-24 11:04:38.018 +07:00 [INF] === ADD TO CART START ===
2025-10-24 11:04:38.018 +07:00 [INF] UserId: 4b2ccf54-913b-4dfb-a99f-201f71a1b07b, BookId: 6, Quantity: 1
2025-10-24 11:04:38.019 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-24 11:04:38.020 +07:00 [INF] Book Found - Title: Kiêu Hãnh Và Định Kiến - Jane Austen (Bìa Cứng), Stock: 120, IsActive: true
2025-10-24 11:04:38.021 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__model_BookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__model_BookId_1
2025-10-24 11:04:38.022 +07:00 [INF] Cart Status - Current: 0, Adding: 1, New Total: 1
2025-10-24 11:04:38.023 +07:00 [INF] Creating new cart item with quantity 1
2025-10-24 11:04:38.024 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-24 11:04:38.025 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CartItems] ([BookId], [CreatedAt], [Quantity], [UpdatedAt], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-10-24 11:04:38.029 +07:00 [INF] === ADD TO CART SUCCESS ===
2025-10-24 11:04:38.031 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([c].[Quantity]), 0)
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0
2025-10-24 11:04:38.032 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType20`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-24 11:04:38.033 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC) in 27.0779ms
2025-10-24 11:04:38.034 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-24 11:04:38.035 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - 200 null application/json; charset=utf-8 34.6018ms
2025-10-24 11:04:40.908 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/cart - null null
2025-10-24 11:04:40.911 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-24 11:04:40.912 +07:00 [INF] Route matched with {action = "Index", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-24 11:04:40.914 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[Id], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [CartItems] AS [c]
LEFT JOIN [Books] AS [b] ON [c].[BookId] = [b].[Id]
LEFT JOIN [Categories] AS [c0] ON [b].[CategoryId] = [c0].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [c].[UserId] = @__userId_0
ORDER BY [c].[CreatedAt], [c].[Id], [b].[Id], [c0].[Id]
2025-10-24 11:04:40.916 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 11:04:40.919 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:04:40.921 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:04:40.922 +07:00 [INF] Executed ViewResult - view Index executed in 6.2456ms.
2025-10-24 11:04:40.923 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.Index (BookStoreMVC) in 10.7411ms
2025-10-24 11:04:40.924 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-24 11:04:40.924 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/cart - 200 null text/html; charset=utf-8 16.6169ms
2025-10-24 11:06:31.877 +07:00 [INF] Application is shutting down...
2025-10-24 11:13:28.873 +07:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-24 11:13:30.285 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-24 11:13:30.297 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-24 11:13:30.322 +07:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-24 11:13:30.374 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-24 11:13:30.388 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-24 11:13:30.392 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-24 11:13:30.398 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-24 11:13:30.407 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-10-24 11:13:30.412 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-24 11:13:30.623 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 11:13:30.664 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 11:13:30.679 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-10-24 11:13:30.714 +07:00 [INF] ✅ Database initialized with admin user only.
2025-10-24 11:13:30.718 +07:00 [INF] Database initialized successfully
2025-10-24 11:13:30.781 +07:00 [INF] ==========================================
2025-10-24 11:13:30.783 +07:00 [INF] BookStore Application Starting...
2025-10-24 11:13:30.783 +07:00 [INF] Environment: Production
2025-10-24 11:13:30.784 +07:00 [INF] Session Timeout: 7 days
2025-10-24 11:13:30.784 +07:00 [INF] Guest Cart: Enabled
2025-10-24 11:13:30.785 +07:00 [INF] ==========================================
2025-10-24 11:13:30.844 +07:00 [INF] Now listening on: http://localhost:5000
2025-10-24 11:13:30.845 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-24 11:13:30.846 +07:00 [INF] Hosting environment: Production
2025-10-24 11:13:30.847 +07:00 [INF] Content root path: C:\Users\DELL\Desktop\Bán sách\BookStoreMWC
2025-10-24 11:13:31.891 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 11:13:31.896 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-24 11:13:31.960 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 11:13:31.970 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 11:13:32.104 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:13:32.187 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:13:32.205 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 11:13:32.230 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 11:13:32.253 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:13:32.265 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 11:13:32.280 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 11:13:32.290 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 11:13:32.317 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 11:13:32.332 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 11:13:32.353 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 11:13:32.377 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 11:13:32.390 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 11:13:32.414 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 11:13:32.451 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 11:13:32.541 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:13:32.549 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:13:32.581 +07:00 [INF] Executed ViewResult - view Index executed in 129.8341ms.
2025-10-24 11:13:32.586 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 611.5778ms
2025-10-24 11:13:32.587 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 11:13:32.597 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 707.1211ms
2025-10-24 11:13:36.221 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/books/3 - null null
2025-10-24 11:13:36.229 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 11:13:36.236 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 11:13:36.290 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-24 11:13:36.317 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 11:13:36.349 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:13:36.363 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:13:36.375 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:13:36.378 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:13:36.384 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [WishlistItems] AS [w]
        WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:13:36.394 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__bookId_1
2025-10-24 11:13:36.396 +07:00 [INF] Book 3 - AdditionalImages: null, GalleryCount: 0, HasGallery: false
2025-10-24 11:13:36.399 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 11:13:36.416 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:13:36.421 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:13:36.425 +07:00 [INF] Executed ViewResult - view Details executed in 26.6008ms.
2025-10-24 11:13:36.426 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 188.3222ms
2025-10-24 11:13:36.427 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 11:13:36.428 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/books/3 - 200 null text/html; charset=utf-8 206.749ms
2025-10-24 11:13:44.920 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/reviews/Create?bookId=3 - null null
2025-10-24 11:13:44.936 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.ReviewsController.Create (BookStoreMVC)'
2025-10-24 11:13:44.939 +07:00 [INF] Route matched with {action = "Create", controller = "Reviews"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Int32) on controller BookStoreMVC.Controllers.ReviewsController (BookStoreMVC).
2025-10-24 11:13:44.946 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:13:44.949 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 11:13:44.952 +07:00 [INF] Executing ViewResult, running view Create.
2025-10-24 11:13:44.975 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:13:44.979 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:13:44.983 +07:00 [INF] Executed ViewResult - view Create executed in 30.8648ms.
2025-10-24 11:13:44.984 +07:00 [INF] Executed action BookStoreMVC.Controllers.ReviewsController.Create (BookStoreMVC) in 42.7282ms
2025-10-24 11:13:44.985 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.ReviewsController.Create (BookStoreMVC)'
2025-10-24 11:13:44.985 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/reviews/Create?bookId=3 - 200 null text/html; charset=utf-8 65.5845ms
2025-10-24 11:14:09.186 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/reviews/Create - application/x-www-form-urlencoded 326
2025-10-24 11:14:09.189 +07:00 [INF] CORS policy execution failed.
2025-10-24 11:14:09.189 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 11:14:09.194 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.ReviewsController.Create (BookStoreMVC)'
2025-10-24 11:14:09.213 +07:00 [INF] Route matched with {action = "Create", controller = "Reviews"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(BookStoreMVC.Models.ViewModels.ReviewCreateViewModel) on controller BookStoreMVC.Controllers.ReviewsController (BookStoreMVC).
2025-10-24 11:14:09.233 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 11:14:09.236 +07:00 [INF] Executing ViewResult, running view Create.
2025-10-24 11:14:09.239 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:14:09.241 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:14:09.244 +07:00 [INF] Executed ViewResult - view Create executed in 7.9262ms.
2025-10-24 11:14:09.245 +07:00 [INF] Executed action BookStoreMVC.Controllers.ReviewsController.Create (BookStoreMVC) in 29.3152ms
2025-10-24 11:14:09.247 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.ReviewsController.Create (BookStoreMVC)'
2025-10-24 11:14:09.248 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/reviews/Create - 200 null text/html; charset=utf-8 62.1663ms
2025-10-24 11:14:25.054 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/reviews/Create - application/x-www-form-urlencoded 326
2025-10-24 11:14:25.058 +07:00 [INF] CORS policy execution failed.
2025-10-24 11:14:25.058 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 11:14:25.061 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.ReviewsController.Create (BookStoreMVC)'
2025-10-24 11:14:25.061 +07:00 [INF] Route matched with {action = "Create", controller = "Reviews"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(BookStoreMVC.Models.ViewModels.ReviewCreateViewModel) on controller BookStoreMVC.Controllers.ReviewsController (BookStoreMVC).
2025-10-24 11:14:25.066 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 11:14:25.070 +07:00 [INF] Executing ViewResult, running view Create.
2025-10-24 11:14:25.073 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:14:25.075 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:14:25.077 +07:00 [INF] Executed ViewResult - view Create executed in 6.8673ms.
2025-10-24 11:14:25.078 +07:00 [INF] Executed action BookStoreMVC.Controllers.ReviewsController.Create (BookStoreMVC) in 14.5562ms
2025-10-24 11:14:25.079 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.ReviewsController.Create (BookStoreMVC)'
2025-10-24 11:14:25.080 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/reviews/Create - 200 null text/html; charset=utf-8 25.774ms
2025-10-24 11:15:29.445 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 11:15:29.449 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 11:15:29.450 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 11:15:29.453 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:15:29.459 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:15:29.463 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 11:15:29.467 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:15:29.469 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 11:15:29.470 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 11:15:29.472 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 11:15:29.473 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 11:15:29.476 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 11:15:29.480 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 11:15:29.483 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 11:15:29.485 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 11:15:29.488 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:15:29.490 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:15:29.492 +07:00 [INF] Executed ViewResult - view Index executed in 7.1086ms.
2025-10-24 11:15:29.493 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 42.6045ms
2025-10-24 11:15:29.495 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 11:15:29.496 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 51.6764ms
2025-10-24 11:15:34.399 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/books/3 - null null
2025-10-24 11:15:34.404 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 11:15:34.405 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 11:15:34.408 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 11:15:34.413 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:15:34.416 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:15:34.417 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:15:34.419 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:15:34.421 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [WishlistItems] AS [w]
        WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:15:34.424 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__bookId_1
2025-10-24 11:15:34.425 +07:00 [INF] Book 3 - AdditionalImages: null, GalleryCount: 0, HasGallery: false
2025-10-24 11:15:34.426 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 11:15:34.428 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:15:34.430 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:15:34.432 +07:00 [INF] Executed ViewResult - view Details executed in 5.4338ms.
2025-10-24 11:15:34.433 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 26.4342ms
2025-10-24 11:15:34.433 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 11:15:34.434 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/books/3 - 200 null text/html; charset=utf-8 34.9903ms
2025-10-24 11:16:42.406 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/reviews/Create - application/x-www-form-urlencoded 328
2025-10-24 11:16:42.410 +07:00 [INF] CORS policy execution failed.
2025-10-24 11:16:42.410 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 11:16:42.411 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.ReviewsController.Create (BookStoreMVC)'
2025-10-24 11:16:42.412 +07:00 [INF] Route matched with {action = "Create", controller = "Reviews"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(BookStoreMVC.Models.ViewModels.ReviewCreateViewModel) on controller BookStoreMVC.Controllers.ReviewsController (BookStoreMVC).
2025-10-24 11:16:42.417 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 11:16:42.421 +07:00 [INF] Executing ViewResult, running view Create.
2025-10-24 11:16:42.423 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:16:42.425 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:16:42.427 +07:00 [INF] Executed ViewResult - view Create executed in 5.991ms.
2025-10-24 11:16:42.428 +07:00 [INF] Executed action BookStoreMVC.Controllers.ReviewsController.Create (BookStoreMVC) in 14.4531ms
2025-10-24 11:16:42.428 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.ReviewsController.Create (BookStoreMVC)'
2025-10-24 11:16:42.429 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/reviews/Create - 200 null text/html; charset=utf-8 22.7901ms
2025-10-24 11:16:54.708 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin - null null
2025-10-24 11:16:54.718 +07:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Admin)
2025-10-24 11:16:54.728 +07:00 [INF] AuthenticationScheme: Identity.Application was forbidden.
2025-10-24 11:16:54.731 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin - 302 0 null 22.8614ms
2025-10-24 11:16:54.740 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Account/AccessDenied?ReturnUrl=%2Fadmin - null null
2025-10-24 11:16:54.746 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.AccessDenied (BookStoreMVC)'
2025-10-24 11:16:54.749 +07:00 [INF] Route matched with {action = "AccessDenied", controller = "Account"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult AccessDenied() on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 11:16:54.761 +07:00 [INF] Executing ViewResult, running view AccessDenied.
2025-10-24 11:16:54.766 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:16:54.768 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:16:54.770 +07:00 [INF] Executed ViewResult - view AccessDenied executed in 16.2283ms.
2025-10-24 11:16:54.771 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.AccessDenied (BookStoreMVC) in 19.9093ms
2025-10-24 11:16:54.772 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.AccessDenied (BookStoreMVC)'
2025-10-24 11:16:54.773 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Account/AccessDenied?ReturnUrl=%2Fadmin - 200 null text/html; charset=utf-8 33.4268ms
2025-10-24 11:18:09.204 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/reviews/Create - application/x-www-form-urlencoded 324
2025-10-24 11:18:09.207 +07:00 [INF] CORS policy execution failed.
2025-10-24 11:18:09.207 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 11:18:09.208 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.ReviewsController.Create (BookStoreMVC)'
2025-10-24 11:18:09.209 +07:00 [INF] Route matched with {action = "Create", controller = "Reviews"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(BookStoreMVC.Models.ViewModels.ReviewCreateViewModel) on controller BookStoreMVC.Controllers.ReviewsController (BookStoreMVC).
2025-10-24 11:18:09.214 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 11:18:09.218 +07:00 [INF] Executing ViewResult, running view Create.
2025-10-24 11:18:09.220 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:18:09.222 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:18:09.223 +07:00 [INF] Executed ViewResult - view Create executed in 5.8915ms.
2025-10-24 11:18:09.224 +07:00 [INF] Executed action BookStoreMVC.Controllers.ReviewsController.Create (BookStoreMVC) in 13.6616ms
2025-10-24 11:18:09.225 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.ReviewsController.Create (BookStoreMVC)'
2025-10-24 11:18:09.226 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/reviews/Create - 200 null text/html; charset=utf-8 21.9739ms
2025-10-24 11:18:26.272 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/account/Logout - application/x-www-form-urlencoded 225
2025-10-24 11:18:26.275 +07:00 [INF] CORS policy execution failed.
2025-10-24 11:18:26.276 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 11:18:26.277 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC)'
2025-10-24 11:18:26.281 +07:00 [INF] Route matched with {action = "Logout", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 11:18:26.285 +07:00 [INF] AuthenticationScheme: Identity.Application signed out.
2025-10-24 11:18:26.286 +07:00 [INF] AuthenticationScheme: Identity.External signed out.
2025-10-24 11:18:26.286 +07:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2025-10-24 11:18:26.287 +07:00 [INF] User logged out.
2025-10-24 11:18:26.288 +07:00 [INF] Executing RedirectResult, redirecting to /.
2025-10-24 11:18:26.289 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC) in 7.0447ms
2025-10-24 11:18:26.290 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC)'
2025-10-24 11:18:26.290 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/account/Logout - 302 0 null 17.8228ms
2025-10-24 11:18:26.292 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 11:18:26.293 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 11:18:26.294 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 11:18:26.296 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:18:26.300 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:18:26.304 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 11:18:26.307 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:18:26.308 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 11:18:26.310 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 11:18:26.311 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 11:18:26.313 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 11:18:26.315 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 11:18:26.319 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 11:18:26.320 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 11:18:26.322 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 11:18:26.325 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:18:26.328 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:18:26.330 +07:00 [INF] Executed ViewResult - view Index executed in 7.9741ms.
2025-10-24 11:18:26.331 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 36.9952ms
2025-10-24 11:18:26.332 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 11:18:26.333 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 40.9198ms
2025-10-24 11:18:30.929 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/account/Login - null null
2025-10-24 11:18:30.931 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 11:18:30.933 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 11:18:30.936 +07:00 [INF] Executing ViewResult, running view Login.
2025-10-24 11:18:30.984 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:18:30.987 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:18:30.990 +07:00 [INF] Executed ViewResult - view Login executed in 54.4483ms.
2025-10-24 11:18:30.991 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 57.3735ms
2025-10-24 11:18:30.992 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 11:18:30.993 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/account/Login - 200 null text/html; charset=utf-8 64.2517ms
2025-10-24 11:18:31.004 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - null null
2025-10-24 11:18:31.004 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - null null
2025-10-24 11:18:31.006 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - 404 0 null 2.555ms
2025-10-24 11:18:31.007 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - 404 0 null 3.5691ms
2025-10-24 11:18:31.009 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/bookverse-core.js, Response status code: 404
2025-10-24 11:18:31.010 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/auth-validation.js, Response status code: 404
2025-10-24 11:18:39.426 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/account/Login - application/x-www-form-urlencoded 248
2025-10-24 11:18:39.428 +07:00 [INF] CORS policy execution failed.
2025-10-24 11:18:39.428 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-24 11:18:39.429 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 11:18:39.433 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BookStoreMVC.Models.ViewModels.LoginViewModel, System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-24 11:18:39.447 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-10-24 11:18:39.533 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2025-10-24 11:18:39.548 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-10-24 11:18:39.551 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-24 11:18:39.587 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2025-10-24 11:18:39.593 +07:00 [INF] AuthenticationScheme: Identity.Application signed in.
2025-10-24 11:18:39.595 +07:00 [INF] User logged in.
2025-10-24 11:18:39.597 +07:00 [INF] Executing RedirectResult, redirecting to /.
2025-10-24 11:18:39.602 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 166.4168ms
2025-10-24 11:18:39.603 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-24 11:18:39.605 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/account/Login - 302 0 null 178.6165ms
2025-10-24 11:18:39.608 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-24 11:18:39.610 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 11:18:39.610 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-24 11:18:39.612 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:18:39.615 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:18:39.618 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 11:18:39.622 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:18:39.624 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 11:18:39.625 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 11:18:39.627 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 11:18:39.628 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 11:18:39.630 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-24 11:18:39.632 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-24 11:18:39.633 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-24 11:18:39.635 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-24 11:18:39.638 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:18:39.641 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:18:39.643 +07:00 [INF] Executed ViewResult - view Index executed in 7.2364ms.
2025-10-24 11:18:39.643 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 32.0698ms
2025-10-24 11:18:39.644 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-24 11:18:39.645 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 36.047ms
2025-10-24 11:18:45.218 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/books/3 - null null
2025-10-24 11:18:45.221 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 11:18:45.221 +07:00 [INF] Route matched with {action = "Details", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32, System.String) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-24 11:18:45.224 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 11:18:45.228 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_2='?' (DbType = Int32), @__bookId_0='?' (DbType = Int32), @__book_CategoryId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId]
FROM (
    SELECT TOP(@__p_2) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[Id] <> @__bookId_0 AND [b].[CategoryId] = @__book_CategoryId_1
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r0] ON [b0].[Id] = [r0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id]
2025-10-24 11:18:45.232 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:18:45.234 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [OrderItems] AS [o]
        INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
        WHERE [o0].[UserId] = @__userId_0 AND [o].[BookId] = @__bookId_1 AND [o0].[Status] = 3) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:18:45.236 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:18:45.238 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [WishlistItems] AS [w]
        WHERE [w].[UserId] = @__userId_0 AND [w].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:18:45.239 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__bookId_1
2025-10-24 11:18:45.240 +07:00 [INF] Book 3 - AdditionalImages: null, GalleryCount: 0, HasGallery: false
2025-10-24 11:18:45.241 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-24 11:18:45.243 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:18:45.244 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:18:45.246 +07:00 [INF] Executed ViewResult - view Details executed in 5.0372ms.
2025-10-24 11:18:45.247 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC) in 24.1054ms
2025-10-24 11:18:45.247 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Details (BookStoreMVC)'
2025-10-24 11:18:45.249 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/books/3 - 200 null text/html; charset=utf-8 30.3181ms
2025-10-24 11:19:00.628 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/reviews/Create?bookId=3 - null null
2025-10-24 11:19:00.630 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.ReviewsController.Create (BookStoreMVC)'
2025-10-24 11:19:00.631 +07:00 [INF] Route matched with {action = "Create", controller = "Reviews"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Create(Int32) on controller BookStoreMVC.Controllers.ReviewsController (BookStoreMVC).
2025-10-24 11:19:00.634 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__bookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Reviews] AS [r]
        WHERE [r].[UserId] = @__userId_0 AND [r].[BookId] = @__bookId_1) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-10-24 11:19:00.636 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-24 11:19:00.639 +07:00 [INF] Executing ViewResult, running view Create.
2025-10-24 11:19:00.642 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:19:00.644 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-24 11:19:00.645 +07:00 [INF] Executed ViewResult - view Create executed in 6.094ms.
2025-10-24 11:19:00.647 +07:00 [INF] Executed action BookStoreMVC.Controllers.ReviewsController.Create (BookStoreMVC) in 14.2867ms
2025-10-24 11:19:00.648 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.ReviewsController.Create (BookStoreMVC)'
2025-10-24 11:19:00.648 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/reviews/Create?bookId=3 - 200 null text/html; charset=utf-8 20.8292ms
2025-10-24 11:19:12.903 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin - null null
2025-10-24 11:19:12.910 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.Dashboard (BookStoreMVC)'
2025-10-24 11:19:12.919 +07:00 [INF] Route matched with {action = "Dashboard", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Dashboard() on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-24 11:19:12.931 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 11:19:12.938 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-24 11:19:12.951 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-10-24 11:19:12.956 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
2025-10-24 11:19:12.957 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 11:19:12.962 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[Status] = 0
2025-10-24 11:19:12.966 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] <= 10
2025-10-24 11:19:12.970 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(0 AS bit)
2025-10-24 11:19:12.982 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[UserId], [o0].[Status], [o0].[Total], [o0].[CreatedAt], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM (
    SELECT TOP(@__p_0) [o].[Id], [o].[CreatedAt], [o].[Status], [o].[Total], [o].[UserId]
    FROM [Orders] AS [o]
    ORDER BY [o].[CreatedAt] DESC
) AS [o0]
INNER JOIN [AspNetUsers] AS [a] ON [o0].[UserId] = [a].[Id]
ORDER BY [o0].[CreatedAt] DESC
2025-10-24 11:19:12.994 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[Rating], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM (
    SELECT TOP(@__p_0) [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    ORDER BY [r].[CreatedAt] DESC
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 11:19:13.001 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
ORDER BY [a].[CreatedAt] DESC
2025-10-24 11:19:13.004 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-24 11:19:13.011 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[Title], [b0].[Author], [b0].[StockQuantity], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[Author], [b].[CategoryId], [b].[StockQuantity], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] <= 10
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
2025-10-24 11:19:13.030 +07:00 [ERR] Error getting monthly revenue
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => (int)o.Status == 3 && o.CreatedAt >= __startDate_0)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month
     })
    .Select(g => new { 
        Date = new DateTime(
            g.Key.Year, 
            g.Key.Month, 
            1
        ), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total)
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at BookStoreMVC.Services.OrderService.GetMonthlyRevenueAsync(Int32 months) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Services\OrderService.cs:line 311
2025-10-24 11:19:13.062 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
ORDER BY [o].[Status]
2025-10-24 11:19:13.085 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Name], (
    SELECT COUNT(*)
    FROM [Books] AS [b]
    WHERE [c].[Id] = [b].[CategoryId] AND [b].[IsActive] = CAST(1 AS bit)) AS [Count]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
2025-10-24 11:19:13.094 +07:00 [ERR] Error getting user registrations
System.InvalidOperationException: The LINQ expression 'DbSet<User>()
    .Where(u => u.CreatedAt >= __startDate_0)
    .GroupBy(u => new { 
        Year = u.CreatedAt.Year, 
        Month = u.CreatedAt.Month
     })
    .Select(g => new { 
        Date = new DateTime(
            g.Key.Year, 
            g.Key.Month, 
            1
        ), 
        Count = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at BookStoreMVC.Services.UserService.GetUserRegistrationsAsync(Int32 months) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Services\UserService.cs:line 202
2025-10-24 11:19:13.104 +07:00 [INF] Executing ViewResult, running view Dashboard.
2025-10-24 11:19:13.148 +07:00 [INF] Executed ViewResult - view Dashboard executed in 43.9136ms.
2025-10-24 11:19:13.150 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.Dashboard (BookStoreMVC) in 230.2079ms
2025-10-24 11:19:13.151 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.Dashboard (BookStoreMVC)'
2025-10-24 11:19:13.152 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin - 200 null text/html; charset=utf-8 249.1619ms
2025-10-24 11:19:13.164 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/admin.js?v=zlE_1g2uPXi4gKuQMdTqq6d7eO2vOH8vl_YJKJBSo-w - null null
2025-10-24 11:19:13.167 +07:00 [INF] The file /js/admin.js was not modified
2025-10-24 11:19:13.168 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/admin.js?v=zlE_1g2uPXi4gKuQMdTqq6d7eO2vOH8vl_YJKJBSo-w - 304 null text/javascript 3.9848ms
2025-10-24 11:19:13.582 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin/dashboard/stats - null null
2025-10-24 11:19:13.586 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.GetDashboardStats (BookStoreMVC)'
2025-10-24 11:19:13.590 +07:00 [INF] Route matched with {action = "GetDashboardStats", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetDashboardStats() on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-24 11:19:13.595 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-24 11:19:13.598 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-24 11:19:13.599 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-10-24 11:19:13.607 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-24 11:19:13.610 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
ORDER BY [o].[Status]
2025-10-24 11:19:13.613 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] <= 10
2025-10-24 11:19:13.616 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
2025-10-24 11:19:13.618 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(0 AS bit)
2025-10-24 11:19:13.626 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT AVG(CAST([r].[Rating] AS float))
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 11:19:13.630 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-24 11:19:13.641 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.GetDashboardStats (BookStoreMVC) in 49.9423ms
2025-10-24 11:19:13.642 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.GetDashboardStats (BookStoreMVC)'
2025-10-24 11:19:13.643 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin/dashboard/stats - 200 null application/json; charset=utf-8 60.8725ms
2025-10-24 11:19:16.539 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin/reviews - null null
2025-10-24 11:19:16.543 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.Reviews (BookStoreMVC)'
2025-10-24 11:19:16.548 +07:00 [INF] Route matched with {action = "Reviews", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Reviews(BookStoreMVC.Models.ViewModels.ReviewListViewModel) on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-24 11:19:16.559 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-24 11:19:16.561 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-24 11:19:16.564 +07:00 [INF] Executing ViewResult, running view Reviews.
2025-10-24 11:19:16.576 +07:00 [INF] Executed ViewResult - view Reviews executed in 12.578ms.
2025-10-24 11:19:16.578 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.Reviews (BookStoreMVC) in 28.9699ms
2025-10-24 11:19:16.579 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.Reviews (BookStoreMVC)'
2025-10-24 11:19:16.580 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin/reviews - 200 null text/html; charset=utf-8 40.7846ms
