2025-10-23 10:17:00.028 +07:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-23 10:17:03.013 +07:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-23 10:17:03.041 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-23 10:17:03.107 +07:00 [INF] Executed DbCommand (56ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-23 10:17:03.240 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-23 10:17:03.271 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-23 10:17:03.275 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-23 10:17:03.289 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-23 10:17:03.311 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-10-23 10:17:03.321 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-23 10:17:03.763 +07:00 [INF] Executed DbCommand (20ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-23 10:17:03.844 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-23 10:17:03.873 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-10-23 10:17:03.948 +07:00 [INF] ✅ Database initialized with admin user only.
2025-10-23 10:17:03.954 +07:00 [INF] Database initialized successfully
2025-10-23 10:17:04.095 +07:00 [INF] ==========================================
2025-10-23 10:17:04.096 +07:00 [INF] BookStore Application Starting...
2025-10-23 10:17:04.097 +07:00 [INF] Environment: Production
2025-10-23 10:17:04.097 +07:00 [INF] Session Timeout: 7 days
2025-10-23 10:17:04.098 +07:00 [INF] Guest Cart: Enabled
2025-10-23 10:17:04.099 +07:00 [INF] ==========================================
2025-10-23 10:17:04.215 +07:00 [INF] Now listening on: http://localhost:5000
2025-10-23 10:17:04.217 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-23 10:17:04.218 +07:00 [INF] Hosting environment: Production
2025-10-23 10:17:04.219 +07:00 [INF] Content root path: C:\Users\DELL\Desktop\Bán sách\BookStoreMWC
2025-10-23 10:17:05.724 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-23 10:17:05.729 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-23 10:17:05.775 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 10:17:05.788 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-23 10:17:05.919 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-23 10:17:06.000 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-23 10:17:06.016 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-23 10:17:06.040 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 10:17:06.056 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-23 10:17:06.067 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 10:17:06.078 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 10:17:06.088 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 10:17:06.113 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 10:17:06.126 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-23 10:17:06.148 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-23 10:17:06.170 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-23 10:17:06.181 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-23 10:17:06.204 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 10:17:06.243 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 10:17:06.411 +07:00 [INF] Executed ViewResult - view Index executed in 168.0876ms.
2025-10-23 10:17:06.415 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/dbd2cb5e-32df-4c33-bd7f-2417990da4fe.jpg - null null
2025-10-23 10:17:06.415 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/b1a75ff2-9e12-4c9f-894a-55e7ed1e8705.jpg - null null
2025-10-23 10:17:06.417 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 624.8616ms
2025-10-23 10:17:06.415 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/css/output.css?v=YR0oZDuEY6GJkDXELbFPrMV0WcQ3SauY9qTKxDcI2S4 - null null
2025-10-23 10:17:06.418 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/eefdd8ed-2cc9-4b0f-b905-135e6dfdeea0.jpg - null null
2025-10-23 10:17:06.418 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/1dffb230-5d94-42ba-b309-29b1cd631e49.jpg - null null
2025-10-23 10:17:06.425 +07:00 [INF] The file /images/books/eefdd8ed-2cc9-4b0f-b905-135e6dfdeea0.jpg was not modified
2025-10-23 10:17:06.425 +07:00 [INF] The file /images/books/dbd2cb5e-32df-4c33-bd7f-2417990da4fe.jpg was not modified
2025-10-23 10:17:06.425 +07:00 [INF] The file /images/books/b1a75ff2-9e12-4c9f-894a-55e7ed1e8705.jpg was not modified
2025-10-23 10:17:06.425 +07:00 [INF] The file /css/output.css was not modified
2025-10-23 10:17:06.421 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 10:17:06.426 +07:00 [INF] The file /images/books/1dffb230-5d94-42ba-b309-29b1cd631e49.jpg was not modified
2025-10-23 10:17:06.427 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/eefdd8ed-2cc9-4b0f-b905-135e6dfdeea0.jpg - 304 null image/jpeg 9.2397ms
2025-10-23 10:17:06.428 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/dbd2cb5e-32df-4c33-bd7f-2417990da4fe.jpg - 304 null image/jpeg 12.1523ms
2025-10-23 10:17:06.428 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/b1a75ff2-9e12-4c9f-894a-55e7ed1e8705.jpg - 304 null image/jpeg 12.6263ms
2025-10-23 10:17:06.429 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/css/output.css?v=YR0oZDuEY6GJkDXELbFPrMV0WcQ3SauY9qTKxDcI2S4 - 304 null text/css 13.2574ms
2025-10-23 10:17:06.430 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/1dffb230-5d94-42ba-b309-29b1cd631e49.jpg - 304 null image/jpeg 12.5055ms
2025-10-23 10:17:06.432 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/site.js?v=psVHgii7ebM3Pd--mSAvznkun8unGUnQu4liF0OjUJQ - null null
2025-10-23 10:17:06.435 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/36101025-d6e9-43af-aabb-0f019b95f491.jpg - null null
2025-10-23 10:17:06.436 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 714.3201ms
2025-10-23 10:17:06.436 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/b5dff926-3649-4741-8420-7636176bc756.jpg - null null
2025-10-23 10:17:06.438 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/9275c308-a4f2-4fd2-8f13-6b7ac3bf7d9d.jpg - null null
2025-10-23 10:17:06.439 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/bookcard-functions.js - null null
2025-10-23 10:17:06.440 +07:00 [INF] The file /js/site.js was not modified
2025-10-23 10:17:06.441 +07:00 [INF] The file /images/books/36101025-d6e9-43af-aabb-0f019b95f491.jpg was not modified
2025-10-23 10:17:06.443 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/dac6c957-62fb-46ef-b300-884af0158381.jpg - null null
2025-10-23 10:17:06.443 +07:00 [INF] The file /images/books/b5dff926-3649-4741-8420-7636176bc756.jpg was not modified
2025-10-23 10:17:06.444 +07:00 [INF] The file /images/books/9275c308-a4f2-4fd2-8f13-6b7ac3bf7d9d.jpg was not modified
2025-10-23 10:17:06.445 +07:00 [INF] The file /js/bookcard-functions.js was not modified
2025-10-23 10:17:06.446 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/site.js?v=psVHgii7ebM3Pd--mSAvznkun8unGUnQu4liF0OjUJQ - 304 null text/javascript 13.4723ms
2025-10-23 10:17:06.447 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/36101025-d6e9-43af-aabb-0f019b95f491.jpg - 304 null image/jpeg 11.5719ms
2025-10-23 10:17:06.448 +07:00 [INF] The file /images/books/dac6c957-62fb-46ef-b300-884af0158381.jpg was not modified
2025-10-23 10:17:06.449 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/b5dff926-3649-4741-8420-7636176bc756.jpg - 304 null image/jpeg 12.7235ms
2025-10-23 10:17:06.450 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/9275c308-a4f2-4fd2-8f13-6b7ac3bf7d9d.jpg - 304 null image/jpeg 12.1881ms
2025-10-23 10:17:06.451 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/bookcard-functions.js - 304 null text/javascript 11.8303ms
2025-10-23 10:17:06.453 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/d534764c-5457-4896-9eb8-c702984cddf3.jpg - null null
2025-10-23 10:17:06.456 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/9f20215f-3d1a-4335-8ca4-7fb121e06fb4.jpg - null null
2025-10-23 10:17:06.456 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/dac6c957-62fb-46ef-b300-884af0158381.jpg - 304 null image/jpeg 13.5938ms
2025-10-23 10:17:06.459 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/35478bcd-cfa8-421f-b420-f2138bf136ca.jpg - null null
2025-10-23 10:17:06.460 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/b39e2295-0bed-485e-84cd-8588dc55b15e.jpg - null null
2025-10-23 10:17:06.462 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/80723886-f28d-411f-a542-f343e54d8b0e.jpg - null null
2025-10-23 10:17:06.463 +07:00 [INF] The file /images/books/d534764c-5457-4896-9eb8-c702984cddf3.jpg was not modified
2025-10-23 10:17:06.465 +07:00 [INF] The file /images/books/9f20215f-3d1a-4335-8ca4-7fb121e06fb4.jpg was not modified
2025-10-23 10:17:06.467 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/52a8425c-7588-4e65-b5e4-31c3aeffa163.jpg - null null
2025-10-23 10:17:06.469 +07:00 [INF] The file /images/books/35478bcd-cfa8-421f-b420-f2138bf136ca.jpg was not modified
2025-10-23 10:17:06.470 +07:00 [INF] The file /images/books/b39e2295-0bed-485e-84cd-8588dc55b15e.jpg was not modified
2025-10-23 10:17:06.471 +07:00 [INF] The file /images/books/80723886-f28d-411f-a542-f343e54d8b0e.jpg was not modified
2025-10-23 10:17:06.471 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/d534764c-5457-4896-9eb8-c702984cddf3.jpg - 304 null image/jpeg 17.9678ms
2025-10-23 10:17:06.472 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/9f20215f-3d1a-4335-8ca4-7fb121e06fb4.jpg - 304 null image/jpeg 16.4696ms
2025-10-23 10:17:06.474 +07:00 [INF] The file /images/books/52a8425c-7588-4e65-b5e4-31c3aeffa163.jpg was not modified
2025-10-23 10:17:06.474 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/35478bcd-cfa8-421f-b420-f2138bf136ca.jpg - 304 null image/jpeg 15.4268ms
2025-10-23 10:17:06.475 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/b39e2295-0bed-485e-84cd-8588dc55b15e.jpg - 304 null image/jpeg 14.681ms
2025-10-23 10:17:06.475 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/80723886-f28d-411f-a542-f343e54d8b0e.jpg - 304 null image/jpeg 13.78ms
2025-10-23 10:17:06.477 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/c7d19101-83c7-4513-b1e9-70b6cba587ec.jpg - null null
2025-10-23 10:17:06.478 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/2b7307ad-b949-4cff-9c9c-4e33efdc28d7.jpg - null null
2025-10-23 10:17:06.479 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/52a8425c-7588-4e65-b5e4-31c3aeffa163.jpg - 304 null image/jpeg 12.0412ms
2025-10-23 10:17:06.486 +07:00 [INF] The file /images/books/c7d19101-83c7-4513-b1e9-70b6cba587ec.jpg was not modified
2025-10-23 10:17:06.487 +07:00 [INF] The file /images/books/2b7307ad-b949-4cff-9c9c-4e33efdc28d7.jpg was not modified
2025-10-23 10:17:06.489 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/c7d19101-83c7-4513-b1e9-70b6cba587ec.jpg - 304 null image/jpeg 11.3542ms
2025-10-23 10:17:06.489 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/2b7307ad-b949-4cff-9c9c-4e33efdc28d7.jpg - 304 null image/jpeg 10.6478ms
2025-10-23 10:17:16.972 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Books?sortBy=featured - null null
2025-10-23 10:17:16.980 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.BooksController.Index (BookStoreMVC)'
2025-10-23 10:17:17.007 +07:00 [INF] Route matched with {action = "Index", controller = "Books"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index(BookStoreMVC.Models.ViewModels.BookListViewModel) on controller BookStoreMVC.Controllers.BooksController (BookStoreMVC).
2025-10-23 10:17:17.068 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-23 10:17:17.077 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-23 10:17:17.100 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r]
            WHERE [b].[Id] = [r].[BookId]) THEN (
            SELECT AVG(CAST([r0].[Rating] AS float))
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId])
        ELSE 0.0E0
    END AS [c], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r1]
        WHERE [b].[Id] = [r1].[BookId]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit)
    ORDER BY CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r]
            WHERE [b].[Id] = [r].[BookId]) THEN (
            SELECT AVG(CAST([r0].[Rating] AS float))
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId])
        ELSE 0.0E0
    END DESC, (
        SELECT COUNT(*)
        FROM [Reviews] AS [r1]
        WHERE [b].[Id] = [r1].[BookId]) DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id], [r2].[Id]
2025-10-23 10:17:17.109 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-23 10:17:17.113 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 10:17:17.134 +07:00 [INF] Executed ViewResult - view Index executed in 20.9958ms.
2025-10-23 10:17:17.137 +07:00 [INF] Executed action BookStoreMVC.Controllers.BooksController.Index (BookStoreMVC) in 127.1284ms
2025-10-23 10:17:17.138 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.BooksController.Index (BookStoreMVC)'
2025-10-23 10:17:17.140 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Books?sortBy=featured - 200 null text/html; charset=utf-8 168.4433ms
2025-10-23 10:17:17.170 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/b8bf2e13-af0a-45a7-8208-df7829df3a62.jpg - null null
2025-10-23 10:17:17.170 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/11781612-2fec-473f-8749-70cf9dc35539.jpg - null null
2025-10-23 10:17:17.170 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/dbd4fe4c-f1a1-4aa0-abf6-1e6c9dc7b8a1.jpg - null null
2025-10-23 10:17:17.170 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/books/76d46b94-1260-425d-a282-e49e11b01475.jpg - null null
2025-10-23 10:17:17.172 +07:00 [INF] The file /images/books/b8bf2e13-af0a-45a7-8208-df7829df3a62.jpg was not modified
2025-10-23 10:17:17.173 +07:00 [INF] The file /images/books/11781612-2fec-473f-8749-70cf9dc35539.jpg was not modified
2025-10-23 10:17:17.174 +07:00 [INF] The file /images/books/dbd4fe4c-f1a1-4aa0-abf6-1e6c9dc7b8a1.jpg was not modified
2025-10-23 10:17:17.175 +07:00 [INF] The file /images/books/76d46b94-1260-425d-a282-e49e11b01475.jpg was not modified
2025-10-23 10:17:17.175 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/b8bf2e13-af0a-45a7-8208-df7829df3a62.jpg - 304 null image/jpeg 5.8171ms
2025-10-23 10:17:17.176 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/11781612-2fec-473f-8749-70cf9dc35539.jpg - 304 null image/jpeg 6.243ms
2025-10-23 10:17:17.178 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/dbd4fe4c-f1a1-4aa0-abf6-1e6c9dc7b8a1.jpg - 304 null image/jpeg 8.6291ms
2025-10-23 10:17:17.179 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/books/76d46b94-1260-425d-a282-e49e11b01475.jpg - 304 null image/jpeg 9.3668ms
2025-10-23 10:17:32.634 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - application/json 25
2025-10-23 10:17:32.638 +07:00 [INF] CORS policy execution failed.
2025-10-23 10:17:32.639 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 10:17:32.643 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-23 10:17:32.649 +07:00 [INF] Route matched with {action = "AddToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddToCart(BookStoreMVC.Models.ViewModels.AddToCartViewModel) on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-23 10:17:32.670 +07:00 [INF] AddToCart request - BookId: 3, Quantity: 1
2025-10-23 10:17:32.682 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-23 10:17:32.685 +07:00 [INF] SessionCart - AddToCart: BookId 3, Quantity 1
2025-10-23 10:17:32.694 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-23 10:17:32.719 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AdditionalImages], [s].[Author], [s].[CategoryId], [s].[CreatedAt], [s].[Description], [s].[DiscountPrice], [s].[ImageContentType], [s].[ImageFileName], [s].[ImageFileSize], [s].[ImageUrl], [s].[IsActive], [s].[Language], [s].[PageCount], [s].[Price], [s].[PublishDate], [s].[Publisher], [s].[StockQuantity], [s].[Title], [s].[UpdatedAt], [s].[Id0], [s].[CreatedAt0], [s].[Description0], [s].[ImageUrl0], [s].[IsActive0], [s].[Name], [s].[ParentCategoryId], [s0].[Id], [s0].[BookId], [s0].[Comment], [s0].[CreatedAt], [s0].[IsApproved], [s0].[IsVerifiedPurchase], [s0].[Rating], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [b0].[Id], [b0].[BookId], [b0].[CreatedAt], [b0].[DisplayOrder], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[UpdatedAt]
FROM (
    SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id0], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [Books] AS [b]
    INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
    WHERE [b].[Id] = @__id_0 AND [b].[IsActive] = CAST(1 AS bit)
) AS [s]
LEFT JOIN (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
    FROM [Reviews] AS [r]
    INNER JOIN [AspNetUsers] AS [a] ON [r].[UserId] = [a].[Id]
) AS [s0] ON [s].[Id] = [s0].[BookId]
LEFT JOIN [BookGalleryImages] AS [b0] ON [s].[Id] = [b0].[BookId]
ORDER BY [s].[Id], [s].[Id0], [s0].[Id], [s0].[Id0]
2025-10-23 10:17:32.729 +07:00 [INF] Added new item with quantity: 1
2025-10-23 10:17:32.774 +07:00 [ERR] Error saving cart to session
System.Text.Json.JsonException: A possible object cycle was detected. This can either be due to a cycle or if the object depth is larger than the maximum allowed depth of 64. Consider using ReferenceHandler.Preserve on JsonSerializerOptions to support cycles. Path: $.Items.Book.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Id.
   at System.Text.Json.ThrowHelper.ThrowJsonException_SerializerCycleDetected(Int32 maxDepth)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.WriteCore(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonTypeInfo`1.Serialize(Utf8JsonWriter writer, T& rootValue, Object rootValueBoxed)
   at System.Text.Json.JsonSerializer.WriteString[TValue](TValue& value, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Serialize[TValue](TValue value, JsonSerializerOptions options)
   at BookStoreMVC.Services.SessionCartService.SaveCart(CartViewModel cart) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Services\SessionCartService.cs:line 257
2025-10-23 10:17:32.819 +07:00 [ERR] Error adding to session cart
System.Text.Json.JsonException: A possible object cycle was detected. This can either be due to a cycle or if the object depth is larger than the maximum allowed depth of 64. Consider using ReferenceHandler.Preserve on JsonSerializerOptions to support cycles. Path: $.Items.Book.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Id.
   at System.Text.Json.ThrowHelper.ThrowJsonException_SerializerCycleDetected(Int32 maxDepth)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.WriteCore(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonTypeInfo`1.Serialize(Utf8JsonWriter writer, T& rootValue, Object rootValueBoxed)
   at System.Text.Json.JsonSerializer.WriteString[TValue](TValue& value, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Serialize[TValue](TValue value, JsonSerializerOptions options)
   at BookStoreMVC.Services.SessionCartService.SaveCart(CartViewModel cart) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Services\SessionCartService.cs:line 257
   at BookStoreMVC.Services.SessionCartService.AddToCart(Int32 bookId, Int32 quantity) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Services\SessionCartService.cs:line 148
2025-10-23 10:17:32.847 +07:00 [ERR] Unexpected error in AddToCart
System.Text.Json.JsonException: A possible object cycle was detected. This can either be due to a cycle or if the object depth is larger than the maximum allowed depth of 64. Consider using ReferenceHandler.Preserve on JsonSerializerOptions to support cycles. Path: $.Items.Book.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Category.Books.Id.
   at System.Text.Json.ThrowHelper.ThrowJsonException_SerializerCycleDetected(Int32 maxDepth)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Converters.IEnumerableDefaultConverter`2.OnWriteResume(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonCollectionConverter`2.OnTryWrite(Utf8JsonWriter writer, TCollection value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonPropertyInfo`1.GetMemberAndWriteJson(Object obj, WriteStack& state, Utf8JsonWriter writer)
   at System.Text.Json.Serialization.Converters.ObjectDefaultConverter`1.OnTryWrite(Utf8JsonWriter writer, T value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.TryWrite(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.JsonConverter`1.WriteCore(Utf8JsonWriter writer, T& value, JsonSerializerOptions options, WriteStack& state)
   at System.Text.Json.Serialization.Metadata.JsonTypeInfo`1.Serialize(Utf8JsonWriter writer, T& rootValue, Object rootValueBoxed)
   at System.Text.Json.JsonSerializer.WriteString[TValue](TValue& value, JsonTypeInfo`1 jsonTypeInfo)
   at System.Text.Json.JsonSerializer.Serialize[TValue](TValue value, JsonSerializerOptions options)
   at BookStoreMVC.Services.SessionCartService.SaveCart(CartViewModel cart) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Services\SessionCartService.cs:line 257
   at BookStoreMVC.Services.SessionCartService.AddToCart(Int32 bookId, Int32 quantity) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Services\SessionCartService.cs:line 148
   at BookStoreMVC.Controllers.CartController.AddToCart(AddToCartViewModel model) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Controllers\CartController.cs:line 193
2025-10-23 10:17:32.877 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType2`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-23 10:17:32.883 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC) in 232.7808ms
2025-10-23 10:17:32.884 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-23 10:17:32.884 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - 200 null application/json; charset=utf-8 250.544ms
2025-10-23 10:17:35.591 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/account/Login - null null
2025-10-23 10:17:35.594 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-23 10:17:35.596 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-23 10:17:35.602 +07:00 [INF] Executing ViewResult, running view Login.
2025-10-23 10:17:35.649 +07:00 [INF] Executed ViewResult - view Login executed in 47.7369ms.
2025-10-23 10:17:35.651 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 52.8045ms
2025-10-23 10:17:35.652 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-23 10:17:35.652 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/account/Login - 200 null text/html; charset=utf-8 61.5395ms
2025-10-23 10:17:35.804 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - null null
2025-10-23 10:17:35.804 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - null null
2025-10-23 10:17:35.804 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/css/output.css - null null
2025-10-23 10:17:35.804 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/login.js?v=5_yFtJP0kybVWGRgPOeI8tFeD4mu70Hwg3BRWviBUds - null null
2025-10-23 10:17:35.806 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - 404 0 null 2.6655ms
2025-10-23 10:17:35.808 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - 404 0 null 4.0685ms
2025-10-23 10:17:35.808 +07:00 [INF] The file /css/output.css was not modified
2025-10-23 10:17:35.809 +07:00 [INF] The file /js/login.js was not modified
2025-10-23 10:17:35.811 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/auth-validation.js, Response status code: 404
2025-10-23 10:17:35.812 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/bookverse-core.js, Response status code: 404
2025-10-23 10:17:35.813 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/css/output.css - 304 null text/css 8.8938ms
2025-10-23 10:17:35.813 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/login.js?v=5_yFtJP0kybVWGRgPOeI8tFeD4mu70Hwg3BRWviBUds - 304 null text/javascript 9.2466ms
2025-10-23 10:17:49.043 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/account/Login - application/x-www-form-urlencoded 248
2025-10-23 10:17:49.047 +07:00 [INF] CORS policy execution failed.
2025-10-23 10:17:49.047 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 10:17:49.049 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-23 10:17:49.053 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BookStoreMVC.Models.ViewModels.LoginViewModel, System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-23 10:17:49.071 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-10-23 10:17:49.159 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2025-10-23 10:17:49.177 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-10-23 10:17:49.183 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-23 10:17:49.191 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2025-10-23 10:17:49.194 +07:00 [INF] AuthenticationScheme: Identity.Application signed in.
2025-10-23 10:17:49.197 +07:00 [INF] User logged in.
2025-10-23 10:17:49.198 +07:00 [INF] Executing RedirectResult, redirecting to /.
2025-10-23 10:17:49.200 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 145.3483ms
2025-10-23 10:17:49.200 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-23 10:17:49.201 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/account/Login - 302 0 null 158.7157ms
2025-10-23 10:17:49.203 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-23 10:17:49.206 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 10:17:49.207 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-23 10:17:49.210 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-23 10:17:49.216 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-23 10:17:49.219 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 10:17:49.222 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-23 10:17:49.223 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 10:17:49.225 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 10:17:49.226 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 10:17:49.228 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 10:17:49.232 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-23 10:17:49.235 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-23 10:17:49.237 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 10:17:49.239 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 10:17:49.243 +07:00 [INF] Executed ViewResult - view Index executed in 4.407ms.
2025-10-23 10:17:49.244 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 36.5131ms
2025-10-23 10:17:49.246 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 10:17:49.247 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 43.8546ms
2025-10-23 10:17:52.229 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - application/json 25
2025-10-23 10:17:52.235 +07:00 [INF] CORS policy execution failed.
2025-10-23 10:17:52.235 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 10:17:52.237 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-23 10:17:52.238 +07:00 [INF] Route matched with {action = "AddToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddToCart(BookStoreMVC.Models.ViewModels.AddToCartViewModel) on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-23 10:17:52.239 +07:00 [INF] AddToCart request - BookId: 3, Quantity: 1
2025-10-23 10:17:52.271 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-23 10:17:52.279 +07:00 [INF] === ADD TO CART START ===
2025-10-23 10:17:52.280 +07:00 [INF] UserId: 37a6e596-ce7b-4304-9a4f-b8e0dc9abb95, BookId: 3, Quantity: 1
2025-10-23 10:17:52.281 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-23 10:17:52.282 +07:00 [INF] Book Found - Title: Đi Cho Dã Để Một Đời Không Uổng, Stock: 150, IsActive: true
2025-10-23 10:17:52.289 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450), @__model_BookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__model_BookId_1
2025-10-23 10:17:52.290 +07:00 [INF] Cart Status - Current: 0, Adding: 1, New Total: 1
2025-10-23 10:17:52.290 +07:00 [INF] Creating new cart item with quantity 1
2025-10-23 10:17:52.356 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-23 10:17:52.364 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CartItems] ([BookId], [CreatedAt], [Quantity], [UpdatedAt], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-10-23 10:17:52.383 +07:00 [INF] === ADD TO CART SUCCESS ===
2025-10-23 10:17:52.389 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([c].[Quantity]), 0)
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0
2025-10-23 10:17:52.390 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType20`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-23 10:17:52.394 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC) in 155.0996ms
2025-10-23 10:17:52.395 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-23 10:17:52.396 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - 200 null application/json; charset=utf-8 167.8135ms
2025-10-23 10:17:55.144 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/cart - null null
2025-10-23 10:17:55.151 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-23 10:17:55.154 +07:00 [INF] Route matched with {action = "Index", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-23 10:17:55.177 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[Id], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [CartItems] AS [c]
LEFT JOIN [Books] AS [b] ON [c].[BookId] = [b].[Id]
LEFT JOIN [Categories] AS [c0] ON [b].[CategoryId] = [c0].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [c].[UserId] = @__userId_0
ORDER BY [c].[CreatedAt], [c].[Id], [b].[Id], [c0].[Id]
2025-10-23 10:17:55.183 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 10:17:55.191 +07:00 [INF] Executed ViewResult - view Index executed in 9.0006ms.
2025-10-23 10:17:55.193 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.Index (BookStoreMVC) in 37.7021ms
2025-10-23 10:17:55.194 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-23 10:17:55.195 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/cart - 200 null text/html; charset=utf-8 51.1903ms
2025-10-23 10:17:58.775 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Orders/Checkout - null null
2025-10-23 10:17:58.781 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 10:17:58.784 +07:00 [INF] Route matched with {action = "Checkout", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout() on controller BookStoreMVC.Controllers.OrdersController (BookStoreMVC).
2025-10-23 10:17:58.787 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[Id], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [CartItems] AS [c]
LEFT JOIN [Books] AS [b] ON [c].[BookId] = [b].[Id]
LEFT JOIN [Categories] AS [c0] ON [b].[CategoryId] = [c0].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [c].[UserId] = @__userId_0
ORDER BY [c].[CreatedAt], [c].[Id], [b].[Id], [c0].[Id]
2025-10-23 10:17:58.803 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-10-23 10:17:58.809 +07:00 [INF] Executing ViewResult, running view Checkout.
2025-10-23 10:17:58.831 +07:00 [INF] Executed ViewResult - view Checkout executed in 22.8924ms.
2025-10-23 10:17:58.834 +07:00 [INF] Executed action BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC) in 49.5445ms
2025-10-23 10:17:58.835 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 10:17:58.836 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Orders/Checkout - 200 null text/html; charset=utf-8 60.8402ms
2025-10-23 10:17:58.845 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/momo-logo.png - null null
2025-10-23 10:17:58.847 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/momo-logo.png - 404 0 null 1.8482ms
2025-10-23 10:17:58.847 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/viettelpay-logo.png - null null
2025-10-23 10:17:58.847 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/zalopay-logo.png - null null
2025-10-23 10:17:58.848 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/momo-logo.png, Response status code: 404
2025-10-23 10:17:58.851 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/viettelpay-logo.png - 404 0 null 3.2608ms
2025-10-23 10:17:58.852 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/zalopay-logo.png - 404 0 null 4.2963ms
2025-10-23 10:17:58.852 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/shopeepay-logo.png - null null
2025-10-23 10:17:58.854 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/viettelpay-logo.png, Response status code: 404
2025-10-23 10:17:58.855 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/zalopay-logo.png, Response status code: 404
2025-10-23 10:17:58.858 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/shopeepay-logo.png - 404 0 null 5.652ms
2025-10-23 10:17:58.861 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/shopeepay-logo.png, Response status code: 404
2025-10-23 10:18:38.486 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Orders/Checkout - multipart/form-data; boundary=----WebKitFormBoundaryTUBZqx8yBD2WNPrL 1212
2025-10-23 10:18:38.494 +07:00 [INF] CORS policy execution failed.
2025-10-23 10:18:38.495 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 10:18:38.497 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 10:18:38.500 +07:00 [INF] Route matched with {action = "Checkout", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(BookStoreMVC.Models.ViewModels.OrderCreateViewModel) on controller BookStoreMVC.Controllers.OrdersController (BookStoreMVC).
2025-10-23 10:18:38.514 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[Id], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [CartItems] AS [c]
LEFT JOIN [Books] AS [b] ON [c].[BookId] = [b].[Id]
LEFT JOIN [Categories] AS [c0] ON [b].[CategoryId] = [c0].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [c].[UserId] = @__userId_0
ORDER BY [c].[CreatedAt], [c].[Id], [b].[Id], [c0].[Id]
2025-10-23 10:18:38.519 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType32`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.IEnumerable`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-23 10:18:38.523 +07:00 [INF] Executed action BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC) in 22.0116ms
2025-10-23 10:18:38.524 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 10:18:38.525 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Orders/Checkout - 400 null application/json; charset=utf-8 39.2008ms
2025-10-23 10:18:46.070 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Orders/Checkout - multipart/form-data; boundary=----WebKitFormBoundary7xh2tMCQGnnutSJp 1212
2025-10-23 10:18:46.074 +07:00 [INF] CORS policy execution failed.
2025-10-23 10:18:46.075 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 10:18:46.076 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 10:18:46.076 +07:00 [INF] Route matched with {action = "Checkout", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(BookStoreMVC.Models.ViewModels.OrderCreateViewModel) on controller BookStoreMVC.Controllers.OrdersController (BookStoreMVC).
2025-10-23 10:18:46.080 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[Id], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [CartItems] AS [c]
LEFT JOIN [Books] AS [b] ON [c].[BookId] = [b].[Id]
LEFT JOIN [Categories] AS [c0] ON [b].[CategoryId] = [c0].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [c].[UserId] = @__userId_0
ORDER BY [c].[CreatedAt], [c].[Id], [b].[Id], [c0].[Id]
2025-10-23 10:18:46.083 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType32`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.IEnumerable`1[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-23 10:18:46.084 +07:00 [INF] Executed action BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC) in 6.7794ms
2025-10-23 10:18:46.085 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 10:18:46.086 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Orders/Checkout - 400 null application/json; charset=utf-8 15.6945ms
2025-10-23 10:28:02.402 +07:00 [INF] Application is shutting down...
2025-10-23 10:40:43.442 +07:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-23 10:40:44.885 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-23 10:40:44.899 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-23 10:40:44.924 +07:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-23 10:40:44.973 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-23 10:40:44.989 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-23 10:40:44.992 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-23 10:40:44.998 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-23 10:40:45.005 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-10-23 10:40:45.011 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-23 10:40:45.200 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-23 10:40:45.235 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-23 10:40:45.250 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-10-23 10:40:45.283 +07:00 [INF] ✅ Database initialized with admin user only.
2025-10-23 10:40:45.287 +07:00 [INF] Database initialized successfully
2025-10-23 10:40:45.347 +07:00 [INF] ==========================================
2025-10-23 10:40:45.348 +07:00 [INF] BookStore Application Starting...
2025-10-23 10:40:45.349 +07:00 [INF] Environment: Production
2025-10-23 10:40:45.349 +07:00 [INF] Session Timeout: 7 days
2025-10-23 10:40:45.350 +07:00 [INF] Guest Cart: Enabled
2025-10-23 10:40:45.350 +07:00 [INF] ==========================================
2025-10-23 10:40:45.407 +07:00 [INF] Now listening on: http://localhost:5000
2025-10-23 10:40:45.410 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-23 10:40:45.410 +07:00 [INF] Hosting environment: Production
2025-10-23 10:40:45.411 +07:00 [INF] Content root path: C:\Users\DELL\Desktop\Bán sách\BookStoreMWC
2025-10-23 10:40:49.600 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-23 10:40:49.606 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-23 10:40:49.668 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 10:40:49.681 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-23 10:40:49.808 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-23 10:40:49.888 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-23 10:40:49.903 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-23 10:40:49.929 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 10:40:49.945 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-23 10:40:49.953 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 10:40:49.966 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 10:40:49.975 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 10:40:49.999 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 10:40:50.014 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-23 10:40:50.034 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-23 10:40:50.055 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-23 10:40:50.068 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-23 10:40:50.092 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 10:40:50.129 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 10:40:50.285 +07:00 [INF] Executed ViewResult - view Index executed in 156.8637ms.
2025-10-23 10:40:50.290 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 606.2215ms
2025-10-23 10:40:50.292 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 10:40:50.300 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 700.2752ms
2025-10-23 10:40:53.206 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/cart - null null
2025-10-23 10:40:53.213 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-23 10:40:53.216 +07:00 [INF] Route matched with {action = "Index", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-23 10:40:53.282 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[Id], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [CartItems] AS [c]
LEFT JOIN [Books] AS [b] ON [c].[BookId] = [b].[Id]
LEFT JOIN [Categories] AS [c0] ON [b].[CategoryId] = [c0].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [c].[UserId] = @__userId_0
ORDER BY [c].[CreatedAt], [c].[Id], [b].[Id], [c0].[Id]
2025-10-23 10:40:53.296 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 10:40:53.309 +07:00 [INF] Executed ViewResult - view Index executed in 12.8615ms.
2025-10-23 10:40:53.310 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.Index (BookStoreMVC) in 92.9346ms
2025-10-23 10:40:53.311 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-23 10:40:53.312 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/cart - 200 null text/html; charset=utf-8 105.8745ms
2025-10-23 10:40:54.568 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Orders/Checkout - null null
2025-10-23 10:40:54.585 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 10:40:54.590 +07:00 [INF] Route matched with {action = "Checkout", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout() on controller BookStoreMVC.Controllers.OrdersController (BookStoreMVC).
2025-10-23 10:40:54.595 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[Id], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [CartItems] AS [c]
LEFT JOIN [Books] AS [b] ON [c].[BookId] = [b].[Id]
LEFT JOIN [Categories] AS [c0] ON [b].[CategoryId] = [c0].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [c].[UserId] = @__userId_0
ORDER BY [c].[CreatedAt], [c].[Id], [b].[Id], [c0].[Id]
2025-10-23 10:40:54.608 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-10-23 10:40:54.614 +07:00 [INF] Executing ViewResult, running view Checkout.
2025-10-23 10:40:54.651 +07:00 [INF] Executed ViewResult - view Checkout executed in 36.9073ms.
2025-10-23 10:40:54.654 +07:00 [INF] Executed action BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC) in 61.0602ms
2025-10-23 10:40:54.655 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 10:40:54.656 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Orders/Checkout - 200 null text/html; charset=utf-8 88.0172ms
2025-10-23 10:40:54.664 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/momo-logo.png - null null
2025-10-23 10:40:54.665 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/viettelpay-logo.png - null null
2025-10-23 10:40:54.665 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/shopeepay-logo.png - null null
2025-10-23 10:40:54.665 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/zalopay-logo.png - null null
2025-10-23 10:40:54.669 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/momo-logo.png - 404 0 null 4.8779ms
2025-10-23 10:40:54.670 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/viettelpay-logo.png - 404 0 null 5.2494ms
2025-10-23 10:40:54.671 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/shopeepay-logo.png - 404 0 null 6.0544ms
2025-10-23 10:40:54.673 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/zalopay-logo.png - 404 0 null 8.2363ms
2025-10-23 10:40:54.675 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/momo-logo.png, Response status code: 404
2025-10-23 10:40:54.676 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/viettelpay-logo.png, Response status code: 404
2025-10-23 10:40:54.677 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/shopeepay-logo.png, Response status code: 404
2025-10-23 10:40:54.678 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/zalopay-logo.png, Response status code: 404
2025-10-23 10:42:27.781 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-23 10:42:27.790 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 10:42:27.791 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-23 10:42:27.798 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-23 10:42:27.804 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-23 10:42:27.810 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 10:42:27.814 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-23 10:42:27.817 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 10:42:27.819 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 10:42:27.820 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 10:42:27.822 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 10:42:27.824 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-23 10:42:27.829 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-23 10:42:27.832 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 10:42:27.834 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 10:42:27.838 +07:00 [INF] Executed ViewResult - view Index executed in 3.31ms.
2025-10-23 10:42:27.839 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 46.2876ms
2025-10-23 10:42:27.840 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 10:42:27.841 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 60.0556ms
2025-10-23 10:43:02.911 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/account/Logout - application/x-www-form-urlencoded 225
2025-10-23 10:43:02.913 +07:00 [INF] CORS policy execution failed.
2025-10-23 10:43:02.915 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 10:43:02.917 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC)'
2025-10-23 10:43:02.921 +07:00 [INF] Route matched with {action = "Logout", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-23 10:43:02.929 +07:00 [INF] AuthenticationScheme: Identity.Application signed out.
2025-10-23 10:43:02.930 +07:00 [INF] AuthenticationScheme: Identity.External signed out.
2025-10-23 10:43:02.931 +07:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2025-10-23 10:43:02.932 +07:00 [INF] User logged out.
2025-10-23 10:43:02.933 +07:00 [INF] Executing RedirectResult, redirecting to /.
2025-10-23 10:43:02.934 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC) in 12.4271ms
2025-10-23 10:43:02.935 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC)'
2025-10-23 10:43:02.936 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/account/Logout - 302 0 null 25.1941ms
2025-10-23 10:43:02.939 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-23 10:43:02.940 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 10:43:02.941 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-23 10:43:02.944 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-23 10:43:02.947 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-23 10:43:02.951 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 10:43:02.955 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-23 10:43:02.956 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 10:43:02.957 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 10:43:02.959 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 10:43:02.960 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 10:43:02.962 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-23 10:43:02.965 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-23 10:43:02.968 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 10:43:02.970 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 10:43:02.974 +07:00 [INF] Executed ViewResult - view Index executed in 4.1105ms.
2025-10-23 10:43:02.975 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 33.5335ms
2025-10-23 10:43:02.976 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 10:43:02.976 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 37.8156ms
2025-10-23 10:43:04.817 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/account/Register - null null
2025-10-23 10:43:04.821 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Register (BookStoreMVC)'
2025-10-23 10:43:04.826 +07:00 [INF] Route matched with {action = "Register", controller = "Account"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Register(System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-23 10:43:04.835 +07:00 [INF] Executing ViewResult, running view Register.
2025-10-23 10:43:04.884 +07:00 [INF] Executed ViewResult - view Register executed in 50.1796ms.
2025-10-23 10:43:04.887 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Register (BookStoreMVC) in 60.0655ms
2025-10-23 10:43:04.889 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Register (BookStoreMVC)'
2025-10-23 10:43:04.889 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/account/Register - 200 null text/html; charset=utf-8 72.5561ms
2025-10-23 10:43:04.896 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - null null
2025-10-23 10:43:04.896 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - null null
2025-10-23 10:43:04.898 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - 404 0 null 2.2968ms
2025-10-23 10:43:04.900 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - 404 0 null 3.9159ms
2025-10-23 10:43:04.902 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/bookverse-core.js, Response status code: 404
2025-10-23 10:43:04.903 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/auth-validation.js, Response status code: 404
2025-10-23 10:43:08.841 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/account/Login - null null
2025-10-23 10:43:08.844 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-23 10:43:08.846 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-23 10:43:08.850 +07:00 [INF] Executing ViewResult, running view Login.
2025-10-23 10:43:08.862 +07:00 [INF] Executed ViewResult - view Login executed in 12.9957ms.
2025-10-23 10:43:08.864 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 17.2523ms
2025-10-23 10:43:08.865 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-23 10:43:08.866 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/account/Login - 200 null text/html; charset=utf-8 24.4332ms
2025-10-23 10:43:08.874 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - null null
2025-10-23 10:43:08.874 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - null null
2025-10-23 10:43:08.876 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - 404 0 null 1.8844ms
2025-10-23 10:43:08.877 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - 404 0 null 3.2562ms
2025-10-23 10:43:08.878 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/bookverse-core.js, Response status code: 404
2025-10-23 10:43:08.880 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/auth-validation.js, Response status code: 404
2025-10-23 10:43:26.604 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/account/Login - application/x-www-form-urlencoded 241
2025-10-23 10:43:26.607 +07:00 [INF] CORS policy execution failed.
2025-10-23 10:43:26.608 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 10:43:26.608 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-23 10:43:26.613 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BookStoreMVC.Models.ViewModels.LoginViewModel, System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-23 10:43:26.630 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-10-23 10:43:26.718 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2025-10-23 10:43:26.737 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-10-23 10:43:26.741 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-23 10:43:26.749 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2025-10-23 10:43:26.753 +07:00 [INF] AuthenticationScheme: Identity.Application signed in.
2025-10-23 10:43:26.754 +07:00 [INF] User logged in.
2025-10-23 10:43:26.754 +07:00 [INF] Executing RedirectResult, redirecting to /.
2025-10-23 10:43:26.755 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 140.541ms
2025-10-23 10:43:26.756 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-23 10:43:26.756 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/account/Login - 302 0 null 152.5668ms
2025-10-23 10:43:26.759 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-23 10:43:26.760 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 10:43:26.760 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-23 10:43:26.764 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-23 10:43:26.768 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-23 10:43:26.771 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 10:43:26.774 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-23 10:43:26.775 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 10:43:26.776 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 10:43:26.777 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 10:43:26.780 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 10:43:26.783 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-23 10:43:26.786 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-23 10:43:26.787 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 10:43:26.789 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 10:43:26.792 +07:00 [INF] Executed ViewResult - view Index executed in 2.2646ms.
2025-10-23 10:43:26.792 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 30.4704ms
2025-10-23 10:43:26.793 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 10:43:26.794 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 35.0033ms
2025-10-23 10:43:35.120 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - application/json 25
2025-10-23 10:43:35.125 +07:00 [INF] CORS policy execution failed.
2025-10-23 10:43:35.126 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 10:43:35.128 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-23 10:43:35.131 +07:00 [INF] Route matched with {action = "AddToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddToCart(BookStoreMVC.Models.ViewModels.AddToCartViewModel) on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-23 10:43:35.150 +07:00 [INF] AddToCart request - BookId: 3, Quantity: 1
2025-10-23 10:43:35.160 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-23 10:43:35.164 +07:00 [INF] === ADD TO CART START ===
2025-10-23 10:43:35.165 +07:00 [INF] UserId: 4b2ccf54-913b-4dfb-a99f-201f71a1b07b, BookId: 3, Quantity: 1
2025-10-23 10:43:35.167 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-23 10:43:35.168 +07:00 [INF] Book Found - Title: Đi Cho Dã Để Một Đời Không Uổng, Stock: 150, IsActive: true
2025-10-23 10:43:35.175 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450), @__model_BookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__model_BookId_1
2025-10-23 10:43:35.177 +07:00 [INF] Cart Status - Current: 1, Adding: 1, New Total: 2
2025-10-23 10:43:35.178 +07:00 [INF] Updating existing item from 1 to 2
2025-10-23 10:43:35.241 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-23 10:43:35.247 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@p5='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [CartItems] SET [BookId] = @p0, [CreatedAt] = @p1, [Quantity] = @p2, [UpdatedAt] = @p3, [UserId] = @p4
OUTPUT 1
WHERE [Id] = @p5;
2025-10-23 10:43:35.256 +07:00 [INF] === ADD TO CART SUCCESS ===
2025-10-23 10:43:35.263 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([c].[Quantity]), 0)
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0
2025-10-23 10:43:35.266 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType20`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-23 10:43:35.272 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC) in 139.005ms
2025-10-23 10:43:35.273 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-23 10:43:35.274 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - 200 null application/json; charset=utf-8 153.8466ms
2025-10-23 10:43:37.038 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/cart - null null
2025-10-23 10:43:37.041 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-23 10:43:37.042 +07:00 [INF] Route matched with {action = "Index", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-23 10:43:37.044 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[Id], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [CartItems] AS [c]
LEFT JOIN [Books] AS [b] ON [c].[BookId] = [b].[Id]
LEFT JOIN [Categories] AS [c0] ON [b].[CategoryId] = [c0].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [c].[UserId] = @__userId_0
ORDER BY [c].[CreatedAt], [c].[Id], [b].[Id], [c0].[Id]
2025-10-23 10:43:37.047 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 10:43:37.050 +07:00 [INF] Executed ViewResult - view Index executed in 2.7494ms.
2025-10-23 10:43:37.051 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.Index (BookStoreMVC) in 7.8934ms
2025-10-23 10:43:37.051 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-23 10:43:37.052 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/cart - 200 null text/html; charset=utf-8 14.8623ms
2025-10-23 10:43:38.406 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Orders/Checkout - null null
2025-10-23 10:43:38.411 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 10:43:38.412 +07:00 [INF] Route matched with {action = "Checkout", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout() on controller BookStoreMVC.Controllers.OrdersController (BookStoreMVC).
2025-10-23 10:43:38.414 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[Id], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [CartItems] AS [c]
LEFT JOIN [Books] AS [b] ON [c].[BookId] = [b].[Id]
LEFT JOIN [Categories] AS [c0] ON [b].[CategoryId] = [c0].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [c].[UserId] = @__userId_0
ORDER BY [c].[CreatedAt], [c].[Id], [b].[Id], [c0].[Id]
2025-10-23 10:43:38.417 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-10-23 10:43:38.418 +07:00 [INF] Executing ViewResult, running view Checkout.
2025-10-23 10:43:38.423 +07:00 [INF] Executed ViewResult - view Checkout executed in 4.4659ms.
2025-10-23 10:43:38.423 +07:00 [INF] Executed action BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC) in 10.564ms
2025-10-23 10:43:38.424 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 10:43:38.426 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Orders/Checkout - 200 null text/html; charset=utf-8 19.4519ms
2025-10-23 10:43:38.435 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/momo-logo.png - null null
2025-10-23 10:43:38.436 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/zalopay-logo.png - null null
2025-10-23 10:43:38.436 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/viettelpay-logo.png - null null
2025-10-23 10:43:38.436 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/shopeepay-logo.png - null null
2025-10-23 10:43:38.438 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/momo-logo.png - 404 0 null 2.8042ms
2025-10-23 10:43:38.440 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/zalopay-logo.png - 404 0 null 4.0521ms
2025-10-23 10:43:38.442 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/viettelpay-logo.png - 404 0 null 5.1053ms
2025-10-23 10:43:38.442 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/shopeepay-logo.png - 404 0 null 5.7778ms
2025-10-23 10:43:38.443 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/momo-logo.png, Response status code: 404
2025-10-23 10:43:38.444 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/zalopay-logo.png, Response status code: 404
2025-10-23 10:43:38.446 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/viettelpay-logo.png, Response status code: 404
2025-10-23 10:43:38.447 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/shopeepay-logo.png, Response status code: 404
2025-10-23 10:45:29.068 +07:00 [INF] Application is shutting down...
2025-10-23 10:55:08.444 +07:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-23 10:55:09.156 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-23 10:55:09.168 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-23 10:55:09.188 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-23 10:55:09.241 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-23 10:55:09.257 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-23 10:55:09.260 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-23 10:55:09.265 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-23 10:55:09.277 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-10-23 10:55:09.279 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-23 10:55:09.476 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-23 10:55:09.510 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-23 10:55:09.522 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-10-23 10:55:09.554 +07:00 [INF] ✅ Database initialized with admin user only.
2025-10-23 10:55:09.559 +07:00 [INF] Database initialized successfully
2025-10-23 10:55:09.615 +07:00 [INF] ==========================================
2025-10-23 10:55:09.617 +07:00 [INF] BookStore Application Starting...
2025-10-23 10:55:09.618 +07:00 [INF] Environment: Production
2025-10-23 10:55:09.619 +07:00 [INF] Session Timeout: 7 days
2025-10-23 10:55:09.620 +07:00 [INF] Guest Cart: Enabled
2025-10-23 10:55:09.620 +07:00 [INF] ==========================================
2025-10-23 10:55:09.674 +07:00 [INF] Now listening on: http://localhost:5000
2025-10-23 10:55:09.677 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-23 10:55:09.677 +07:00 [INF] Hosting environment: Production
2025-10-23 10:55:09.678 +07:00 [INF] Content root path: C:\Users\DELL\Desktop\Bán sách\BookStoreMWC
2025-10-23 10:55:11.073 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-23 10:55:11.078 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-23 10:55:11.126 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 10:55:11.136 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-23 10:55:11.249 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-23 10:55:11.331 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-23 10:55:11.345 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-23 10:55:11.363 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 10:55:11.377 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-23 10:55:11.388 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 10:55:11.397 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 10:55:11.407 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 10:55:11.427 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 10:55:11.442 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-23 10:55:11.459 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-23 10:55:11.479 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-23 10:55:11.491 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-23 10:55:11.511 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 10:55:11.543 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 10:55:11.659 +07:00 [INF] Executed ViewResult - view Index executed in 115.6834ms.
2025-10-23 10:55:11.665 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 527.6276ms
2025-10-23 10:55:11.667 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 10:55:11.675 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 603.2964ms
2025-10-23 10:55:14.721 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - application/json 25
2025-10-23 10:55:14.726 +07:00 [INF] CORS policy execution failed.
2025-10-23 10:55:14.727 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 10:55:14.742 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-23 10:55:14.752 +07:00 [INF] Route matched with {action = "AddToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddToCart(BookStoreMVC.Models.ViewModels.AddToCartViewModel) on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-23 10:55:14.778 +07:00 [INF] AddToCart request - BookId: 3, Quantity: 1
2025-10-23 10:55:14.824 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-23 10:55:14.832 +07:00 [INF] === ADD TO CART START ===
2025-10-23 10:55:14.834 +07:00 [INF] UserId: 4b2ccf54-913b-4dfb-a99f-201f71a1b07b, BookId: 3, Quantity: 1
2025-10-23 10:55:14.835 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-23 10:55:14.838 +07:00 [INF] Book Found - Title: Đi Cho Dã Để Một Đời Không Uổng, Stock: 150, IsActive: true
2025-10-23 10:55:14.844 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__model_BookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__model_BookId_1
2025-10-23 10:55:14.855 +07:00 [INF] Cart Status - Current: 2, Adding: 1, New Total: 3
2025-10-23 10:55:14.855 +07:00 [INF] Updating existing item from 2 to 3
2025-10-23 10:55:14.910 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-23 10:55:14.916 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@p5='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [CartItems] SET [BookId] = @p0, [CreatedAt] = @p1, [Quantity] = @p2, [UpdatedAt] = @p3, [UserId] = @p4
OUTPUT 1
WHERE [Id] = @p5;
2025-10-23 10:55:14.925 +07:00 [INF] === ADD TO CART SUCCESS ===
2025-10-23 10:55:14.932 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([c].[Quantity]), 0)
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0
2025-10-23 10:55:14.935 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType20`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-23 10:55:14.941 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC) in 187.5758ms
2025-10-23 10:55:14.942 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-23 10:55:14.943 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - 200 null application/json; charset=utf-8 221.5229ms
2025-10-23 10:55:17.283 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/cart - null null
2025-10-23 10:55:17.296 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-23 10:55:17.300 +07:00 [INF] Route matched with {action = "Index", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-23 10:55:17.322 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[Id], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [CartItems] AS [c]
LEFT JOIN [Books] AS [b] ON [c].[BookId] = [b].[Id]
LEFT JOIN [Categories] AS [c0] ON [b].[CategoryId] = [c0].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [c].[UserId] = @__userId_0
ORDER BY [c].[CreatedAt], [c].[Id], [b].[Id], [c0].[Id]
2025-10-23 10:55:17.331 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 10:55:17.342 +07:00 [INF] Executed ViewResult - view Index executed in 11.0243ms.
2025-10-23 10:55:17.344 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.Index (BookStoreMVC) in 43.0658ms
2025-10-23 10:55:17.345 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-23 10:55:17.347 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/cart - 200 null text/html; charset=utf-8 64.0812ms
2025-10-23 10:55:18.738 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Orders/Checkout - null null
2025-10-23 10:55:18.744 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 10:55:18.747 +07:00 [INF] Route matched with {action = "Checkout", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout() on controller BookStoreMVC.Controllers.OrdersController (BookStoreMVC).
2025-10-23 10:55:18.750 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[Id], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [CartItems] AS [c]
LEFT JOIN [Books] AS [b] ON [c].[BookId] = [b].[Id]
LEFT JOIN [Categories] AS [c0] ON [b].[CategoryId] = [c0].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [c].[UserId] = @__userId_0
ORDER BY [c].[CreatedAt], [c].[Id], [b].[Id], [c0].[Id]
2025-10-23 10:55:18.762 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-10-23 10:55:18.767 +07:00 [INF] Executing ViewResult, running view Checkout.
2025-10-23 10:55:18.802 +07:00 [INF] Executed ViewResult - view Checkout executed in 35.4138ms.
2025-10-23 10:55:18.805 +07:00 [INF] Executed action BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC) in 57.6761ms
2025-10-23 10:55:18.807 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 10:55:18.807 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Orders/Checkout - 200 null text/html; charset=utf-8 69.5204ms
2025-10-23 10:55:18.815 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/momo-logo.png - null null
2025-10-23 10:55:18.817 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/zalopay-logo.png - null null
2025-10-23 10:55:18.818 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/momo-logo.png - 404 0 null 3.3498ms
2025-10-23 10:55:18.818 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/shopeepay-logo.png - null null
2025-10-23 10:55:18.818 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/viettelpay-logo.png - null null
2025-10-23 10:55:18.821 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/zalopay-logo.png - 404 0 null 3.0185ms
2025-10-23 10:55:18.821 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/momo-logo.png, Response status code: 404
2025-10-23 10:55:18.822 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/shopeepay-logo.png - 404 0 null 3.8942ms
2025-10-23 10:55:18.823 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/viettelpay-logo.png - 404 0 null 5.0666ms
2025-10-23 10:55:18.824 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/zalopay-logo.png, Response status code: 404
2025-10-23 10:55:18.827 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/shopeepay-logo.png, Response status code: 404
2025-10-23 10:55:18.829 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/viettelpay-logo.png, Response status code: 404
2025-10-23 10:55:29.252 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Orders/Checkout - multipart/form-data; boundary=----WebKitFormBoundaryGeQ80JGK9RMMRA4j 1414
2025-10-23 10:55:29.256 +07:00 [INF] CORS policy execution failed.
2025-10-23 10:55:29.257 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 10:55:29.259 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 10:55:29.278 +07:00 [INF] Route matched with {action = "Checkout", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(BookStoreMVC.Models.ViewModels.OrderCreateViewModel) on controller BookStoreMVC.Controllers.OrdersController (BookStoreMVC).
2025-10-23 10:55:29.301 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[Id], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [CartItems] AS [c]
LEFT JOIN [Books] AS [b] ON [c].[BookId] = [b].[Id]
LEFT JOIN [Categories] AS [c0] ON [b].[CategoryId] = [c0].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [c].[UserId] = @__userId_0
ORDER BY [c].[CreatedAt], [c].[Id], [b].[Id], [c0].[Id]
2025-10-23 10:55:29.345 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-23 10:55:29.353 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 200), @p1='?' (Size = 100), @p2='?' (Size = 100), @p3='?' (Size = 50), @p4='?' (Size = 50), @p5='?' (Size = 20), @p6='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [ShippingInfos] ([Address], [City], [Country], [FirstName], [LastName], [Phone], [PostalCode])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-23 10:55:29.383 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-23 10:55:29.390 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p6='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p7='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p8='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Orders] ([CreatedAt], [Discount], [PaymentId], [ShippingInfoId], [Status], [SubTotal], [Tax], [Total], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-10-23 10:55:29.421 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-23 10:55:29.429 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p6='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p8='?' (DbType = Int32), @p7='?' (DbType = Int32), @p9='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p10='?' (DbType = DateTime2), @p11='?' (Size = 50), @p12='?' (DbType = Int32), @p13='?' (DbType = Int32), @p14='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Books] SET [StockQuantity] = @p0
OUTPUT 1
WHERE [Id] = @p1;
INSERT INTO [OrderItems] ([BookId], [OrderId], [Quantity], [Total], [UnitPrice])
OUTPUT INSERTED.[Id]
VALUES (@p2, @p3, @p4, @p5, @p6);
UPDATE [Orders] SET [PaymentId] = @p7
OUTPUT 1
WHERE [Id] = @p8;
INSERT INTO [Payments] ([Amount], [CreatedAt], [Method], [OrderId], [Status], [TransactionId])
OUTPUT INSERTED.[Id]
VALUES (@p9, @p10, @p11, @p12, @p13, @p14);
2025-10-23 10:55:29.441 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0
2025-10-23 10:55:29.445 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-23 10:55:29.447 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [CartItems]
OUTPUT 1
WHERE [Id] = @p0;
2025-10-23 10:55:29.450 +07:00 [INF] Cleared cart for UserId 4b2ccf54-913b-4dfb-a99f-201f71a1b07b
2025-10-23 10:55:29.489 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__orderId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s0].[Id], [s0].[CreatedAt], [s0].[Discount], [s0].[PaymentId], [s0].[ShippingInfoId], [s0].[Status], [s0].[SubTotal], [s0].[Tax], [s0].[Total], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [s0].[Id1], [s0].[Address], [s0].[City], [s0].[Country], [s0].[FirstName], [s0].[LastName], [s0].[Phone], [s0].[PostalCode], [s0].[Id2], [s0].[Amount], [s0].[CreatedAt1], [s0].[Method], [s0].[OrderId], [s0].[Status0], [s0].[TransactionId], [s1].[Id], [s1].[BookId], [s1].[OrderId], [s1].[Quantity], [s1].[Total], [s1].[UnitPrice], [s1].[Id0], [s1].[AdditionalImages], [s1].[Author], [s1].[CategoryId], [s1].[CreatedAt], [s1].[Description], [s1].[DiscountPrice], [s1].[ImageContentType], [s1].[ImageFileName], [s1].[ImageFileSize], [s1].[ImageUrl], [s1].[IsActive], [s1].[Language], [s1].[PageCount], [s1].[Price], [s1].[PublishDate], [s1].[Publisher], [s1].[StockQuantity], [s1].[Title], [s1].[UpdatedAt], [s1].[Id1], [s1].[CreatedAt0], [s1].[Description0], [s1].[ImageUrl0], [s1].[IsActive0], [s1].[Name], [s1].[ParentCategoryId]
FROM (
    SELECT TOP(1) [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [s].[Id] AS [Id1], [s].[Address], [s].[City], [s].[Country], [s].[FirstName], [s].[LastName], [s].[Phone], [s].[PostalCode], [p].[Id] AS [Id2], [p].[Amount], [p].[CreatedAt] AS [CreatedAt1], [p].[Method], [p].[OrderId], [p].[Status] AS [Status0], [p].[TransactionId]
    FROM [Orders] AS [o]
    INNER JOIN [AspNetUsers] AS [a] ON [o].[UserId] = [a].[Id]
    INNER JOIN [ShippingInfos] AS [s] ON [o].[ShippingInfoId] = [s].[Id]
    LEFT JOIN [Payments] AS [p] ON [o].[Id] = [p].[OrderId]
    WHERE [o].[Id] = @__orderId_0
) AS [s0]
LEFT JOIN (
    SELECT [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice], [b].[Id] AS [Id0], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id1], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [OrderItems] AS [o0]
    LEFT JOIN [Books] AS [b] ON [o0].[BookId] = [b].[Id]
    LEFT JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
) AS [s1] ON [s0].[Id] = [s1].[OrderId]
ORDER BY [s0].[Id], [s0].[Id0], [s0].[Id1], [s0].[Id2], [s1].[Id], [s1].[Id0]
2025-10-23 10:55:29.499 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType33`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-23 10:55:29.504 +07:00 [INF] Executed action BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC) in 224.8165ms
2025-10-23 10:55:29.504 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 10:55:29.505 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Orders/Checkout - 200 null application/json; charset=utf-8 253.3359ms
2025-10-23 10:55:29.511 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Orders/Details/1 - null null
2025-10-23 10:55:29.514 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.OrdersController.Details (BookStoreMVC)'
2025-10-23 10:55:29.517 +07:00 [INF] Route matched with {action = "Details", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32) on controller BookStoreMVC.Controllers.OrdersController (BookStoreMVC).
2025-10-23 10:55:29.546 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (Size = 450), @__orderId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s0].[Id], [s0].[CreatedAt], [s0].[Discount], [s0].[PaymentId], [s0].[ShippingInfoId], [s0].[Status], [s0].[SubTotal], [s0].[Tax], [s0].[Total], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [s0].[Id1], [s0].[Address], [s0].[City], [s0].[Country], [s0].[FirstName], [s0].[LastName], [s0].[Phone], [s0].[PostalCode], [s0].[Id2], [s0].[Amount], [s0].[CreatedAt1], [s0].[Method], [s0].[OrderId], [s0].[Status0], [s0].[TransactionId], [s1].[Id], [s1].[BookId], [s1].[OrderId], [s1].[Quantity], [s1].[Total], [s1].[UnitPrice], [s1].[Id0], [s1].[AdditionalImages], [s1].[Author], [s1].[CategoryId], [s1].[CreatedAt], [s1].[Description], [s1].[DiscountPrice], [s1].[ImageContentType], [s1].[ImageFileName], [s1].[ImageFileSize], [s1].[ImageUrl], [s1].[IsActive], [s1].[Language], [s1].[PageCount], [s1].[Price], [s1].[PublishDate], [s1].[Publisher], [s1].[StockQuantity], [s1].[Title], [s1].[UpdatedAt], [s1].[Id1], [s1].[CreatedAt0], [s1].[Description0], [s1].[ImageUrl0], [s1].[IsActive0], [s1].[Name], [s1].[ParentCategoryId]
FROM (
    SELECT TOP(1) [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [s].[Id] AS [Id1], [s].[Address], [s].[City], [s].[Country], [s].[FirstName], [s].[LastName], [s].[Phone], [s].[PostalCode], [p].[Id] AS [Id2], [p].[Amount], [p].[CreatedAt] AS [CreatedAt1], [p].[Method], [p].[OrderId], [p].[Status] AS [Status0], [p].[TransactionId]
    FROM [Orders] AS [o]
    INNER JOIN [AspNetUsers] AS [a] ON [o].[UserId] = [a].[Id]
    INNER JOIN [ShippingInfos] AS [s] ON [o].[ShippingInfoId] = [s].[Id]
    LEFT JOIN [Payments] AS [p] ON [o].[Id] = [p].[OrderId]
    WHERE [o].[UserId] = @__userId_0 AND [o].[Id] = @__orderId_1
) AS [s0]
LEFT JOIN (
    SELECT [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice], [b].[Id] AS [Id0], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id1], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [OrderItems] AS [o0]
    LEFT JOIN [Books] AS [b] ON [o0].[BookId] = [b].[Id]
    LEFT JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
) AS [s1] ON [s0].[Id] = [s1].[OrderId]
ORDER BY [s0].[Id], [s0].[Id0], [s0].[Id1], [s0].[Id2], [s1].[Id], [s1].[Id0]
2025-10-23 10:55:29.558 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-23 10:55:29.575 +07:00 [INF] Executed ViewResult - view Details executed in 17.1796ms.
2025-10-23 10:55:29.577 +07:00 [INF] Executed action BookStoreMVC.Controllers.OrdersController.Details (BookStoreMVC) in 59.0002ms
2025-10-23 10:55:29.579 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.OrdersController.Details (BookStoreMVC)'
2025-10-23 10:55:29.580 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Orders/Details/1 - 200 null text/html; charset=utf-8 68.889ms
2025-10-23 10:55:29.588 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/no-book-cover.png - null null
2025-10-23 10:55:29.589 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/no-book-cover.png - 404 0 null 1.8473ms
2025-10-23 10:55:29.591 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/no-book-cover.png, Response status code: 404
2025-10-23 11:08:57.289 +07:00 [INF] Application is shutting down...
2025-10-23 11:16:43.235 +07:00 [INF] User profile is available. Using 'C:\Users\DELL\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-10-23 11:16:43.995 +07:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-23 11:16:44.007 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-10-23 11:16:44.027 +07:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-10-23 11:16:44.078 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-10-23 11:16:44.093 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-10-23 11:16:44.096 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-10-23 11:16:44.102 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-10-23 11:16:44.112 +07:00 [INF] No migrations were applied. The database is already up to date.
2025-10-23 11:16:44.115 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-10-23 11:16:44.317 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-23 11:16:44.353 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-23 11:16:44.364 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedEmail_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedEmail] = @__normalizedEmail_0
2025-10-23 11:16:44.403 +07:00 [INF] ✅ Database initialized with admin user only.
2025-10-23 11:16:44.407 +07:00 [INF] Database initialized successfully
2025-10-23 11:16:44.472 +07:00 [INF] ==========================================
2025-10-23 11:16:44.473 +07:00 [INF] BookStore Application Starting...
2025-10-23 11:16:44.474 +07:00 [INF] Environment: Production
2025-10-23 11:16:44.475 +07:00 [INF] Session Timeout: 7 days
2025-10-23 11:16:44.475 +07:00 [INF] Guest Cart: Enabled
2025-10-23 11:16:44.475 +07:00 [INF] ==========================================
2025-10-23 11:16:44.536 +07:00 [INF] Now listening on: http://localhost:5000
2025-10-23 11:16:44.538 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-10-23 11:16:44.539 +07:00 [INF] Hosting environment: Production
2025-10-23 11:16:44.539 +07:00 [INF] Content root path: C:\Users\DELL\Desktop\Bán sách\BookStoreMWC
2025-10-23 11:16:46.151 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-23 11:16:46.157 +07:00 [WRN] Failed to determine the https port for redirect.
2025-10-23 11:16:46.241 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-10-23 11:16:46.271 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2025-10-23 11:16:46.290 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-10-23 11:16:46.295 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-23 11:16:46.303 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2025-10-23 11:16:46.309 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 11:16:46.318 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-23 11:16:46.395 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-23 11:16:46.477 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-23 11:16:46.492 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-23 11:16:46.523 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 11:16:46.543 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-23 11:16:46.555 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 11:16:46.564 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 11:16:46.574 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 11:16:46.596 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 11:16:46.610 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-23 11:16:46.627 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-23 11:16:46.648 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-23 11:16:46.693 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-10-23 11:16:46.718 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 11:16:46.754 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 11:16:46.875 +07:00 [INF] Executed ViewResult - view Index executed in 121.1384ms.
2025-10-23 11:16:46.883 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 563.4146ms
2025-10-23 11:16:46.886 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 11:16:46.893 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 743.6167ms
2025-10-23 11:16:50.070 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - application/json 25
2025-10-23 11:16:50.075 +07:00 [INF] CORS policy execution failed.
2025-10-23 11:16:50.076 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 11:16:50.091 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-23 11:16:50.099 +07:00 [INF] Route matched with {action = "AddToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddToCart(BookStoreMVC.Models.ViewModels.AddToCartViewModel) on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-23 11:16:50.127 +07:00 [INF] AddToCart request - BookId: 1, Quantity: 1
2025-10-23 11:16:50.178 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-23 11:16:50.186 +07:00 [INF] === ADD TO CART START ===
2025-10-23 11:16:50.187 +07:00 [INF] UserId: 4b2ccf54-913b-4dfb-a99f-201f71a1b07b, BookId: 1, Quantity: 1
2025-10-23 11:16:50.189 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-23 11:16:50.191 +07:00 [INF] Book Found - Title: Chầm Chậm Trưởng Thành Thong Dong Rực Rỡ, Stock: 150, IsActive: true
2025-10-23 11:16:50.200 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__model_BookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__model_BookId_1
2025-10-23 11:16:50.202 +07:00 [INF] Cart Status - Current: 0, Adding: 1, New Total: 1
2025-10-23 11:16:50.203 +07:00 [INF] Creating new cart item with quantity 1
2025-10-23 11:16:50.288 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-23 11:16:50.293 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CartItems] ([BookId], [CreatedAt], [Quantity], [UpdatedAt], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-10-23 11:16:50.311 +07:00 [INF] === ADD TO CART SUCCESS ===
2025-10-23 11:16:50.320 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([c].[Quantity]), 0)
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0
2025-10-23 11:16:50.322 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType20`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-23 11:16:50.330 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC) in 229.7105ms
2025-10-23 11:16:50.332 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-23 11:16:50.334 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - 200 null application/json; charset=utf-8 263.1706ms
2025-10-23 11:16:51.770 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - application/json 25
2025-10-23 11:16:51.774 +07:00 [INF] CORS policy execution failed.
2025-10-23 11:16:51.775 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 11:16:51.786 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-23 11:16:51.786 +07:00 [INF] Route matched with {action = "AddToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddToCart(BookStoreMVC.Models.ViewModels.AddToCartViewModel) on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-23 11:16:51.789 +07:00 [INF] AddToCart request - BookId: 4, Quantity: 1
2025-10-23 11:16:51.790 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-23 11:16:51.800 +07:00 [INF] === ADD TO CART START ===
2025-10-23 11:16:51.800 +07:00 [INF] UserId: 4b2ccf54-913b-4dfb-a99f-201f71a1b07b, BookId: 4, Quantity: 1
2025-10-23 11:16:51.801 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-23 11:16:51.803 +07:00 [INF] Book Found - Title: Yêu Những Điều Không Hoàn Hảo, Stock: 20, IsActive: true
2025-10-23 11:16:51.804 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__model_BookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__model_BookId_1
2025-10-23 11:16:51.805 +07:00 [INF] Cart Status - Current: 0, Adding: 1, New Total: 1
2025-10-23 11:16:51.805 +07:00 [INF] Creating new cart item with quantity 1
2025-10-23 11:16:51.807 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-23 11:16:51.808 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CartItems] ([BookId], [CreatedAt], [Quantity], [UpdatedAt], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-10-23 11:16:51.818 +07:00 [INF] === ADD TO CART SUCCESS ===
2025-10-23 11:16:51.820 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([c].[Quantity]), 0)
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0
2025-10-23 11:16:51.821 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType20`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-23 11:16:51.822 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC) in 34.8054ms
2025-10-23 11:16:51.823 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-23 11:16:51.824 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - 200 null application/json; charset=utf-8 53.6827ms
2025-10-23 11:16:53.307 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/cart - null null
2025-10-23 11:16:53.310 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-23 11:16:53.314 +07:00 [INF] Route matched with {action = "Index", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-23 11:16:53.339 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[Id], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [CartItems] AS [c]
LEFT JOIN [Books] AS [b] ON [c].[BookId] = [b].[Id]
LEFT JOIN [Categories] AS [c0] ON [b].[CategoryId] = [c0].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [c].[UserId] = @__userId_0
ORDER BY [c].[CreatedAt], [c].[Id], [b].[Id], [c0].[Id]
2025-10-23 11:16:53.349 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 11:16:53.363 +07:00 [INF] Executed ViewResult - view Index executed in 14.189ms.
2025-10-23 11:16:53.365 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.Index (BookStoreMVC) in 50.2142ms
2025-10-23 11:16:53.366 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-23 11:16:53.367 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/cart - 200 null text/html; charset=utf-8 59.9293ms
2025-10-23 11:16:54.388 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Orders/Checkout - null null
2025-10-23 11:16:54.395 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 11:16:54.398 +07:00 [INF] Route matched with {action = "Checkout", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout() on controller BookStoreMVC.Controllers.OrdersController (BookStoreMVC).
2025-10-23 11:16:54.402 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[Id], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [CartItems] AS [c]
LEFT JOIN [Books] AS [b] ON [c].[BookId] = [b].[Id]
LEFT JOIN [Categories] AS [c0] ON [b].[CategoryId] = [c0].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [c].[UserId] = @__userId_0
ORDER BY [c].[CreatedAt], [c].[Id], [b].[Id], [c0].[Id]
2025-10-23 11:16:54.405 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-10-23 11:16:54.413 +07:00 [INF] Executing ViewResult, running view Checkout.
2025-10-23 11:16:54.450 +07:00 [INF] Executed ViewResult - view Checkout executed in 37.7598ms.
2025-10-23 11:16:54.453 +07:00 [INF] Executed action BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC) in 54.0617ms
2025-10-23 11:16:54.454 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 11:16:54.455 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Orders/Checkout - 200 null text/html; charset=utf-8 66.9103ms
2025-10-23 11:16:54.465 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/momo-logo.png - null null
2025-10-23 11:16:54.468 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/momo-logo.png - 404 0 null 3.0916ms
2025-10-23 11:16:54.468 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/zalopay-logo.png - null null
2025-10-23 11:16:54.468 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/viettelpay-logo.png - null null
2025-10-23 11:16:54.468 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/shopeepay-logo.png - null null
2025-10-23 11:16:54.470 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/momo-logo.png, Response status code: 404
2025-10-23 11:16:54.472 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/zalopay-logo.png - 404 0 null 3.8928ms
2025-10-23 11:16:54.472 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/viettelpay-logo.png - 404 0 null 4.0538ms
2025-10-23 11:16:54.474 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/shopeepay-logo.png - 404 0 null 5.6997ms
2025-10-23 11:16:54.477 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/zalopay-logo.png, Response status code: 404
2025-10-23 11:16:54.479 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/viettelpay-logo.png, Response status code: 404
2025-10-23 11:16:54.480 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/shopeepay-logo.png, Response status code: 404
2025-10-23 11:17:05.255 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Orders/Checkout - multipart/form-data; boundary=----WebKitFormBoundaryAAn9KShiFll17U0g 1414
2025-10-23 11:17:05.259 +07:00 [INF] CORS policy execution failed.
2025-10-23 11:17:05.259 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 11:17:05.261 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 11:17:05.280 +07:00 [INF] Route matched with {action = "Checkout", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout(BookStoreMVC.Models.ViewModels.OrderCreateViewModel) on controller BookStoreMVC.Controllers.OrdersController (BookStoreMVC).
2025-10-23 11:17:05.298 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[Id], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [CartItems] AS [c]
LEFT JOIN [Books] AS [b] ON [c].[BookId] = [b].[Id]
LEFT JOIN [Categories] AS [c0] ON [b].[CategoryId] = [c0].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [c].[UserId] = @__userId_0
ORDER BY [c].[CreatedAt], [c].[Id], [b].[Id], [c0].[Id]
2025-10-23 11:17:05.337 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-23 11:17:05.339 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (Size = 200), @p1='?' (Size = 100), @p2='?' (Size = 100), @p3='?' (Size = 50), @p4='?' (Size = 50), @p5='?' (Size = 20), @p6='?' (Size = 20)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [ShippingInfos] ([Address], [City], [Country], [FirstName], [LastName], [Phone], [PostalCode])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-10-23 11:17:05.363 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-23 11:17:05.367 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p6='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p7='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p8='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Orders] ([CreatedAt], [Discount], [PaymentId], [ShippingInfoId], [Status], [SubTotal], [Tax], [Total], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-10-23 11:17:05.396 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-23 11:17:05.406 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Int32), @p3='?' (DbType = Int32), @p2='?' (DbType = Int32), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p8='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = Int32), @p11='?' (DbType = Int32), @p12='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p13='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p15='?' (DbType = Int32), @p14='?' (DbType = Int32), @p16='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p17='?' (DbType = DateTime2), @p18='?' (Size = 50), @p19='?' (DbType = Int32), @p20='?' (DbType = Int32), @p21='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Books] SET [StockQuantity] = @p0
OUTPUT 1
WHERE [Id] = @p1;
UPDATE [Books] SET [StockQuantity] = @p2
OUTPUT 1
WHERE [Id] = @p3;
MERGE [OrderItems] USING (
VALUES (@p4, @p5, @p6, @p7, @p8, 0),
(@p9, @p10, @p11, @p12, @p13, 1)) AS i ([BookId], [OrderId], [Quantity], [Total], [UnitPrice], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([BookId], [OrderId], [Quantity], [Total], [UnitPrice])
VALUES (i.[BookId], i.[OrderId], i.[Quantity], i.[Total], i.[UnitPrice])
OUTPUT INSERTED.[Id], i._Position;
UPDATE [Orders] SET [PaymentId] = @p14
OUTPUT 1
WHERE [Id] = @p15;
INSERT INTO [Payments] ([Amount], [CreatedAt], [Method], [OrderId], [Status], [TransactionId])
OUTPUT INSERTED.[Id]
VALUES (@p16, @p17, @p18, @p19, @p20, @p21);
2025-10-23 11:17:05.416 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0
2025-10-23 11:17:05.424 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-23 11:17:05.426 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [CartItems]
OUTPUT 1
WHERE [Id] = @p0;
DELETE FROM [CartItems]
OUTPUT 1
WHERE [Id] = @p1;
2025-10-23 11:17:05.430 +07:00 [INF] Cleared cart for UserId 4b2ccf54-913b-4dfb-a99f-201f71a1b07b
2025-10-23 11:17:05.460 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__orderId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s0].[Id], [s0].[CreatedAt], [s0].[Discount], [s0].[PaymentId], [s0].[ShippingInfoId], [s0].[Status], [s0].[SubTotal], [s0].[Tax], [s0].[Total], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [s0].[Id1], [s0].[Address], [s0].[City], [s0].[Country], [s0].[FirstName], [s0].[LastName], [s0].[Phone], [s0].[PostalCode], [s0].[Id2], [s0].[Amount], [s0].[CreatedAt1], [s0].[Method], [s0].[OrderId], [s0].[Status0], [s0].[TransactionId], [s1].[Id], [s1].[BookId], [s1].[OrderId], [s1].[Quantity], [s1].[Total], [s1].[UnitPrice], [s1].[Id0], [s1].[AdditionalImages], [s1].[Author], [s1].[CategoryId], [s1].[CreatedAt], [s1].[Description], [s1].[DiscountPrice], [s1].[ImageContentType], [s1].[ImageFileName], [s1].[ImageFileSize], [s1].[ImageUrl], [s1].[IsActive], [s1].[Language], [s1].[PageCount], [s1].[Price], [s1].[PublishDate], [s1].[Publisher], [s1].[StockQuantity], [s1].[Title], [s1].[UpdatedAt], [s1].[Id1], [s1].[CreatedAt0], [s1].[Description0], [s1].[ImageUrl0], [s1].[IsActive0], [s1].[Name], [s1].[ParentCategoryId]
FROM (
    SELECT TOP(1) [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [s].[Id] AS [Id1], [s].[Address], [s].[City], [s].[Country], [s].[FirstName], [s].[LastName], [s].[Phone], [s].[PostalCode], [p].[Id] AS [Id2], [p].[Amount], [p].[CreatedAt] AS [CreatedAt1], [p].[Method], [p].[OrderId], [p].[Status] AS [Status0], [p].[TransactionId]
    FROM [Orders] AS [o]
    INNER JOIN [AspNetUsers] AS [a] ON [o].[UserId] = [a].[Id]
    INNER JOIN [ShippingInfos] AS [s] ON [o].[ShippingInfoId] = [s].[Id]
    LEFT JOIN [Payments] AS [p] ON [o].[Id] = [p].[OrderId]
    WHERE [o].[Id] = @__orderId_0
) AS [s0]
LEFT JOIN (
    SELECT [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice], [b].[Id] AS [Id0], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id1], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [OrderItems] AS [o0]
    LEFT JOIN [Books] AS [b] ON [o0].[BookId] = [b].[Id]
    LEFT JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
) AS [s1] ON [s0].[Id] = [s1].[OrderId]
ORDER BY [s0].[Id], [s0].[Id0], [s0].[Id1], [s0].[Id2], [s1].[Id], [s1].[Id0]
2025-10-23 11:17:05.471 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType33`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-23 11:17:05.474 +07:00 [INF] Executed action BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC) in 192.1462ms
2025-10-23 11:17:05.475 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 11:17:05.475 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Orders/Checkout - 200 null application/json; charset=utf-8 220.0136ms
2025-10-23 11:17:05.481 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Orders/Details/2 - null null
2025-10-23 11:17:05.485 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.OrdersController.Details (BookStoreMVC)'
2025-10-23 11:17:05.488 +07:00 [INF] Route matched with {action = "Details", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Details(Int32) on controller BookStoreMVC.Controllers.OrdersController (BookStoreMVC).
2025-10-23 11:17:05.541 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450), @__orderId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s0].[Id], [s0].[CreatedAt], [s0].[Discount], [s0].[PaymentId], [s0].[ShippingInfoId], [s0].[Status], [s0].[SubTotal], [s0].[Tax], [s0].[Total], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [s0].[Id1], [s0].[Address], [s0].[City], [s0].[Country], [s0].[FirstName], [s0].[LastName], [s0].[Phone], [s0].[PostalCode], [s0].[Id2], [s0].[Amount], [s0].[CreatedAt1], [s0].[Method], [s0].[OrderId], [s0].[Status0], [s0].[TransactionId], [s1].[Id], [s1].[BookId], [s1].[OrderId], [s1].[Quantity], [s1].[Total], [s1].[UnitPrice], [s1].[Id0], [s1].[AdditionalImages], [s1].[Author], [s1].[CategoryId], [s1].[CreatedAt], [s1].[Description], [s1].[DiscountPrice], [s1].[ImageContentType], [s1].[ImageFileName], [s1].[ImageFileSize], [s1].[ImageUrl], [s1].[IsActive], [s1].[Language], [s1].[PageCount], [s1].[Price], [s1].[PublishDate], [s1].[Publisher], [s1].[StockQuantity], [s1].[Title], [s1].[UpdatedAt], [s1].[Id1], [s1].[CreatedAt0], [s1].[Description0], [s1].[ImageUrl0], [s1].[IsActive0], [s1].[Name], [s1].[ParentCategoryId]
FROM (
    SELECT TOP(1) [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [s].[Id] AS [Id1], [s].[Address], [s].[City], [s].[Country], [s].[FirstName], [s].[LastName], [s].[Phone], [s].[PostalCode], [p].[Id] AS [Id2], [p].[Amount], [p].[CreatedAt] AS [CreatedAt1], [p].[Method], [p].[OrderId], [p].[Status] AS [Status0], [p].[TransactionId]
    FROM [Orders] AS [o]
    INNER JOIN [AspNetUsers] AS [a] ON [o].[UserId] = [a].[Id]
    INNER JOIN [ShippingInfos] AS [s] ON [o].[ShippingInfoId] = [s].[Id]
    LEFT JOIN [Payments] AS [p] ON [o].[Id] = [p].[OrderId]
    WHERE [o].[UserId] = @__userId_0 AND [o].[Id] = @__orderId_1
) AS [s0]
LEFT JOIN (
    SELECT [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice], [b].[Id] AS [Id0], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id1], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [OrderItems] AS [o0]
    LEFT JOIN [Books] AS [b] ON [o0].[BookId] = [b].[Id]
    LEFT JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
) AS [s1] ON [s0].[Id] = [s1].[OrderId]
ORDER BY [s0].[Id], [s0].[Id0], [s0].[Id1], [s0].[Id2], [s1].[Id], [s1].[Id0]
2025-10-23 11:17:05.553 +07:00 [INF] Executing ViewResult, running view Details.
2025-10-23 11:17:05.567 +07:00 [INF] Executed ViewResult - view Details executed in 14.3367ms.
2025-10-23 11:17:05.569 +07:00 [INF] Executed action BookStoreMVC.Controllers.OrdersController.Details (BookStoreMVC) in 79.4275ms
2025-10-23 11:17:05.570 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.OrdersController.Details (BookStoreMVC)'
2025-10-23 11:17:05.571 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Orders/Details/2 - 200 null text/html; charset=utf-8 89.6177ms
2025-10-23 11:19:45.335 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-23 11:19:45.342 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 11:19:45.343 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-23 11:19:45.349 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-23 11:19:45.357 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-23 11:19:45.363 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 11:19:45.369 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-23 11:19:45.371 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 11:19:45.374 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 11:19:45.376 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 11:19:45.378 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 11:19:45.380 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-23 11:19:45.395 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-23 11:19:45.398 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 11:19:45.405 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 11:19:45.414 +07:00 [INF] Executed ViewResult - view Index executed in 8.6701ms.
2025-10-23 11:19:45.415 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 69.8597ms
2025-10-23 11:19:45.416 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 11:19:45.422 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 87.4972ms
2025-10-23 11:19:48.740 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - application/json 25
2025-10-23 11:19:48.743 +07:00 [INF] CORS policy execution failed.
2025-10-23 11:19:48.744 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 11:19:48.745 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-23 11:19:48.745 +07:00 [INF] Route matched with {action = "AddToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddToCart(BookStoreMVC.Models.ViewModels.AddToCartViewModel) on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-23 11:19:48.747 +07:00 [INF] AddToCart request - BookId: 3, Quantity: 1
2025-10-23 11:19:48.749 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-23 11:19:48.752 +07:00 [INF] === ADD TO CART START ===
2025-10-23 11:19:48.752 +07:00 [INF] UserId: 4b2ccf54-913b-4dfb-a99f-201f71a1b07b, BookId: 3, Quantity: 1
2025-10-23 11:19:48.753 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-23 11:19:48.754 +07:00 [INF] Book Found - Title: Đi Cho Dã Để Một Đời Không Uổng, Stock: 147, IsActive: true
2025-10-23 11:19:48.755 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__model_BookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__model_BookId_1
2025-10-23 11:19:48.756 +07:00 [INF] Cart Status - Current: 0, Adding: 1, New Total: 1
2025-10-23 11:19:48.757 +07:00 [INF] Creating new cart item with quantity 1
2025-10-23 11:19:48.758 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-23 11:19:48.759 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CartItems] ([BookId], [CreatedAt], [Quantity], [UpdatedAt], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-10-23 11:19:48.760 +07:00 [INF] === ADD TO CART SUCCESS ===
2025-10-23 11:19:48.761 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([c].[Quantity]), 0)
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0
2025-10-23 11:19:48.762 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType20`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-23 11:19:48.763 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC) in 16.4959ms
2025-10-23 11:19:48.764 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-23 11:19:48.764 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - 200 null application/json; charset=utf-8 24.2511ms
2025-10-23 11:19:49.267 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - application/json 25
2025-10-23 11:19:49.270 +07:00 [INF] CORS policy execution failed.
2025-10-23 11:19:49.271 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 11:19:49.272 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-23 11:19:49.272 +07:00 [INF] Route matched with {action = "AddToCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddToCart(BookStoreMVC.Models.ViewModels.AddToCartViewModel) on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-23 11:19:49.274 +07:00 [INF] AddToCart request - BookId: 2, Quantity: 1
2025-10-23 11:19:49.275 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-23 11:19:49.277 +07:00 [INF] === ADD TO CART START ===
2025-10-23 11:19:49.278 +07:00 [INF] UserId: 4b2ccf54-913b-4dfb-a99f-201f71a1b07b, BookId: 2, Quantity: 1
2025-10-23 11:19:49.279 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__model_BookId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM [Books] AS [b]
WHERE [b].[Id] = @__model_BookId_0
2025-10-23 11:19:49.281 +07:00 [INF] Book Found - Title: Nhật Ký Đặng Thùy Trâm - Ấn Bản Đặc Biệt 20 Năm Thành Lập Nhã Nam (Bìa Cứng), Stock: 100, IsActive: true
2025-10-23 11:19:49.283 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450), @__model_BookId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId]
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0 AND [c].[BookId] = @__model_BookId_1
2025-10-23 11:19:49.284 +07:00 [INF] Cart Status - Current: 0, Adding: 1, New Total: 1
2025-10-23 11:19:49.285 +07:00 [INF] Creating new cart item with quantity 1
2025-10-23 11:19:49.287 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-10-23 11:19:49.288 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Int32), @p3='?' (DbType = DateTime2), @p4='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [CartItems] ([BookId], [CreatedAt], [Quantity], [UpdatedAt], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-10-23 11:19:49.293 +07:00 [INF] === ADD TO CART SUCCESS ===
2025-10-23 11:19:49.294 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([c].[Quantity]), 0)
FROM [CartItems] AS [c]
WHERE [c].[UserId] = @__userId_0
2025-10-23 11:19:49.295 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType20`3[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-23 11:19:49.296 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC) in 22.3004ms
2025-10-23 11:19:49.296 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.AddToCart (BookStoreMVC)'
2025-10-23 11:19:49.298 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Cart/AddToCart - 200 null application/json; charset=utf-8 30.6729ms
2025-10-23 11:19:50.542 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/cart - null null
2025-10-23 11:19:50.544 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-23 11:19:50.545 +07:00 [INF] Route matched with {action = "Index", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.CartController (BookStoreMVC).
2025-10-23 11:19:50.549 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[Id], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [CartItems] AS [c]
LEFT JOIN [Books] AS [b] ON [c].[BookId] = [b].[Id]
LEFT JOIN [Categories] AS [c0] ON [b].[CategoryId] = [c0].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [c].[UserId] = @__userId_0
ORDER BY [c].[CreatedAt], [c].[Id], [b].[Id], [c0].[Id]
2025-10-23 11:19:50.551 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 11:19:50.553 +07:00 [INF] Executed ViewResult - view Index executed in 2.0072ms.
2025-10-23 11:19:50.554 +07:00 [INF] Executed action BookStoreMVC.Controllers.CartController.Index (BookStoreMVC) in 6.9993ms
2025-10-23 11:19:50.555 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.CartController.Index (BookStoreMVC)'
2025-10-23 11:19:50.556 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/cart - 200 null text/html; charset=utf-8 13.1718ms
2025-10-23 11:19:55.650 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/Orders/Checkout - null null
2025-10-23 11:19:55.654 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 11:19:55.656 +07:00 [INF] Route matched with {action = "Checkout", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Checkout() on controller BookStoreMVC.Controllers.OrdersController (BookStoreMVC).
2025-10-23 11:19:55.658 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[BookId], [c].[CreatedAt], [c].[Quantity], [c].[UpdatedAt], [c].[UserId], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[Id], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM [CartItems] AS [c]
LEFT JOIN [Books] AS [b] ON [c].[BookId] = [b].[Id]
LEFT JOIN [Categories] AS [c0] ON [b].[CategoryId] = [c0].[Id]
LEFT JOIN [Reviews] AS [r] ON [b].[Id] = [r].[BookId]
WHERE [c].[UserId] = @__userId_0
ORDER BY [c].[CreatedAt], [c].[Id], [b].[Id], [c0].[Id]
2025-10-23 11:19:55.663 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-10-23 11:19:55.664 +07:00 [INF] Executing ViewResult, running view Checkout.
2025-10-23 11:19:55.667 +07:00 [INF] Executed ViewResult - view Checkout executed in 2.6953ms.
2025-10-23 11:19:55.667 +07:00 [INF] Executed action BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC) in 10.8046ms
2025-10-23 11:19:55.668 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.OrdersController.Checkout (BookStoreMVC)'
2025-10-23 11:19:55.669 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/Orders/Checkout - 200 null text/html; charset=utf-8 18.5753ms
2025-10-23 11:19:55.679 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/momo-logo.png - null null
2025-10-23 11:19:55.681 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/momo-logo.png - 404 0 null 2.5705ms
2025-10-23 11:19:55.682 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/zalopay-logo.png - null null
2025-10-23 11:19:55.684 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/viettelpay-logo.png - null null
2025-10-23 11:19:55.684 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/momo-logo.png, Response status code: 404
2025-10-23 11:19:55.686 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/zalopay-logo.png - 404 0 null 3.4615ms
2025-10-23 11:19:55.687 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/viettelpay-logo.png - 404 0 null 3.3291ms
2025-10-23 11:19:55.687 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/images/shopeepay-logo.png - null null
2025-10-23 11:19:55.689 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/zalopay-logo.png, Response status code: 404
2025-10-23 11:19:55.690 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/viettelpay-logo.png, Response status code: 404
2025-10-23 11:19:55.693 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/images/shopeepay-logo.png - 404 0 null 5.392ms
2025-10-23 11:19:55.695 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/images/shopeepay-logo.png, Response status code: 404
2025-10-23 11:22:24.749 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/account/Logout - application/x-www-form-urlencoded 225
2025-10-23 11:22:24.752 +07:00 [INF] CORS policy execution failed.
2025-10-23 11:22:24.752 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 11:22:24.754 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC)'
2025-10-23 11:22:24.757 +07:00 [INF] Route matched with {action = "Logout", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-23 11:22:24.762 +07:00 [INF] AuthenticationScheme: Identity.Application signed out.
2025-10-23 11:22:24.763 +07:00 [INF] AuthenticationScheme: Identity.External signed out.
2025-10-23 11:22:24.764 +07:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2025-10-23 11:22:24.765 +07:00 [INF] User logged out.
2025-10-23 11:22:24.765 +07:00 [INF] Executing RedirectResult, redirecting to /.
2025-10-23 11:22:24.766 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC) in 8.1039ms
2025-10-23 11:22:24.767 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC)'
2025-10-23 11:22:24.767 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/account/Logout - 302 0 null 18.637ms
2025-10-23 11:22:24.770 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-23 11:22:24.772 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 11:22:24.772 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-23 11:22:24.783 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-23 11:22:24.791 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-23 11:22:24.800 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 11:22:24.805 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-23 11:22:24.808 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 11:22:24.812 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 11:22:24.814 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 11:22:24.818 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 11:22:24.824 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-23 11:22:24.828 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-23 11:22:24.834 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 11:22:24.837 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 11:22:24.841 +07:00 [INF] Executed ViewResult - view Index executed in 4.5568ms.
2025-10-23 11:22:24.842 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 68.5416ms
2025-10-23 11:22:24.842 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 11:22:24.843 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 73.04ms
2025-10-23 11:22:26.168 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/account/Login - null null
2025-10-23 11:22:26.171 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-23 11:22:26.173 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-23 11:22:26.176 +07:00 [INF] Executing ViewResult, running view Login.
2025-10-23 11:22:26.196 +07:00 [INF] Executed ViewResult - view Login executed in 20.4236ms.
2025-10-23 11:22:26.197 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 23.5568ms
2025-10-23 11:22:26.198 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-23 11:22:26.199 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/account/Login - 200 null text/html; charset=utf-8 31.546ms
2025-10-23 11:22:26.212 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - null null
2025-10-23 11:22:26.212 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - null null
2025-10-23 11:22:26.214 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - 404 0 null 2.0781ms
2025-10-23 11:22:26.215 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - 404 0 null 3.2211ms
2025-10-23 11:22:26.216 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/bookverse-core.js, Response status code: 404
2025-10-23 11:22:26.217 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/auth-validation.js, Response status code: 404
2025-10-23 11:22:51.037 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/account/Login - application/x-www-form-urlencoded 248
2025-10-23 11:22:51.040 +07:00 [INF] CORS policy execution failed.
2025-10-23 11:22:51.040 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 11:22:51.041 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-23 11:22:51.045 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BookStoreMVC.Models.ViewModels.LoginViewModel, System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-23 11:22:51.059 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-10-23 11:22:51.137 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2025-10-23 11:22:51.143 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-10-23 11:22:51.145 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-23 11:22:51.149 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2025-10-23 11:22:51.152 +07:00 [INF] AuthenticationScheme: Identity.Application signed in.
2025-10-23 11:22:51.154 +07:00 [INF] User logged in.
2025-10-23 11:22:51.154 +07:00 [INF] Executing RedirectResult, redirecting to /.
2025-10-23 11:22:51.155 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 108.5425ms
2025-10-23 11:22:51.156 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-23 11:22:51.156 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/account/Login - 302 0 null 118.9664ms
2025-10-23 11:22:51.158 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-23 11:22:51.159 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 11:22:51.160 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-23 11:22:51.162 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-23 11:22:51.167 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-23 11:22:51.170 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 11:22:51.172 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-23 11:22:51.174 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 11:22:51.175 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 11:22:51.176 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 11:22:51.178 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 11:22:51.179 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-23 11:22:51.183 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-23 11:22:51.185 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 11:22:51.188 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 11:22:51.190 +07:00 [INF] Executed ViewResult - view Index executed in 2.0505ms.
2025-10-23 11:22:51.190 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 29.5769ms
2025-10-23 11:22:51.191 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 11:22:51.192 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 33.5882ms
2025-10-23 11:22:54.994 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin - null null
2025-10-23 11:22:54.998 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.Dashboard (BookStoreMVC)'
2025-10-23 11:22:55.005 +07:00 [INF] Route matched with {action = "Dashboard", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Dashboard() on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-23 11:22:55.017 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 11:22:55.024 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-23 11:22:55.033 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-10-23 11:22:55.039 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
2025-10-23 11:22:55.041 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 11:22:55.047 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[Status] = 0
2025-10-23 11:22:55.052 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] <= 10
2025-10-23 11:22:55.056 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(0 AS bit)
2025-10-23 11:22:55.067 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[UserId], [o0].[Status], [o0].[Total], [o0].[CreatedAt], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM (
    SELECT TOP(@__p_0) [o].[Id], [o].[CreatedAt], [o].[Status], [o].[Total], [o].[UserId]
    FROM [Orders] AS [o]
    ORDER BY [o].[CreatedAt] DESC
) AS [o0]
INNER JOIN [AspNetUsers] AS [a] ON [o0].[UserId] = [a].[Id]
ORDER BY [o0].[CreatedAt] DESC
2025-10-23 11:22:55.078 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[Rating], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM (
    SELECT TOP(@__p_0) [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    ORDER BY [r].[CreatedAt] DESC
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 11:22:55.086 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
ORDER BY [a].[CreatedAt] DESC
2025-10-23 11:22:55.089 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-10-23 11:22:55.096 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[Title], [b0].[Author], [b0].[StockQuantity], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[Author], [b].[CategoryId], [b].[StockQuantity], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] <= 10
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
2025-10-23 11:22:55.115 +07:00 [ERR] Error getting monthly revenue
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => (int)o.Status == 3 && o.CreatedAt >= __startDate_0)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month
     })
    .Select(g => new { 
        Date = new DateTime(
            g.Key.Year, 
            g.Key.Month, 
            1
        ), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total)
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at BookStoreMVC.Services.OrderService.GetMonthlyRevenueAsync(Int32 months) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Services\OrderService.cs:line 311
2025-10-23 11:22:55.147 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
ORDER BY [o].[Status]
2025-10-23 11:22:55.156 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Name], (
    SELECT COUNT(*)
    FROM [Books] AS [b]
    WHERE [c].[Id] = [b].[CategoryId] AND [b].[IsActive] = CAST(1 AS bit)) AS [Count]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
2025-10-23 11:22:55.162 +07:00 [ERR] Error getting user registrations
System.InvalidOperationException: The LINQ expression 'DbSet<User>()
    .Where(u => u.CreatedAt >= __startDate_0)
    .GroupBy(u => new { 
        Year = u.CreatedAt.Year, 
        Month = u.CreatedAt.Month
     })
    .Select(g => new { 
        Date = new DateTime(
            g.Key.Year, 
            g.Key.Month, 
            1
        ), 
        Count = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at BookStoreMVC.Services.UserService.GetUserRegistrationsAsync(Int32 months) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Services\UserService.cs:line 202
2025-10-23 11:22:55.172 +07:00 [INF] Executing ViewResult, running view Dashboard.
2025-10-23 11:22:55.234 +07:00 [INF] Executed ViewResult - view Dashboard executed in 63.0087ms.
2025-10-23 11:22:55.237 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.Dashboard (BookStoreMVC) in 230.1351ms
2025-10-23 11:22:55.237 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.Dashboard (BookStoreMVC)'
2025-10-23 11:22:55.238 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin - 200 null text/html; charset=utf-8 244.1855ms
2025-10-23 11:22:55.256 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/admin.js?v=zlE_1g2uPXi4gKuQMdTqq6d7eO2vOH8vl_YJKJBSo-w - null null
2025-10-23 11:22:55.259 +07:00 [INF] The file /js/admin.js was not modified
2025-10-23 11:22:55.260 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/admin.js?v=zlE_1g2uPXi4gKuQMdTqq6d7eO2vOH8vl_YJKJBSo-w - 304 null text/javascript 4.0153ms
2025-10-23 11:22:55.641 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin/dashboard/stats - null null
2025-10-23 11:22:55.645 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.GetDashboardStats (BookStoreMVC)'
2025-10-23 11:22:55.648 +07:00 [INF] Route matched with {action = "GetDashboardStats", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetDashboardStats() on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-23 11:22:55.653 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 11:22:55.655 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-23 11:22:55.656 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-10-23 11:22:55.665 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 11:22:55.668 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
ORDER BY [o].[Status]
2025-10-23 11:22:55.670 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] <= 10
2025-10-23 11:22:55.673 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
2025-10-23 11:22:55.675 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(0 AS bit)
2025-10-23 11:22:55.684 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT AVG(CAST([r].[Rating] AS float))
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 11:22:55.686 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-23 11:22:55.693 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.GetDashboardStats (BookStoreMVC) in 44.0062ms
2025-10-23 11:22:55.694 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.GetDashboardStats (BookStoreMVC)'
2025-10-23 11:22:55.696 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin/dashboard/stats - 200 null application/json; charset=utf-8 54.3791ms
2025-10-23 11:23:04.826 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin/categories - null null
2025-10-23 11:23:04.830 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.Categories (BookStoreMVC)'
2025-10-23 11:23:04.832 +07:00 [INF] Route matched with {action = "Categories", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Categories() on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-23 11:23:04.839 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-23 11:23:04.844 +07:00 [INF] Executing ViewResult, running view Categories.
2025-10-23 11:23:04.857 +07:00 [INF] Executed ViewResult - view Categories executed in 13.0264ms.
2025-10-23 11:23:04.858 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.Categories (BookStoreMVC) in 23.9055ms
2025-10-23 11:23:04.858 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.Categories (BookStoreMVC)'
2025-10-23 11:23:04.859 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin/categories - 200 null text/html; charset=utf-8 33.2121ms
2025-10-23 11:23:06.089 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin/orders - null null
2025-10-23 11:23:06.093 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.Orders (BookStoreMVC)'
2025-10-23 11:23:06.097 +07:00 [INF] Route matched with {action = "Orders", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Orders(System.String) on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-23 11:23:06.105 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-10-23 11:23:06.133 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[Discount], [o0].[PaymentId], [o0].[ShippingInfoId], [o0].[Status], [o0].[SubTotal], [o0].[Tax], [o0].[Total], [o0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [s].[Id], [s].[Address], [s].[City], [s].[Country], [s].[FirstName], [s].[LastName], [s].[Phone], [s].[PostalCode], [p].[Id], [p].[Amount], [p].[CreatedAt], [p].[Method], [p].[OrderId], [p].[Status], [p].[TransactionId], [s0].[Id], [s0].[BookId], [s0].[OrderId], [s0].[Quantity], [s0].[Total], [s0].[UnitPrice], [s0].[Id0], [s0].[AdditionalImages], [s0].[Author], [s0].[CategoryId], [s0].[CreatedAt], [s0].[Description], [s0].[DiscountPrice], [s0].[ImageContentType], [s0].[ImageFileName], [s0].[ImageFileSize], [s0].[ImageUrl], [s0].[IsActive], [s0].[Language], [s0].[PageCount], [s0].[Price], [s0].[PublishDate], [s0].[Publisher], [s0].[StockQuantity], [s0].[Title], [s0].[UpdatedAt]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
    FROM [Orders] AS [o]
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [o0]
INNER JOIN [AspNetUsers] AS [a] ON [o0].[UserId] = [a].[Id]
INNER JOIN [ShippingInfos] AS [s] ON [o0].[ShippingInfoId] = [s].[Id]
LEFT JOIN [Payments] AS [p] ON [o0].[Id] = [p].[OrderId]
LEFT JOIN (
    SELECT [o1].[Id], [o1].[BookId], [o1].[OrderId], [o1].[Quantity], [o1].[Total], [o1].[UnitPrice], [b].[Id] AS [Id0], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [OrderItems] AS [o1]
    LEFT JOIN [Books] AS [b] ON [o1].[BookId] = [b].[Id]
) AS [s0] ON [o0].[Id] = [s0].[OrderId]
ORDER BY [o0].[CreatedAt] DESC, [o0].[Id], [a].[Id], [s].[Id], [p].[Id], [s0].[Id]
2025-10-23 11:23:06.142 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
ORDER BY [o].[Status]
2025-10-23 11:23:06.149 +07:00 [INF] Executing ViewResult, running view Orders.
2025-10-23 11:23:06.163 +07:00 [INF] Executed ViewResult - view Orders executed in 14.4561ms.
2025-10-23 11:23:06.166 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.Orders (BookStoreMVC) in 67.1664ms
2025-10-23 11:23:06.167 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.Orders (BookStoreMVC)'
2025-10-23 11:23:06.168 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin/orders - 200 null text/html; charset=utf-8 78.8295ms
2025-10-23 11:23:19.306 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin/orders/details/2 - null null
2025-10-23 11:23:19.309 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.OrderDetails (BookStoreMVC)'
2025-10-23 11:23:19.312 +07:00 [INF] Route matched with {action = "OrderDetails", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] OrderDetails(Int32) on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-23 11:23:19.323 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__orderId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s0].[Id], [s0].[CreatedAt], [s0].[Discount], [s0].[PaymentId], [s0].[ShippingInfoId], [s0].[Status], [s0].[SubTotal], [s0].[Tax], [s0].[Total], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [s0].[Id1], [s0].[Address], [s0].[City], [s0].[Country], [s0].[FirstName], [s0].[LastName], [s0].[Phone], [s0].[PostalCode], [s0].[Id2], [s0].[Amount], [s0].[CreatedAt1], [s0].[Method], [s0].[OrderId], [s0].[Status0], [s0].[TransactionId], [s1].[Id], [s1].[BookId], [s1].[OrderId], [s1].[Quantity], [s1].[Total], [s1].[UnitPrice], [s1].[Id0], [s1].[AdditionalImages], [s1].[Author], [s1].[CategoryId], [s1].[CreatedAt], [s1].[Description], [s1].[DiscountPrice], [s1].[ImageContentType], [s1].[ImageFileName], [s1].[ImageFileSize], [s1].[ImageUrl], [s1].[IsActive], [s1].[Language], [s1].[PageCount], [s1].[Price], [s1].[PublishDate], [s1].[Publisher], [s1].[StockQuantity], [s1].[Title], [s1].[UpdatedAt], [s1].[Id1], [s1].[CreatedAt0], [s1].[Description0], [s1].[ImageUrl0], [s1].[IsActive0], [s1].[Name], [s1].[ParentCategoryId]
FROM (
    SELECT TOP(1) [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [s].[Id] AS [Id1], [s].[Address], [s].[City], [s].[Country], [s].[FirstName], [s].[LastName], [s].[Phone], [s].[PostalCode], [p].[Id] AS [Id2], [p].[Amount], [p].[CreatedAt] AS [CreatedAt1], [p].[Method], [p].[OrderId], [p].[Status] AS [Status0], [p].[TransactionId]
    FROM [Orders] AS [o]
    INNER JOIN [AspNetUsers] AS [a] ON [o].[UserId] = [a].[Id]
    INNER JOIN [ShippingInfos] AS [s] ON [o].[ShippingInfoId] = [s].[Id]
    LEFT JOIN [Payments] AS [p] ON [o].[Id] = [p].[OrderId]
    WHERE [o].[Id] = @__orderId_0
) AS [s0]
LEFT JOIN (
    SELECT [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice], [b].[Id] AS [Id0], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id1], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [OrderItems] AS [o0]
    LEFT JOIN [Books] AS [b] ON [o0].[BookId] = [b].[Id]
    LEFT JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
) AS [s1] ON [s0].[Id] = [s1].[OrderId]
ORDER BY [s0].[Id], [s0].[Id0], [s0].[Id1], [s0].[Id2], [s1].[Id], [s1].[Id0]
2025-10-23 11:23:19.334 +07:00 [INF] Executing ViewResult, running view OrderDetails.
2025-10-23 11:23:19.340 +07:00 [INF] Executed ViewResult - view OrderDetails executed in 12.2889ms.
2025-10-23 11:23:19.342 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.OrderDetails (BookStoreMVC) in 29.3216ms
2025-10-23 11:23:19.344 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.OrderDetails (BookStoreMVC)'
2025-10-23 11:23:19.345 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin/orders/details/2 - 200 null text/html; charset=utf-8 38.5307ms
2025-10-23 11:23:27.254 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/Admin/UpdateOrderStatus - application/x-www-form-urlencoded; charset=UTF-8 245
2025-10-23 11:23:27.258 +07:00 [INF] CORS policy execution failed.
2025-10-23 11:23:27.258 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 11:23:27.261 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/Admin/UpdateOrderStatus - 404 0 null 7.3642ms
2025-10-23 11:23:27.263 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST http://localhost:5000/Admin/UpdateOrderStatus, Response status code: 404
2025-10-23 11:23:35.855 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin/orders/details/1 - null null
2025-10-23 11:23:35.860 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.OrderDetails (BookStoreMVC)'
2025-10-23 11:23:35.861 +07:00 [INF] Route matched with {action = "OrderDetails", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] OrderDetails(Int32) on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-23 11:23:35.864 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__orderId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s0].[Id], [s0].[CreatedAt], [s0].[Discount], [s0].[PaymentId], [s0].[ShippingInfoId], [s0].[Status], [s0].[SubTotal], [s0].[Tax], [s0].[Total], [s0].[UserId], [s0].[Id0], [s0].[AccessFailedCount], [s0].[ConcurrencyStamp], [s0].[CreatedAt0], [s0].[Email], [s0].[EmailConfirmed], [s0].[LockoutEnabled], [s0].[LockoutEnd], [s0].[Name], [s0].[NormalizedEmail], [s0].[NormalizedUserName], [s0].[PasswordHash], [s0].[PhoneNumber], [s0].[PhoneNumberConfirmed], [s0].[SecurityStamp], [s0].[TwoFactorEnabled], [s0].[UserName], [s0].[Id1], [s0].[Address], [s0].[City], [s0].[Country], [s0].[FirstName], [s0].[LastName], [s0].[Phone], [s0].[PostalCode], [s0].[Id2], [s0].[Amount], [s0].[CreatedAt1], [s0].[Method], [s0].[OrderId], [s0].[Status0], [s0].[TransactionId], [s1].[Id], [s1].[BookId], [s1].[OrderId], [s1].[Quantity], [s1].[Total], [s1].[UnitPrice], [s1].[Id0], [s1].[AdditionalImages], [s1].[Author], [s1].[CategoryId], [s1].[CreatedAt], [s1].[Description], [s1].[DiscountPrice], [s1].[ImageContentType], [s1].[ImageFileName], [s1].[ImageFileSize], [s1].[ImageUrl], [s1].[IsActive], [s1].[Language], [s1].[PageCount], [s1].[Price], [s1].[PublishDate], [s1].[Publisher], [s1].[StockQuantity], [s1].[Title], [s1].[UpdatedAt], [s1].[Id1], [s1].[CreatedAt0], [s1].[Description0], [s1].[ImageUrl0], [s1].[IsActive0], [s1].[Name], [s1].[ParentCategoryId]
FROM (
    SELECT TOP(1) [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId], [a].[Id] AS [Id0], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt] AS [CreatedAt0], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [s].[Id] AS [Id1], [s].[Address], [s].[City], [s].[Country], [s].[FirstName], [s].[LastName], [s].[Phone], [s].[PostalCode], [p].[Id] AS [Id2], [p].[Amount], [p].[CreatedAt] AS [CreatedAt1], [p].[Method], [p].[OrderId], [p].[Status] AS [Status0], [p].[TransactionId]
    FROM [Orders] AS [o]
    INNER JOIN [AspNetUsers] AS [a] ON [o].[UserId] = [a].[Id]
    INNER JOIN [ShippingInfos] AS [s] ON [o].[ShippingInfoId] = [s].[Id]
    LEFT JOIN [Payments] AS [p] ON [o].[Id] = [p].[OrderId]
    WHERE [o].[Id] = @__orderId_0
) AS [s0]
LEFT JOIN (
    SELECT [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice], [b].[Id] AS [Id0], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id] AS [Id1], [c].[CreatedAt] AS [CreatedAt0], [c].[Description] AS [Description0], [c].[ImageUrl] AS [ImageUrl0], [c].[IsActive] AS [IsActive0], [c].[Name], [c].[ParentCategoryId]
    FROM [OrderItems] AS [o0]
    LEFT JOIN [Books] AS [b] ON [o0].[BookId] = [b].[Id]
    LEFT JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
) AS [s1] ON [s0].[Id] = [s1].[OrderId]
ORDER BY [s0].[Id], [s0].[Id0], [s0].[Id1], [s0].[Id2], [s1].[Id], [s1].[Id0]
2025-10-23 11:23:35.867 +07:00 [INF] Executing ViewResult, running view OrderDetails.
2025-10-23 11:23:35.869 +07:00 [INF] Executed ViewResult - view OrderDetails executed in 1.6241ms.
2025-10-23 11:23:35.869 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.OrderDetails (BookStoreMVC) in 7.5563ms
2025-10-23 11:23:35.870 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.OrderDetails (BookStoreMVC)'
2025-10-23 11:23:35.871 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin/orders/details/1 - 200 null text/html; charset=utf-8 16.1557ms
2025-10-23 11:23:40.063 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin/users/details/4b2ccf54-913b-4dfb-a99f-201f71a1b07b - null null
2025-10-23 11:23:40.065 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.UserDetails (BookStoreMVC)'
2025-10-23 11:23:40.069 +07:00 [INF] Route matched with {action = "UserDetails", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UserDetails(System.String) on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-23 11:23:40.079 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-10-23 11:23:40.084 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[UserId] = @__userId_0
2025-10-23 11:23:40.090 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[UserId] = @__userId_0 AND [o].[Status] = 3
2025-10-23 11:23:40.097 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[UserId] = @__userId_0
2025-10-23 11:23:40.102 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [WishlistItems] AS [w]
WHERE [w].[UserId] = @__userId_0
2025-10-23 11:23:40.120 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [o1].[Id], [o1].[Status], [o1].[Total], [o1].[CreatedAt], [s].[Id], [s].[BookId], [s].[BookTitle], [s].[BookAuthor], [s].[BookImageUrl], [s].[Quantity], [s].[UnitPrice], [s].[Total], [s].[Id0]
FROM (
    SELECT TOP(@__p_1) [o].[Id], [o].[Status], [o].[Total], [o].[CreatedAt]
    FROM [Orders] AS [o]
    WHERE [o].[UserId] = @__userId_0
    ORDER BY [o].[CreatedAt] DESC
) AS [o1]
LEFT JOIN (
    SELECT [o0].[Id], [o0].[BookId], [b].[Title] AS [BookTitle], [b].[Author] AS [BookAuthor], [b].[ImageUrl] AS [BookImageUrl], [o0].[Quantity], [o0].[UnitPrice], [o0].[Total], [b].[Id] AS [Id0], [o0].[OrderId]
    FROM [OrderItems] AS [o0]
    LEFT JOIN [Books] AS [b] ON [o0].[BookId] = [b].[Id]
) AS [s] ON [o1].[Id] = [s].[OrderId]
ORDER BY [o1].[CreatedAt] DESC, [o1].[Id], [s].[Id]
2025-10-23 11:23:40.132 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Rating], [r0].[Comment], [r0].[CreatedAt], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM (
    SELECT TOP(@__p_1) [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[Rating]
    FROM [Reviews] AS [r]
    WHERE [r].[UserId] = @__userId_0
    ORDER BY [r].[CreatedAt] DESC
) AS [r0]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 11:23:40.135 +07:00 [INF] Executing ViewResult, running view UserDetails.
2025-10-23 11:23:40.141 +07:00 [INF] Executed ViewResult - view UserDetails executed in 5.5458ms.
2025-10-23 11:23:40.143 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.UserDetails (BookStoreMVC) in 72.7093ms
2025-10-23 11:23:40.145 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.UserDetails (BookStoreMVC)'
2025-10-23 11:23:40.146 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin/users/details/4b2ccf54-913b-4dfb-a99f-201f71a1b07b - 200 null text/html; charset=utf-8 82.8828ms
2025-10-23 11:23:45.447 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin/users - null null
2025-10-23 11:23:45.449 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.Users (BookStoreMVC)'
2025-10-23 11:23:45.452 +07:00 [INF] Route matched with {action = "Users", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Users() on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-23 11:23:45.457 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
ORDER BY [a].[CreatedAt] DESC
2025-10-23 11:23:45.460 +07:00 [INF] Executing ViewResult, running view Users.
2025-10-23 11:23:45.466 +07:00 [INF] Executed ViewResult - view Users executed in 6.6214ms.
2025-10-23 11:23:45.467 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.Users (BookStoreMVC) in 12.9838ms
2025-10-23 11:23:45.468 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.Users (BookStoreMVC)'
2025-10-23 11:23:45.468 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin/users - 200 null text/html; charset=utf-8 21.326ms
2025-10-23 11:23:46.154 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin/reviews - null null
2025-10-23 11:23:46.158 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.Reviews (BookStoreMVC)'
2025-10-23 11:23:46.164 +07:00 [INF] Route matched with {action = "Reviews", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Reviews(BookStoreMVC.Models.ViewModels.ReviewListViewModel) on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-23 11:23:46.174 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 11:23:46.179 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 11:23:46.182 +07:00 [INF] Executing ViewResult, running view Reviews.
2025-10-23 11:23:46.194 +07:00 [INF] Executed ViewResult - view Reviews executed in 11.6961ms.
2025-10-23 11:23:46.195 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.Reviews (BookStoreMVC) in 30.2451ms
2025-10-23 11:23:46.196 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.Reviews (BookStoreMVC)'
2025-10-23 11:23:46.197 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin/reviews - 200 null text/html; charset=utf-8 42.8216ms
2025-10-23 11:23:48.505 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin/reports - null null
2025-10-23 11:23:48.508 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.Reports (BookStoreMVC)'
2025-10-23 11:23:48.511 +07:00 [INF] Route matched with {action = "Reports", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Reports() on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-23 11:23:48.515 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 11:23:48.518 +07:00 [ERR] Error getting monthly revenue
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => (int)o.Status == 3 && o.CreatedAt >= __startDate_0)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month
     })
    .Select(g => new { 
        Date = new DateTime(
            g.Key.Year, 
            g.Key.Month, 
            1
        ), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total)
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at BookStoreMVC.Services.OrderService.GetMonthlyRevenueAsync(Int32 months) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Services\OrderService.cs:line 311
2025-10-23 11:23:48.525 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
ORDER BY [o].[Status]
2025-10-23 11:23:48.527 +07:00 [ERR] Error getting user registrations
System.InvalidOperationException: The LINQ expression 'DbSet<User>()
    .Where(u => u.CreatedAt >= __startDate_0)
    .GroupBy(u => new { 
        Year = u.CreatedAt.Year, 
        Month = u.CreatedAt.Month
     })
    .Select(g => new { 
        Date = new DateTime(
            g.Key.Year, 
            g.Key.Month, 
            1
        ), 
        Count = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at BookStoreMVC.Services.UserService.GetUserRegistrationsAsync(Int32 months) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Services\UserService.cs:line 202
2025-10-23 11:23:48.544 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[BookId], [b].[Title], COALESCE(SUM([o].[Quantity]), 0) AS [QuantitySold], COALESCE(SUM([o].[Total]), 0.0) AS [Revenue]
FROM [OrderItems] AS [o]
LEFT JOIN [Books] AS [b] ON [o].[BookId] = [b].[Id]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
WHERE [b].[Id] IS NOT NULL AND [o0].[Status] = 3
GROUP BY [o].[BookId], [b].[Title]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
2025-10-23 11:23:48.555 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[UserId], [a].[Name] AS [UserName], COUNT(*) AS [OrdersCount], COALESCE(SUM([o].[Total]), 0.0) AS [TotalSpent]
FROM [Orders] AS [o]
INNER JOIN [AspNetUsers] AS [a] ON [o].[UserId] = [a].[Id]
WHERE [o].[Status] = 3
GROUP BY [o].[UserId], [a].[Name]
ORDER BY COALESCE(SUM([o].[Total]), 0.0) DESC
2025-10-23 11:23:48.559 +07:00 [INF] Executing ViewResult, running view Reports.
2025-10-23 11:23:48.571 +07:00 [INF] Executed ViewResult - view Reports executed in 11.7921ms.
2025-10-23 11:23:48.572 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.Reports (BookStoreMVC) in 60.2763ms
2025-10-23 11:23:48.573 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.Reports (BookStoreMVC)'
2025-10-23 11:23:48.574 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin/reports - 200 null text/html; charset=utf-8 68.0883ms
2025-10-23 11:23:49.894 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin/reviews - null null
2025-10-23 11:23:49.897 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.Reviews (BookStoreMVC)'
2025-10-23 11:23:49.898 +07:00 [INF] Route matched with {action = "Reviews", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Reviews(BookStoreMVC.Models.ViewModels.ReviewListViewModel) on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-23 11:23:49.901 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 11:23:49.903 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 11:23:49.905 +07:00 [INF] Executing ViewResult, running view Reviews.
2025-10-23 11:23:49.907 +07:00 [INF] Executed ViewResult - view Reviews executed in 1.3989ms.
2025-10-23 11:23:49.908 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.Reviews (BookStoreMVC) in 8.7177ms
2025-10-23 11:23:49.908 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.Reviews (BookStoreMVC)'
2025-10-23 11:23:49.909 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin/reviews - 200 null text/html; charset=utf-8 15.08ms
2025-10-23 11:23:53.166 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin/dashboard - null null
2025-10-23 11:23:53.169 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.Dashboard (BookStoreMVC)'
2025-10-23 11:23:53.174 +07:00 [INF] Route matched with {action = "Dashboard", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Dashboard() on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-23 11:23:53.176 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 11:23:53.179 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-23 11:23:53.181 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-10-23 11:23:53.184 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
2025-10-23 11:23:53.185 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 11:23:53.187 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[Status] = 0
2025-10-23 11:23:53.189 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] <= 10
2025-10-23 11:23:53.190 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(0 AS bit)
2025-10-23 11:23:53.193 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[UserId], [o0].[Status], [o0].[Total], [o0].[CreatedAt], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM (
    SELECT TOP(@__p_0) [o].[Id], [o].[CreatedAt], [o].[Status], [o].[Total], [o].[UserId]
    FROM [Orders] AS [o]
    ORDER BY [o].[CreatedAt] DESC
) AS [o0]
INNER JOIN [AspNetUsers] AS [a] ON [o0].[UserId] = [a].[Id]
ORDER BY [o0].[CreatedAt] DESC
2025-10-23 11:23:53.198 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[Rating], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM (
    SELECT TOP(@__p_0) [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    ORDER BY [r].[CreatedAt] DESC
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 11:23:53.201 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
ORDER BY [a].[CreatedAt] DESC
2025-10-23 11:23:53.204 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[Title], [b0].[Author], [b0].[StockQuantity], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[Author], [b].[CategoryId], [b].[StockQuantity], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] <= 10
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
2025-10-23 11:23:53.206 +07:00 [ERR] Error getting monthly revenue
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => (int)o.Status == 3 && o.CreatedAt >= __startDate_0)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month
     })
    .Select(g => new { 
        Date = new DateTime(
            g.Key.Year, 
            g.Key.Month, 
            1
        ), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total)
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at BookStoreMVC.Services.OrderService.GetMonthlyRevenueAsync(Int32 months) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Services\OrderService.cs:line 311
2025-10-23 11:23:53.210 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
ORDER BY [o].[Status]
2025-10-23 11:23:53.215 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Name], (
    SELECT COUNT(*)
    FROM [Books] AS [b]
    WHERE [c].[Id] = [b].[CategoryId] AND [b].[IsActive] = CAST(1 AS bit)) AS [Count]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
2025-10-23 11:23:53.217 +07:00 [ERR] Error getting user registrations
System.InvalidOperationException: The LINQ expression 'DbSet<User>()
    .Where(u => u.CreatedAt >= __startDate_0)
    .GroupBy(u => new { 
        Year = u.CreatedAt.Year, 
        Month = u.CreatedAt.Month
     })
    .Select(g => new { 
        Date = new DateTime(
            g.Key.Year, 
            g.Key.Month, 
            1
        ), 
        Count = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at BookStoreMVC.Services.UserService.GetUserRegistrationsAsync(Int32 months) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Services\UserService.cs:line 202
2025-10-23 11:23:53.221 +07:00 [INF] Executing ViewResult, running view Dashboard.
2025-10-23 11:23:53.223 +07:00 [INF] Executed ViewResult - view Dashboard executed in 1.8106ms.
2025-10-23 11:23:53.223 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.Dashboard (BookStoreMVC) in 48.8179ms
2025-10-23 11:23:53.224 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.Dashboard (BookStoreMVC)'
2025-10-23 11:23:53.225 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin/dashboard - 200 null text/html; charset=utf-8 58.5543ms
2025-10-23 11:23:53.424 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin/dashboard/stats - null null
2025-10-23 11:23:53.426 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.GetDashboardStats (BookStoreMVC)'
2025-10-23 11:23:53.427 +07:00 [INF] Route matched with {action = "GetDashboardStats", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetDashboardStats() on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-23 11:23:53.429 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 11:23:53.432 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-23 11:23:53.434 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-10-23 11:23:53.437 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 11:23:53.438 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
ORDER BY [o].[Status]
2025-10-23 11:23:53.440 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] <= 10
2025-10-23 11:23:53.441 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
2025-10-23 11:23:53.442 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(0 AS bit)
2025-10-23 11:23:53.444 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT AVG(CAST([r].[Rating] AS float))
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 11:23:53.446 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-23 11:23:53.447 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.GetDashboardStats (BookStoreMVC) in 19.8444ms
2025-10-23 11:23:53.449 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.GetDashboardStats (BookStoreMVC)'
2025-10-23 11:23:53.450 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin/dashboard/stats - 200 null application/json; charset=utf-8 25.6671ms
2025-10-23 11:23:57.264 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin/categories/create - null null
2025-10-23 11:23:57.266 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.CreateCategory (BookStoreMVC)'
2025-10-23 11:23:57.270 +07:00 [INF] Route matched with {action = "CreateCategory", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCategory() on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-23 11:23:57.275 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-23 11:23:57.279 +07:00 [INF] Executing ViewResult, running view CreateCategory.
2025-10-23 11:23:57.297 +07:00 [INF] Executed ViewResult - view CreateCategory executed in 19.1077ms.
2025-10-23 11:23:57.300 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.CreateCategory (BookStoreMVC) in 28.9089ms
2025-10-23 11:23:57.301 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.CreateCategory (BookStoreMVC)'
2025-10-23 11:23:57.302 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin/categories/create - 200 null text/html; charset=utf-8 38.0761ms
2025-10-23 11:23:57.310 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/lib/jquery-validation/dist/jquery.validate.min.js - null null
2025-10-23 11:23:57.313 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js - null null
2025-10-23 11:23:57.315 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js - 404 0 null 2.1244ms
2025-10-23 11:23:57.317 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js, Response status code: 404
2025-10-23 11:23:57.362 +07:00 [INF] Sending file. Request path: '/lib/jquery-validation/dist/jquery.validate.min.js'. Physical path: 'C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\wwwroot\lib\jquery-validation\dist\jquery.validate.min.js'
2025-10-23 11:23:57.363 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/lib/jquery-validation/dist/jquery.validate.min.js - 200 25311 text/javascript 52.8897ms
2025-10-23 11:24:10.122 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin - null null
2025-10-23 11:24:10.130 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.Dashboard (BookStoreMVC)'
2025-10-23 11:24:10.134 +07:00 [INF] Route matched with {action = "Dashboard", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Dashboard() on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-23 11:24:10.138 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 11:24:10.142 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-23 11:24:10.144 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-10-23 11:24:10.148 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
2025-10-23 11:24:10.151 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 11:24:10.153 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[Status] = 0
2025-10-23 11:24:10.155 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] <= 10
2025-10-23 11:24:10.157 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(0 AS bit)
2025-10-23 11:24:10.158 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[UserId], [o0].[Status], [o0].[Total], [o0].[CreatedAt], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM (
    SELECT TOP(@__p_0) [o].[Id], [o].[CreatedAt], [o].[Status], [o].[Total], [o].[UserId]
    FROM [Orders] AS [o]
    ORDER BY [o].[CreatedAt] DESC
) AS [o0]
INNER JOIN [AspNetUsers] AS [a] ON [o0].[UserId] = [a].[Id]
ORDER BY [o0].[CreatedAt] DESC
2025-10-23 11:24:10.160 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[Rating], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
FROM (
    SELECT TOP(@__p_0) [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    ORDER BY [r].[CreatedAt] DESC
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 11:24:10.163 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
ORDER BY [a].[CreatedAt] DESC
2025-10-23 11:24:10.165 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[Title], [b0].[Author], [b0].[StockQuantity], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[Author], [b].[CategoryId], [b].[StockQuantity], [b].[Title]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] <= 10
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
2025-10-23 11:24:10.169 +07:00 [ERR] Error getting monthly revenue
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => (int)o.Status == 3 && o.CreatedAt >= __startDate_0)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month
     })
    .Select(g => new { 
        Date = new DateTime(
            g.Key.Year, 
            g.Key.Month, 
            1
        ), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total)
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at BookStoreMVC.Services.OrderService.GetMonthlyRevenueAsync(Int32 months) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Services\OrderService.cs:line 311
2025-10-23 11:24:10.174 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
ORDER BY [o].[Status]
2025-10-23 11:24:10.175 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Name], (
    SELECT COUNT(*)
    FROM [Books] AS [b]
    WHERE [c].[Id] = [b].[CategoryId] AND [b].[IsActive] = CAST(1 AS bit)) AS [Count]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
2025-10-23 11:24:10.177 +07:00 [ERR] Error getting user registrations
System.InvalidOperationException: The LINQ expression 'DbSet<User>()
    .Where(u => u.CreatedAt >= __startDate_0)
    .GroupBy(u => new { 
        Year = u.CreatedAt.Year, 
        Month = u.CreatedAt.Month
     })
    .Select(g => new { 
        Date = new DateTime(
            g.Key.Year, 
            g.Key.Month, 
            1
        ), 
        Count = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at BookStoreMVC.Services.UserService.GetUserRegistrationsAsync(Int32 months) in C:\Users\DELL\Desktop\Bán sách\BookStoreMWC\Services\UserService.cs:line 202
2025-10-23 11:24:10.181 +07:00 [INF] Executing ViewResult, running view Dashboard.
2025-10-23 11:24:10.182 +07:00 [INF] Executed ViewResult - view Dashboard executed in 1.2441ms.
2025-10-23 11:24:10.183 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.Dashboard (BookStoreMVC) in 46.549ms
2025-10-23 11:24:10.184 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.Dashboard (BookStoreMVC)'
2025-10-23 11:24:10.185 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin - 200 null text/html; charset=utf-8 63.0684ms
2025-10-23 11:24:10.436 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/admin/dashboard/stats - null null
2025-10-23 11:24:10.438 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AdminController.GetDashboardStats (BookStoreMVC)'
2025-10-23 11:24:10.439 +07:00 [INF] Route matched with {action = "GetDashboardStats", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetDashboardStats() on controller BookStoreMVC.Controllers.AdminController (BookStoreMVC).
2025-10-23 11:24:10.440 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 11:24:10.442 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit)
2025-10-23 11:24:10.443 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-10-23 11:24:10.445 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 11:24:10.447 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
ORDER BY [o].[Status]
2025-10-23 11:24:10.449 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] <= 10
2025-10-23 11:24:10.451 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
2025-10-23 11:24:10.452 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(0 AS bit)
2025-10-23 11:24:10.454 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT AVG(CAST([r].[Rating] AS float))
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 11:24:10.455 +07:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType1`2[[System.Boolean, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.Dictionary`2[[System.String, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Object, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-10-23 11:24:10.455 +07:00 [INF] Executed action BookStoreMVC.Controllers.AdminController.GetDashboardStats (BookStoreMVC) in 15.8671ms
2025-10-23 11:24:10.456 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AdminController.GetDashboardStats (BookStoreMVC)'
2025-10-23 11:24:10.457 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/admin/dashboard/stats - 200 null application/json; charset=utf-8 20.4907ms
2025-10-23 11:24:11.214 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-23 11:24:11.218 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 11:24:11.219 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-23 11:24:11.235 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-23 11:24:11.244 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-23 11:24:11.255 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 11:24:11.258 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-23 11:24:11.260 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 11:24:11.261 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 11:24:11.262 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 11:24:11.264 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 11:24:11.269 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-23 11:24:11.273 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-23 11:24:11.279 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 11:24:11.282 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 11:24:11.285 +07:00 [INF] Executed ViewResult - view Index executed in 3.0468ms.
2025-10-23 11:24:11.285 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 64.9359ms
2025-10-23 11:24:11.286 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 11:24:11.287 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 73.0446ms
2025-10-23 11:24:14.929 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-23 11:24:14.933 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 11:24:14.935 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-23 11:24:14.938 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-23 11:24:14.942 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-23 11:24:14.945 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 11:24:14.950 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-23 11:24:14.952 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 11:24:14.953 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 11:24:14.954 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 11:24:14.955 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 11:24:14.957 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-23 11:24:14.960 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-23 11:24:14.961 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 11:24:14.965 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 11:24:14.967 +07:00 [INF] Executed ViewResult - view Index executed in 2.5898ms.
2025-10-23 11:24:14.968 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 32.405ms
2025-10-23 11:24:14.969 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 11:24:14.970 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 40.2839ms
2025-10-23 11:24:15.008 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/favicon.ico - null null
2025-10-23 11:24:15.010 +07:00 [INF] The file /favicon.ico was not modified
2025-10-23 11:24:15.011 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/favicon.ico - 304 null image/x-icon 3.0655ms
2025-10-23 11:24:18.385 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/account/Logout - application/x-www-form-urlencoded 225
2025-10-23 11:24:18.387 +07:00 [INF] CORS policy execution failed.
2025-10-23 11:24:18.387 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 11:24:18.388 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC)'
2025-10-23 11:24:18.389 +07:00 [INF] Route matched with {action = "Logout", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout() on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-23 11:24:18.390 +07:00 [INF] AuthenticationScheme: Identity.Application signed out.
2025-10-23 11:24:18.390 +07:00 [INF] AuthenticationScheme: Identity.External signed out.
2025-10-23 11:24:18.391 +07:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2025-10-23 11:24:18.392 +07:00 [INF] User logged out.
2025-10-23 11:24:18.392 +07:00 [INF] Executing RedirectResult, redirecting to /.
2025-10-23 11:24:18.393 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC) in 3.962ms
2025-10-23 11:24:18.394 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Logout (BookStoreMVC)'
2025-10-23 11:24:18.395 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/account/Logout - 302 0 null 9.8739ms
2025-10-23 11:24:18.397 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-23 11:24:18.398 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 11:24:18.398 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-23 11:24:18.407 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-23 11:24:18.415 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-23 11:24:18.423 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 11:24:18.429 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-23 11:24:18.431 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 11:24:18.433 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 11:24:18.435 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 11:24:18.440 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 11:24:18.445 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-23 11:24:18.449 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-23 11:24:18.455 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 11:24:18.457 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 11:24:18.460 +07:00 [INF] Executed ViewResult - view Index executed in 3.2666ms.
2025-10-23 11:24:18.462 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 62.7496ms
2025-10-23 11:24:18.463 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 11:24:18.464 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 67.0822ms
2025-10-23 11:24:19.786 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/account/Login - null null
2025-10-23 11:24:19.788 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-23 11:24:19.789 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-23 11:24:19.790 +07:00 [INF] Executing ViewResult, running view Login.
2025-10-23 11:24:19.793 +07:00 [INF] Executed ViewResult - view Login executed in 2.6563ms.
2025-10-23 11:24:19.794 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 4.2442ms
2025-10-23 11:24:19.795 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-23 11:24:19.795 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/account/Login - 200 null text/html; charset=utf-8 8.9837ms
2025-10-23 11:24:19.806 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - null null
2025-10-23 11:24:19.807 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - null null
2025-10-23 11:24:19.809 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/bookverse-core.js - 404 0 null 2.249ms
2025-10-23 11:24:19.810 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/js/auth-validation.js - 404 0 null 3.5027ms
2025-10-23 11:24:19.812 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/bookverse-core.js, Response status code: 404
2025-10-23 11:24:19.813 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/js/auth-validation.js, Response status code: 404
2025-10-23 11:24:31.591 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/account/Login - application/x-www-form-urlencoded 241
2025-10-23 11:24:31.594 +07:00 [INF] CORS policy execution failed.
2025-10-23 11:24:31.595 +07:00 [INF] Request origin http://localhost:5000 does not have permission to access the resource.
2025-10-23 11:24:31.596 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-23 11:24:31.596 +07:00 [INF] Route matched with {action = "Login", controller = "Account"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BookStoreMVC.Models.ViewModels.LoginViewModel, System.String) on controller BookStoreMVC.Controllers.AccountController (BookStoreMVC).
2025-10-23 11:24:31.605 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-10-23 11:24:31.676 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__user_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[ClaimType], [a].[ClaimValue], [a].[UserId]
FROM [AspNetUserClaims] AS [a]
WHERE [a].[UserId] = @__user_Id_0
2025-10-23 11:24:31.681 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-10-23 11:24:31.685 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-10-23 11:24:31.688 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__role_Id_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[ClaimType], [a].[ClaimValue]
FROM [AspNetRoleClaims] AS [a]
WHERE [a].[RoleId] = @__role_Id_0
2025-10-23 11:24:31.689 +07:00 [INF] AuthenticationScheme: Identity.Application signed in.
2025-10-23 11:24:31.690 +07:00 [INF] User logged in.
2025-10-23 11:24:31.690 +07:00 [INF] Executing RedirectResult, redirecting to /.
2025-10-23 11:24:31.691 +07:00 [INF] Executed action BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC) in 93.3544ms
2025-10-23 11:24:31.691 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.AccountController.Login (BookStoreMVC)'
2025-10-23 11:24:31.692 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/account/Login - 302 0 null 100.5746ms
2025-10-23 11:24:31.694 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/ - null null
2025-10-23 11:24:31.695 +07:00 [INF] Executing endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 11:24:31.696 +07:00 [INF] Route matched with {action = "Index", controller = "Home"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Index() on controller BookStoreMVC.Controllers.HomeController (BookStoreMVC).
2025-10-23 11:24:31.706 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r2].[Id], [r2].[BookId], [r2].[Comment], [r2].[CreatedAt], [r2].[IsApproved], [r2].[IsVerifiedPurchase], [r2].[Rating], [r2].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) AS [c], CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COUNT(*)
        FROM [Reviews] AS [r]
        WHERE [b].[Id] = [r].[BookId]) DESC, CASE
        WHEN EXISTS (
            SELECT 1
            FROM [Reviews] AS [r0]
            WHERE [b].[Id] = [r0].[BookId]) THEN (
            SELECT AVG(CAST([r1].[Rating] AS float))
            FROM [Reviews] AS [r1]
            WHERE [b].[Id] = [r1].[BookId])
        ELSE 0.0E0
    END DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r2] ON [b0].[Id] = [r2].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0] DESC, [b0].[Id], [c].[Id]
2025-10-23 11:24:31.712 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY [b].[CreatedAt] DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
ORDER BY [b0].[CreatedAt] DESC, [b0].[Id], [c].[Id]
2025-10-23 11:24:31.722 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o0].[Id], [o0].[BookId], [o0].[OrderId], [o0].[Quantity], [o0].[Total], [o0].[UnitPrice]
FROM (
    SELECT TOP(@__p_0) [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) AS [c]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[StockQuantity] > 0
    ORDER BY (
        SELECT COALESCE(SUM([o].[Quantity]), 0)
        FROM [OrderItems] AS [o]
        WHERE [b].[Id] = [o].[BookId]) DESC
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o0] ON [b0].[Id] = [o0].[BookId]
ORDER BY [b0].[c] DESC, [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 11:24:31.726 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM [Categories] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[Name]
2025-10-23 11:24:31.728 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-10-23 11:24:31.730 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[CreatedAt], [o].[Discount], [o].[PaymentId], [o].[ShippingInfoId], [o].[Status], [o].[SubTotal], [o].[Tax], [o].[Total], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Status] = 3
2025-10-23 11:24:31.732 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Reviews] AS [r]
WHERE [r].[IsApproved] = CAST(1 AS bit)
2025-10-23 11:24:31.738 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r0].[Id], [r0].[BookId], [r0].[Comment], [r0].[CreatedAt], [r0].[IsApproved], [r0].[IsVerifiedPurchase], [r0].[Rating], [r0].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[CreatedAt], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[Name], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId]
FROM (
    SELECT [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId]
    FROM [Reviews] AS [r]
    WHERE [r].[IsApproved] = CAST(1 AS bit)
    ORDER BY [r].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [r0]
INNER JOIN [AspNetUsers] AS [a] ON [r0].[UserId] = [a].[Id]
INNER JOIN [Books] AS [b] ON [r0].[BookId] = [b].[Id]
INNER JOIN [Categories] AS [c] ON [b].[CategoryId] = [c].[Id]
ORDER BY [r0].[CreatedAt] DESC
2025-10-23 11:24:31.743 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [c0].[Id], [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], [c0].[CreatedAt], [c0].[Description], [c0].[ImageUrl], [c0].[IsActive], [c0].[Name], [c0].[ParentCategoryId], [c1].[Id], [c1].[CreatedAt], [c1].[Description], [c1].[ImageUrl], [c1].[IsActive], [c1].[Name], [c1].[ParentCategoryId]
FROM [Categories] AS [c]
LEFT JOIN [Categories] AS [c0] ON [c].[ParentCategoryId] = [c0].[Id]
LEFT JOIN [Books] AS [b] ON [c].[Id] = [b].[CategoryId]
LEFT JOIN [Categories] AS [c1] ON [c].[Id] = [c1].[ParentCategoryId]
ORDER BY [c].[Name], [c].[Id], [c0].[Id], [b].[Id]
2025-10-23 11:24:31.746 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Books] AS [b]
WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
2025-10-23 11:24:31.754 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [b0].[Id], [b0].[AdditionalImages], [b0].[Author], [b0].[CategoryId], [b0].[CreatedAt], [b0].[Description], [b0].[DiscountPrice], [b0].[ImageContentType], [b0].[ImageFileName], [b0].[ImageFileSize], [b0].[ImageUrl], [b0].[IsActive], [b0].[Language], [b0].[PageCount], [b0].[Price], [b0].[PublishDate], [b0].[Publisher], [b0].[StockQuantity], [b0].[Title], [b0].[UpdatedAt], [c].[Id], [c].[CreatedAt], [c].[Description], [c].[ImageUrl], [c].[IsActive], [c].[Name], [c].[ParentCategoryId], [r].[Id], [r].[BookId], [r].[Comment], [r].[CreatedAt], [r].[IsApproved], [r].[IsVerifiedPurchase], [r].[Rating], [r].[UserId], [o].[Id], [o].[BookId], [o].[OrderId], [o].[Quantity], [o].[Total], [o].[UnitPrice]
FROM (
    SELECT [b].[Id], [b].[AdditionalImages], [b].[Author], [b].[CategoryId], [b].[CreatedAt], [b].[Description], [b].[DiscountPrice], [b].[ImageContentType], [b].[ImageFileName], [b].[ImageFileSize], [b].[ImageUrl], [b].[IsActive], [b].[Language], [b].[PageCount], [b].[Price], [b].[PublishDate], [b].[Publisher], [b].[StockQuantity], [b].[Title], [b].[UpdatedAt], CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END AS [c], COALESCE([b].[DiscountPrice], [b].[Price]) AS [c0]
    FROM [Books] AS [b]
    WHERE [b].[IsActive] = CAST(1 AS bit) AND [b].[DiscountPrice] IS NOT NULL AND [b].[DiscountPrice] < [b].[Price]
    ORDER BY CASE
        WHEN [b].[DiscountPrice] IS NOT NULL THEN [b].[Price] - [b].[DiscountPrice]
        ELSE 0.0
    END DESC, COALESCE([b].[DiscountPrice], [b].[Price])
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [b0]
INNER JOIN [Categories] AS [c] ON [b0].[CategoryId] = [c].[Id]
LEFT JOIN [Reviews] AS [r] ON [b0].[Id] = [r].[BookId]
LEFT JOIN [OrderItems] AS [o] ON [b0].[Id] = [o].[BookId]
ORDER BY [b0].[c] DESC, [b0].[c0], [b0].[Id], [c].[Id], [r].[Id]
2025-10-23 11:24:31.756 +07:00 [INF] Executing ViewResult, running view Index.
2025-10-23 11:24:31.775 +07:00 [INF] Executed ViewResult - view Index executed in 18.9964ms.
2025-10-23 11:24:31.777 +07:00 [INF] Executed action BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC) in 80.4095ms
2025-10-23 11:24:31.778 +07:00 [INF] Executed endpoint 'BookStoreMVC.Controllers.HomeController.Index (BookStoreMVC)'
2025-10-23 11:24:31.779 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5000/ - 200 null text/html; charset=utf-8 84.6682ms
