@* Views/Admin/CreateBook.cshtml *@
@model BookStoreMVC.Models.ViewModels.BookViewModel
@{
    Layout = "_AdminLayout";
    ViewData["Title"] = "Thêm sách mới";
    ViewBag.PageTitle = "Thêm sách mới";
    ViewBag.ActiveMenu = "Books";
}

<!-- Success/Error Messages -->
@if (TempData["SuccessMessage"] != null)
{
    <div class="mb-6 bg-green-50 border border-green-200 text-green-600 px-4 py-3 rounded-lg">
        <div class="flex items-center">
            <i class="fas fa-check-circle mr-2"></i>
            <span>@TempData["SuccessMessage"]</span>
        </div>
    </div>
}

@if (TempData["ErrorMessage"] != null)
{
    <div class="mb-6 bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg">
        <div class="flex items-center">
            <i class="fas fa-exclamation-circle mr-2"></i>
            <span>@TempData["ErrorMessage"]</span>
        </div>
    </div>
}

<form asp-action="CreateBook" method="post" enctype="multipart/form-data" id="create-book-form" novalidate>
    @Html.AntiForgeryToken()

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Main Content -->
        <div class="lg:col-span-2 space-y-6">

            <!-- Basic Information -->
            <div class="bg-white rounded-lg shadow-sm border border-gray-200">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900 flex items-center">
                        <i class="fas fa-book text-primary-600 mr-2"></i>
                        Thông tin cơ bản
                    </h3>
                </div>
                <div class="p-6 space-y-6">
                    <!-- Title -->
                    <div>
                        <label asp-for="Title" class="block text-sm font-medium text-gray-700 mb-2">
                            Tiêu đề sách <span class="text-red-500">*</span>
                        </label>
                        <input asp-for="Title" type="text"
                            class="block w-full px-3 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                            placeholder="Nhập tiêu đề sách...">
                        <span asp-validation-for="Title" class="text-red-500 text-sm mt-1 block"></span>
                    </div>

                    <!-- Author -->
                    <div>
                        <label asp-for="Author" class="block text-sm font-medium text-gray-700 mb-2">
                            Tác giả <span class="text-red-500">*</span>
                        </label>
                        <input asp-for="Author" type="text"
                            class="block w-full px-3 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                            placeholder="Nhập tên tác giả...">
                        <span asp-validation-for="Author" class="text-red-500 text-sm mt-1 block"></span>
                    </div>

                    <!-- ISBN -->
                    @* <div>
                        <label asp-for="ISBN" class="block text-sm font-medium text-gray-700 mb-2">
                            ISBN
                        </label>
                        <input asp-for="ISBN" type="text" 
                               class="block w-full px-3 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                               placeholder="Nhập mã ISBN...">
                        <span asp-validation-for="ISBN" class="text-red-500 text-sm mt-1 block"></span>
                    </div> *@

                    <!-- Description -->
                    <div>
                        <label asp-for="Description" class="block text-sm font-medium text-gray-700 mb-2">
                            Mô tả
                        </label>
                        <textarea asp-for="Description" rows="4"
                            class="block w-full px-3 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors resize-none"
                            placeholder="Nhập mô tả về sách..."></textarea>
                        <span asp-validation-for="Description" class="text-red-500 text-sm mt-1 block"></span>
                    </div>
                </div>
            </div>

            <!-- Pricing & Inventory -->
            <div class="bg-white rounded-lg shadow-sm border border-gray-200">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900 flex items-center">
                        <i class="fas fa-dollar-sign text-green-600 mr-2"></i>
                        Giá bán & Kho hàng
                    </h3>
                </div>
                <div class="p-6 space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Price -->
                        <div>
                            <label asp-for="Price" class="block text-sm font-medium text-gray-700 mb-2">
                                Giá bán <span class="text-red-500">*</span>
                            </label>
                            <div class="relative">
                                <input asp-for="Price" type="number" step="1000" min="0" id="price-input"
                                    class="block w-full pl-8 pr-3 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                                    placeholder="0" oninput="formatCurrencyInput(this)">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 text-sm">₫</span>
                                </div>
                            </div>
                            <p class="text-sm text-gray-500 mt-1">Nhập số tiền VND (VD: 150000)</p>
                            <span asp-validation-for="Price" class="text-red-500 text-sm mt-1 block"></span>
                        </div>

                        <!-- Discount Price -->
                        <div>
                            <label asp-for="DiscountPrice" class="block text-sm font-medium text-gray-700 mb-2">
                                Giá khuyến mãi (nếu có)
                            </label>
                            <div class="relative">
                                <input asp-for="DiscountPrice" type="number" step="1000" min="0"
                                    class="block w-full pl-8 pr-3 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                                    placeholder="0">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <span class="text-gray-500 text-sm">₫</span>
                                </div>
                            </div>
                            <p class="text-sm text-gray-500 mt-1">Để trống nếu không có giảm giá</p>
                            <span asp-validation-for="DiscountPrice" class="text-red-500 text-sm mt-1 block"></span>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Stock Quantity -->
                        <div>
                            <label asp-for="StockQuantity" class="block text-sm font-medium text-gray-700 mb-2">
                                Số lượng tồn kho <span class="text-red-500">*</span>
                            </label>
                            <input asp-for="StockQuantity" type="number" min="0"
                                class="block w-full px-3 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                                placeholder="0">
                            <span asp-validation-for="StockQuantity" class="text-red-500 text-sm mt-1 block"></span>
                        </div>

                        <!-- Publisher -->
                        <div>
                            <label asp-for="Publisher" class="block text-sm font-medium text-gray-700 mb-2">
                                Nhà xuất bản
                            </label>
                            <input asp-for="Publisher" type="text"
                                class="block w-full px-3 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                                placeholder="Nhập tên nhà xuất bản...">
                            <span asp-validation-for="Publisher" class="text-red-500 text-sm mt-1 block"></span>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Publication Date -->
                        <div>
                            <label asp-for="PublishDate" class="block text-sm font-medium text-gray-700 mb-2">
                                Ngày xuất bản
                            </label>
                            <input asp-for="PublishDate" type="date"
                                class="block w-full px-3 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors">
                            <span asp-validation-for="PublishDate" class="text-red-500 text-sm mt-1 block"></span>
                        </div>

                        <!-- Pages -->
                        <div>
                            <label asp-for="PageCount" class="block text-sm font-medium text-gray-700 mb-2">
                                Số trang
                            </label>
                            <input asp-for="PageCount" type="number" min="0"
                                class="block w-full px-3 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                                placeholder="0">
                            <span asp-validation-for="PageCount" class="text-red-500 text-sm mt-1 block"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="space-y-6">

            <!-- Actions -->
            <div class="bg-white rounded-lg shadow-sm border border-gray-200">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900 flex items-center">
                        <i class="fas fa-cog text-gray-600 mr-2"></i>
                        Hành động
                    </h3>
                </div>
                <div class="p-6 space-y-4">
                    <button type="submit"
                        class="w-full inline-flex justify-center items-center px-4 py-2.5 border border-transparent text-sm font-medium rounded-lg text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors shadow-sm">
                        <i class="fas fa-save mr-2"></i>
                        Lưu sách
                    </button>
                    <button type="button" onclick="saveDraft()"
                        class="w-full inline-flex justify-center items-center px-4 py-2.5 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors">
                        <i class="fas fa-file-alt mr-2"></i>
                        Lưu nháp
                    </button>
                    <a href="@Url.Action("Books", "Admin")"
                        class="w-full inline-flex justify-center items-center px-4 py-2.5 border border-red-300 text-sm font-medium rounded-lg text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors">
                        <i class="fas fa-times mr-2"></i>
                        Hủy
                    </a>
                </div>
            </div>

            <!-- Category & Settings -->
            <div class="bg-white rounded-lg shadow-sm border border-gray-200">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900 flex items-center">
                        <i class="fas fa-tags text-blue-600 mr-2"></i>
                        Danh mục & Cài đặt
                    </h3>
                </div>
                <div class="p-6 space-y-6">
                    <!-- Category -->
                    <div>
                        <label asp-for="CategoryId" class="block text-sm font-medium text-gray-700 mb-2">
                            Danh mục <span class="text-red-500">*</span>
                        </label>
                        <select asp-for="CategoryId" asp-items="@(new SelectList(Model.Categories, "Id", "Name"))"
                            class="block w-full px-3 py-2.5 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors">
                            <option value="">Chọn danh mục...</option>
                        </select>

                        <span asp-validation-for="CategoryId" class="text-red-500 text-sm mt-1 block"></span>
                    </div>

                    <!-- Status Checkboxes -->
                    <div class="space-y-4">
                        <div class="flex items-center">
                            <input asp-for="IsActive" type="checkbox" checked
                                class="h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded">
                            <label asp-for="IsActive" class="ml-2 text-sm font-medium text-gray-700">
                                Hoạt động
                            </label>
                        </div>
                        <p class="text-sm text-gray-500 ml-6">Sách sẽ hiển thị trên website khi được kích hoạt.</p>

                        <div class="flex items-center">
                            <input @*asp-for=*@ type="checkbox"
                                class="h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded">
                            <label @*asp-for=*@ class="ml-2 text-sm font-medium text-gray-700">
                                Sách nổi bật
                            </label>
                        </div>
                        <p class="text-sm text-gray-500 ml-6">Sách sẽ xuất hiện trong danh sách sách nổi bật.</p>
                    </div>
                </div>
            </div>

            <!-- Image Management -->
            <div class="bg-white rounded-lg shadow-sm border border-gray-200">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h3 class="text-lg font-semibold text-gray-900 flex items-center">
                        <i class="fas fa-images text-purple-600 mr-2"></i>
                        Hình ảnh sách
                    </h3>
                </div>
                <div class="p-6">
                    <!-- Tab Navigation -->
                    <div class="flex border-b border-gray-200 mb-6">
                        <button type="button" onclick="switchImageTab('cover')" id="cover-tab"
                            class="image-tab-btn px-4 py-2 text-sm font-medium text-primary-600 border-b-2 border-primary-600">
                            <i class="fas fa-book-open mr-2"></i>
                            Ảnh bìa
                        </button>
                        <button type="button" onclick="switchImageTab('gallery')" id="gallery-tab"
                            class="image-tab-btn px-4 py-2 text-sm font-medium text-gray-500 border-b-2 border-transparent hover:text-gray-700 hover:border-gray-300 ml-8">
                            <i class="fas fa-images mr-2"></i>
                            Thư viện ảnh
                        </button>
                    </div>

                    <!-- Cover Image Tab -->
                    <div id="cover-image-section" class="image-tab-content">
                        <div class="space-y-4">
                            <!-- Cover Image Preview -->
                            <div id="cover-preview" class="hidden">
                                <div class="relative group">
                                    <img id="cover-preview-img" src="" alt="Cover Preview"
                                        class="w-full h-48 object-cover rounded-lg border border-gray-200">
                                    <button type="button" onclick="removeCoverPreview()"
                                        class="absolute top-2 right-2 bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center hover:bg-red-600 transition-colors opacity-0 group-hover:opacity-100">
                                        <i class="fas fa-times text-sm"></i>
                                    </button>
                                </div>
                                <p class="text-xs text-gray-500 mt-2 text-center">Ảnh bìa sách</p>
                            </div>

                            <!-- Cover Placeholder -->
                            <div id="cover-placeholder"
                                class="w-full h-48 bg-gray-100 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center cursor-pointer hover:bg-gray-50 transition-colors"
                                onclick="document.getElementById('ImageFile').click()">
                                <div class="text-center">
                                    <i class="fas fa-book-open text-4xl text-gray-400 mb-2"></i>
                                    <p class="text-sm text-gray-600 mb-1">Chọn ảnh bìa sách</p>
                                    <p class="text-xs text-gray-500">JPG, PNG, GIF, WebP. Tối đa 5MB</p>
                                </div>
                            </div>

                            <!-- Cover File Input -->
                            <input asp-for="ImageFile" type="file" accept="image/*" onchange="previewCoverImage(this)"
                                id="ImageFile" class="hidden">
                            <span asp-validation-for="ImageFile" class="text-red-500 text-sm mt-1 block"></span>
                        </div>
                    </div>

                    <!-- Gallery Images Tab -->
                    <div id="gallery-image-section" class="image-tab-content hidden">
                        <div class="space-y-4">
                            <!-- Gallery Upload Area -->
                            <div id="gallery-upload-area"
                                class="w-full h-32 bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center cursor-pointer hover:bg-gray-100 transition-colors"
                                onclick="document.getElementById('GalleryImageFiles').click()">
                                <div class="text-center">
                                    <i class="fas fa-images text-3xl text-gray-400 mb-2"></i>
                                    <p class="text-sm text-gray-600 mb-1">Thêm ảnh vào thư viện</p>
                                    <p class="text-xs text-gray-500">Chọn nhiều ảnh cùng lúc</p>
                                </div>
                            </div>

                            <!-- Multiple File Input (for client-side preview only) -->
                            <input type="file" accept="image/*" multiple onchange="previewGalleryImages(this)"
                                id="GalleryImageFiles" class="hidden">

                            <!-- Gallery Preview Grid -->
                            <div id="gallery-preview-grid" class="grid grid-cols-2 gap-3 hidden">
                                <!-- Gallery images will be inserted here -->
                            </div>

                            <!-- Gallery Instructions -->
                            <div class="text-xs text-gray-500 mt-2">
                                <p>• Chọn nhiều ảnh để tạo thư viện ảnh cho sách</p>
                                <p>• Mỗi ảnh không quá 5MB</p>
                                <p>• Định dạng: JPG, PNG, GIF, WebP</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>

@section Scripts {
    <!-- Include jQuery Validation -->
    <script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>

    <script>
        let galleryImages = [];
        let activeImageTab = 'cover';

        // Tab switching
        function switchImageTab(tab) {
            // Update tab buttons
            document.querySelectorAll('.image-tab-btn').forEach(btn => {
                btn.classList.remove('text-primary-600', 'border-primary-600');
                btn.classList.add('text-gray-500', 'border-transparent');
            });

            document.getElementById(tab + '-tab').classList.remove('text-gray-500', 'border-transparent');
            document.getElementById(tab + '-tab').classList.add('text-primary-600', 'border-primary-600');

            // Update tab content
            document.querySelectorAll('.image-tab-content').forEach(content => {
                content.classList.add('hidden');
            });

            document.getElementById(tab + '-image-section').classList.remove('hidden');
            activeImageTab = tab;
        }

        // Cover image preview functionality
        function previewCoverImage(input) {
            const file = input.files[0];
            if (file) {
                if (!isValidImageFile(file)) {
                    showNotification('File không hợp lệ. Chỉ chấp nhận JPG, PNG, GIF, WebP dưới 5MB.', 'error');
                    input.value = '';
                    return;
                }

                const reader = new FileReader();
                reader.onload = function (e) {
                    document.getElementById('cover-preview-img').src = e.target.result;
                    document.getElementById('cover-preview').classList.remove('hidden');
                    document.getElementById('cover-placeholder').classList.add('hidden');
                };
                reader.readAsDataURL(file);
            }
        }

        function removeCoverPreview() {
            document.getElementById('ImageFile').value = '';
            document.getElementById('cover-preview').classList.add('hidden');
            document.getElementById('cover-placeholder').classList.remove('hidden');
        }

        // Gallery images preview functionality
        function previewGalleryImages(input) {
            const files = Array.from(input.files);
            if (files.length === 0) return;

            // Validate files
            const invalidFiles = files.filter(file => !isValidImageFile(file));
            if (invalidFiles.length > 0) {
                showNotification(`${invalidFiles.length} file không hợp lệ sẽ bị bỏ qua.`, 'warning');
            }

            const validFiles = files.filter(file => isValidImageFile(file));
            if (validFiles.length === 0) return;

            // Add to gallery
            validFiles.forEach(file => {
                const reader = new FileReader();
                reader.onload = function (e) {
                    addImageToGallery(e.target.result, file.name);
                };
                reader.readAsDataURL(file);
                galleryImages.push(file);
            });

            // Clear input để có thể chọn lại cùng files
            input.value = '';
            updateGalleryDisplay();
        }

        function addImageToGallery(src, fileName) {
            const grid = document.getElementById('gallery-preview-grid');
            grid.classList.remove('hidden');

            const index = grid.children.length;
            const imageDiv = document.createElement('div');
            imageDiv.className = 'relative group gallery-image';
            imageDiv.dataset.index = index;

            imageDiv.innerHTML = `
                                        <img src="${src}" alt="${fileName}" class="w-full h-24 object-cover rounded border border-gray-200">
                                        <button type="button" onclick="removeGalleryImage(${index})" 
                                                class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors opacity-0 group-hover:opacity-100 text-xs">
                                            <i class="fas fa-times"></i>
                                        </button>
                                        <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs p-1 rounded-b truncate opacity-0 group-hover:opacity-100 transition-opacity">
                                            ${fileName}
                                        </div>
                                    `;

            grid.appendChild(imageDiv);
        }

        function removeGalleryImage(index) {
            galleryImages.splice(index, 1);
            updateGalleryDisplay();
        }

        function updateGalleryDisplay() {
            const grid = document.getElementById('gallery-preview-grid');
            grid.innerHTML = '';

            if (galleryImages.length === 0) {
                grid.classList.add('hidden');
                return;
            }

            galleryImages.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = function (e) {
                    addImageToGalleryAtIndex(e.target.result, file.name, index);
                };
                reader.readAsDataURL(file);
            });
        }

        function addImageToGalleryAtIndex(src, fileName, index) {
            const grid = document.getElementById('gallery-preview-grid');
            grid.classList.remove('hidden');

            const imageDiv = document.createElement('div');
            imageDiv.className = 'relative group gallery-image';
            imageDiv.dataset.index = index;

            imageDiv.innerHTML = `
                                        <img src="${src}" alt="${fileName}" class="w-full h-24 object-cover rounded border border-gray-200">
                                        <button type="button" onclick="removeGalleryImage(${index})" 
                                                class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600 transition-colors opacity-0 group-hover:opacity-100 text-xs">
                                            <i class="fas fa-times"></i>
                                        </button>
                                        <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs p-1 rounded-b truncate opacity-0 group-hover:opacity-100 transition-opacity">
                                            ${fileName}
                                        </div>
                                    `;

            grid.appendChild(imageDiv);
        }

        // File validation helper
        function isValidImageFile(file) {
            const validTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif', 'image/webp'];
            const maxSize = 5 * 1024 * 1024; // 5MB

            return validTypes.includes(file.type) && file.size <= maxSize;
        }

        // Save draft functionality  
        function saveDraft() {
            showNotification('Đang lưu nháp...', 'info');
            setTimeout(() => {
                showNotification('Nháp đã được lưu thành công!', 'success');
            }, 1000);
        }

        // Form validation enhancement
        $(document).ready(function () {
            // Form submission handling
            $('#create-book-form').on('submit', function (e) {
                if (!$(this).valid()) {
                    e.preventDefault();
                    showNotification('Vui lòng kiểm tra và điền đầy đủ thông tin bắt buộc!', 'error');

                    const firstError = $('.field-validation-error:first');
                    if (firstError.length) {
                        firstError[0].scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                } else {
                    // Prepare gallery images data before submit
                    prepareGalleryImagesForSubmit();
                }
            });
        });

        // Prepare gallery images for form submission (work with existing structure)
        function prepareGalleryImagesForSubmit() {
            // Convert gallery files to base64 for preview purposes
            // In real implementation, these would be handled by the controller
            const galleryUrls = [];

            galleryImages.forEach((file, index) => {
                // This would normally be handled server-side after upload
                galleryUrls.push(`/images/books/gallery/${Date.now()}_${index}_${file.name}`);
            });

            // Store gallery info for form processing
            if (galleryUrls.length > 0) {
                // Create a hidden input to pass gallery file count
                const hiddenInput = document.createElement('input');
                hiddenInput.type = 'hidden';
                hiddenInput.name = 'GalleryImageCount';
                hiddenInput.value = galleryImages.length;
                document.getElementById('create-book-form').appendChild(hiddenInput);
            }
        }

        // Notification function
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 max-w-sm w-full bg-white border rounded-lg shadow-lg transform transition-all duration-300 ${type === 'success' ? 'border-green-200' :
                type === 'error' ? 'border-red-200' :
                    type === 'warning' ? 'border-yellow-200' : 'border-blue-200'
                }`;

            notification.innerHTML = `
                                        <div class="p-4">
                                            <div class="flex items-start">
                                                <div class="flex-shrink-0">
                                                    <i class="fas ${type === 'success' ? 'fa-check-circle text-green-400' :
                    type === 'error' ? 'fa-times-circle text-red-400' :
                        type === 'warning' ? 'fa-exclamation-triangle text-yellow-400' :
                            'fa-info-circle text-blue-400'
                }"></i>
                                                </div>
                                                <div class="ml-3 w-0 flex-1 pt-0.5">
                                                    <p class="text-sm font-medium text-gray-900">${message}</p>
                                                </div>
                                                <div class="ml-4 flex-shrink-0 flex">
                                                    <button class="inline-flex text-gray-400 hover:text-gray-500" onclick="this.parentElement.parentElement.parentElement.parentElement.remove()">
                                                        <i class="fas fa-times"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    `;

            document.body.appendChild(notification);

            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }
    </script>
}

@section Styles {
    <style>
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Custom file input styling */
        input[type="file"]::-webkit-file-upload-button {
            visibility: hidden;
        }

        input[type="file"]::before {
            content: 'Chọn file';
            display: inline-block;
            background: linear-gradient(top, #f9f9f9, #e3e3e3);
            border: 1px solid #999;
            border-radius: 3px;
            padding: 5px 8px;
            outline: none;
            white-space: nowrap;
            -webkit-user-select: none;
            cursor: pointer;
            text-shadow: 1px 1px #fff;
            font-weight: 700;
            font-size: 10pt;
        }

        input[type="file"]:hover::before {
            border-color: black;
        }

        input[type="file"]:active::before {
            background: -webkit-linear-gradient(top, #e3e3e3, #f9f9f9);
        }

        /* Form validation styling */
        .field-validation-error {
            display: block;
            color: #ef4444;
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }

        .input-validation-error {
            border-color: #ef4444 !important;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1) !important;
        }

        .validation-summary-errors ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .validation-summary-errors li {
            color: #ef4444;
            margin-bottom: 0.5rem;
        }
    </style>
}