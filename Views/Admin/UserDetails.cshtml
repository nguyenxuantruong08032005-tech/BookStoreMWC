@* Views/Admin/UserDetails.cshtml *@
@model BookStoreMVC.Models.ViewModels.UserProfileViewModel
@{
    Layout = "_AdminLayout";
    ViewData["Title"] = $"Hồ sơ: {Model.Name}";
    ViewBag.PageTitle = $"Hồ sơ: {Model.Name}";
    ViewBag.ActiveMenu = "Users";
}


<!-- User Profile Header -->
<div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6">
    <div class="flex items-center justify-between">
        <div class="flex items-center">
            <div class="w-20 h-20 bg-primary-100 rounded-full flex items-center justify-center">
                <span class="text-3xl font-bold text-primary-600">
                    @(Model.Name?.Substring(0, 1).ToUpper() ?? "?")
                </span>
            </div>
            <div class="ml-6">
                <h2 class="text-2xl font-bold text-gray-900">@Model.Name</h2>
                <p class="text-gray-600">@Model.Email</p>
                @if (!string.IsNullOrEmpty(Model.PhoneNumber))
                {
                    <p class="text-gray-600">
                        <i class="fas fa-phone mr-1"></i>@Model.PhoneNumber
                    </p>
                }
                <p class="text-sm text-gray-500 mt-1">
                    Thành viên từ @Model.MemberSince.ToString("dd/MM/yyyy")
                </p>
            </div>
        </div>
    </div>
</div>

<!-- Stats Cards -->
<div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-xs font-medium text-gray-600 uppercase">Tổng đơn hàng</p>
                <p class="text-2xl font-bold text-gray-900 mt-1">@Model.TotalOrders</p>
            </div>
            <div class="p-3 bg-blue-100 rounded-lg">
                <i class="fas fa-shopping-cart text-blue-600"></i>
            </div>
        </div>
    </div>

    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-xs font-medium text-gray-600 uppercase">Tổng chi tiêu</p>
                <p class="text-2xl font-bold text-green-600 mt-1">@Model.TotalSpent.ToString("N0") ₫</p>
            </div>
            <div class="p-3 bg-green-100 rounded-lg">
                <i class="fas fa-dollar-sign text-green-600"></i>
            </div>
        </div>
    </div>

    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-xs font-medium text-gray-600 uppercase">Đánh giá</p>
                <p class="text-2xl font-bold text-yellow-600 mt-1">@Model.ReviewsCount</p>
            </div>
            <div class="p-3 bg-yellow-100 rounded-lg">
                <i class="fas fa-star text-yellow-600"></i>
            </div>
        </div>
    </div>

    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4">
        <div class="flex items-center justify-between">
            <div>
                <p class="text-xs font-medium text-gray-600 uppercase">Yêu thích</p>
                <p class="text-2xl font-bold text-purple-600 mt-1">@Model.WishlistCount</p>
            </div>
            <div class="p-3 bg-purple-100 rounded-lg">
                <i class="fas fa-heart text-purple-600"></i>
            </div>
        </div>
    </div>
</div>

<!-- Recent Orders and Reviews -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Recent Orders -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200">
        <div class="px-6 py-4 border-b border-gray-200">
            <h3 class="text-lg font-semibold text-gray-900">
                <i class="fas fa-shopping-cart text-blue-600 mr-2"></i>
                Đơn hàng gần đây
            </h3>
        </div>
        <div class="p-6">
            @if (Model.RecentOrders != null && Model.RecentOrders.Any())
            {
                <div class="space-y-4">
                    @foreach (var order in Model.RecentOrders)
                    {
                        <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                            <div>
                                <a href="@Url.Action("OrderDetails", "Admin", new { id = order.Id })"
                                    class="text-sm font-medium text-primary-600 hover:text-primary-800">
                                    @order.OrderNumber
                                </a>
                                <p class="text-xs text-gray-500">@order.CreatedAt.ToString("dd/MM/yyyy HH:mm")</p>
                            </div>
                            <div class="text-right">
                                <p class="text-sm font-semibold text-gray-900">@order.Total.ToString("N0") ₫</p>
                                <span class="px-2 py-1 text-xs font-semibold rounded-full @order.StatusCssClass">
                                    @order.StatusDisplayName
                                </span>
                            </div>
                        </div>
                    }
                </div>
            }
            else
            {
                <p class="text-sm text-gray-500 text-center py-4">Chưa có đơn hàng nào</p>
            }
        </div>
    </div>

    <!-- Recent Reviews -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200">
        <div class="px-6 py-4 border-b border-gray-200">
            <h3 class="text-lg font-semibold text-gray-900">
                <i class="fas fa-star text-yellow-600 mr-2"></i>
                Đánh giá gần đây
            </h3>
        </div>
        <div class="p-6">
            @if (Model.RecentReviews != null && Model.RecentReviews.Any())
            {
                <div class="space-y-4">
                    @foreach (var review in Model.RecentReviews)
                    {
                        <div class="p-3 bg-gray-50 rounded-lg">
                            <div class="flex items-center mb-2">
                                @for (int i = 1; i <= 5; i++)
                                {
                                    <i class="fas fa-star text-sm @(i <= review.Rating ? "text-yellow-400" : "text-gray-300")"></i>
                                }
                                <span class="text-xs text-gray-500 ml-2">@review.CreatedAt.ToString("dd/MM/yyyy")</span>
                            </div>
                            <p class="text-sm text-gray-900 font-medium mb-1">@review.Book.Title</p>
                            @if (!string.IsNullOrEmpty(review.Comment))
                            {
                                <p class="text-sm text-gray-600">@review.Comment</p>
                            }
                        </div>
                    }
                </div>
            }
            else
            {
                <p class="text-sm text-gray-500 text-center py-4">Chưa có đánh giá nào</p>
            }
        </div>
    </div>
</div>