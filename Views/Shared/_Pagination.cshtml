@using BookStoreMVC.Models.ViewModels
@model BookListViewModel

@if (Model.TotalPages > 1)
{
    <nav class="flex items-center justify-between border-t border-gray-200 bg-white px-4 py-3 sm:px-6 mt-8" aria-label="Pagination">

        <!-- Mobile pagination -->
        <div class="flex flex-1 justify-between sm:hidden">
            @if (Model.HasPreviousPage)
            {
                <a href="@Url.Action("Index", new { page = Model.PageNumber - 1, searchTerm = ViewBag.SearchQuery, categoryId = ViewBag.CategoryId })"
                   class="relative inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors">
                    <i class="fas fa-chevron-left mr-1"></i> Trước
                </a>
            }
            else
            {
                <span class="relative inline-flex items-center rounded-md border border-gray-300 bg-gray-100 px-4 py-2 text-sm font-medium text-gray-400">
                    <i class="fas fa-chevron-left mr-1"></i> Trước
                </span>
            }

            @if (Model.HasNextPage)
            {
                <a href="@Url.Action("Index", new { page = Model.PageNumber + 1, searchTerm = ViewBag.SearchQuery, categoryId = ViewBag.CategoryId })"
                   class="relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 transition-colors">
                    Sau <i class="fas fa-chevron-right ml-1"></i>
                </a>
            }
            else
            {
                <span class="relative ml-3 inline-flex items-center rounded-md border border-gray-300 bg-gray-100 px-4 py-2 text-sm font-medium text-gray-400">
                    Sau <i class="fas fa-chevron-right ml-1"></i>
                </span>
            }
        </div>

        <!-- Desktop pagination -->
        <div class="hidden sm:flex sm:flex-1 sm:items-center sm:justify-center">
            <ul class="flex items-center gap-2">

                <!-- Previous -->
                <li>
                    @if (Model.HasPreviousPage)
                    {
                        <a href="@Url.Action("Index", new { page = Model.PageNumber - 1, searchTerm = ViewBag.SearchQuery, categoryId = ViewBag.CategoryId })"
                           class="flex h-9 w-9 items-center justify-center rounded-lg border border-gray-300 text-gray-500 hover:bg-gray-100 hover:text-gray-700 transition-colors"
                           aria-label="Trang trước">
                            <i class="fas fa-chevron-left text-sm"></i>
                        </a>
                    }
                    else
                    {
                        <span class="flex h-9 w-9 items-center justify-center rounded-lg border border-gray-200 bg-gray-100 text-gray-300 cursor-not-allowed" aria-hidden="true">
                            <i class="fas fa-chevron-left text-sm"></i>
                        </span>
                    }
                </li>

                @{
                    var startPage = Math.Max(1, Model.PageNumber - 2);
                    var endPage = Math.Min(Model.TotalPages, Model.PageNumber + 2);
                }

                @* First page + ellipsis *@
                @if (startPage > 1)
                {
                    <li>
                        <a href="@Url.Action("Index", new { page = 1, searchTerm = ViewBag.SearchQuery, categoryId = ViewBag.CategoryId })"
                           class="flex h-9 min-w-[36px] items-center justify-center rounded-lg border border-gray-300 px-3 text-sm font-semibold text-gray-700 hover:bg-gray-50 transition-colors">
                            1
                        </a>
                    </li>

                    @if (startPage > 2)
                    {
                        <li>
                            <span class="flex h-9 min-w-[36px] items-center justify-center rounded-lg border border-transparent px-3 text-sm font-semibold text-gray-400">...</span>
                        </li>
                    }
                }

                @for (int i = startPage; i <= endPage; i++)
                {
                    <li>
                        @if (i == Model.PageNumber)
                        {
                            <span class="flex h-9 min-w-[36px] items-center justify-center rounded-lg border border-primary-500 bg-primary-500 px-3 text-sm font-semibold text-white shadow">@i</span>
                        }
                        else
                        {
                            <a href="@Url.Action("Index", new { page = i, searchTerm = ViewBag.SearchQuery, categoryId = ViewBag.CategoryId })"
                               class="flex h-9 min-w-[36px] items-center justify-center rounded-lg border border-gray-300 px-3 text-sm font-semibold text-gray-700 hover:bg-gray-50 transition-colors">
                                @i
                            </a>
                        }
                    </li>
                }

                @* Last page + ellipsis *@
                @if (endPage < Model.TotalPages)
                {
                    @if (endPage < Model.TotalPages - 1)
                    {
                        <li>
                            <span class="flex h-9 min-w-[36px] items-center justify-center rounded-lg border border-transparent px-3 text-sm font-semibold text-gray-400">...</span>
                        </li>
                    }
                    <li>
                        <a href="@Url.Action("Index", new { page = Model.TotalPages, searchTerm = ViewBag.SearchQuery, categoryId = ViewBag.CategoryId })"
                           class="flex h-9 min-w-[36px] items-center justify-center rounded-lg border border-gray-300 px-3 text-sm font-semibold text-gray-700 hover:bg-gray-50 transition-colors">
                            @Model.TotalPages
                        </a>
                    </li>
                }

                <!-- Next -->
                <li>
                    @if (Model.HasNextPage)
                    {
                        <a href="@Url.Action("Index", new { page = Model.PageNumber + 1, searchTerm = ViewBag.SearchQuery, categoryId = ViewBag.CategoryId })"
                           class="flex h-9 w-9 items-center justify-center rounded-lg border border-gray-300 text-gray-500 hover:bg-gray-100 hover:text-gray-700 transition-colors"
                           aria-label="Trang tiếp theo">
                            <i class="fas fa-chevron-right text-sm"></i>
                        </a>
                    }
                    else
                    {
                        <span class="flex h-9 w-9 items-center justify-center rounded-lg border border-gray-200 bg-gray-100 text-gray-300 cursor-not-allowed" aria-hidden="true">
                            <i class="fas fa-chevron-right text-sm"></i>
                        </span>
                    }
                </li>
            </ul>
        </div>
    </nav>
}
